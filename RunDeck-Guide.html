<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>RunDeck User Manual | Version 1.4.1</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Alex Honor" />
  <meta name="author" content="Greg Schueler" />
  <meta name="date" content="November 20, 2010" />
  <link rel="stylesheet" href="RunDeck-Guide.css" type="text/css" />
</head>
<body>
<div id="docbody">
<h1 class="title">RunDeck User Manual | Version 1.4.1</h1>
<div id="TOC"
><ul
  ><li
    ><a href="#introduction"
      ><span class="toc-section-number"
	>1</span
	> Introduction</a
      ><ul
      ><li
	><a href="#what-is-this-guide-about"
	  ><span class="toc-section-number"
	    >1.1</span
	    > What is this guide about?</a
	  ></li
	><li
	><a href="#what-is-rundeck"
	  ><span class="toc-section-number"
	    >1.2</span
	    > What is RunDeck?</a
	  ><ul
	  ><li
	    ><a href="#who-makes-the-rundeck-software"
	      ><span class="toc-section-number"
		>1.2.1</span
		> Who makes the RunDeck software?</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#getting-help"
	  ><span class="toc-section-number"
	    >1.3</span
	    > Getting help</a
	  ></li
	><li
	><a href="#rundeck-from-30000-feet"
	  ><span class="toc-section-number"
	    >1.4</span
	    > RunDeck from 30,000 feet</a
	  ><ul
	  ><li
	    ><a href="#rundeck-features"
	      ><span class="toc-section-number"
		>1.4.1</span
		> RunDeck features</a
	      ></li
	    ><li
	    ><a href="#rundeck-in-context"
	      ><span class="toc-section-number"
		>1.4.2</span
		> RunDeck in context</a
	      ></li
	    ><li
	    ><a href="#rundeck-architecture"
	      ><span class="toc-section-number"
		>1.4.3</span
		> RunDeck architecture</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#feedback"
	  ><span class="toc-section-number"
	    >1.5</span
	    > Feedback</a
	  ></li
	><li
	><a href="#whats-next"
	  ><span class="toc-section-number"
	    >1.6</span
	    > What's next?</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#getting-started"
      ><span class="toc-section-number"
	>2</span
	> Getting Started</a
      ><ul
      ><li
	><a href="#rundeck-basics"
	  ><span class="toc-section-number"
	    >2.1</span
	    > RunDeck Basics</a
	  ><ul
	  ><li
	    ><a href="#command-dispatching"
	      ><span class="toc-section-number"
		>2.1.1</span
		> Command dispatching</a
	      ></li
	    ><li
	    ><a href="#resource-model"
	      ><span class="toc-section-number"
		>2.1.2</span
		> Resource model</a
	      ></li
	    ><li
	    ><a href="#authorization"
	      ><span class="toc-section-number"
		>2.1.3</span
		> Authorization</a
	      ></li
	    ><li
	    ><a href="#project"
	      ><span class="toc-section-number"
		>2.1.4</span
		> Project</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#installing-rundeck"
	  ><span class="toc-section-number"
	    >2.2</span
	    > Installing RunDeck</a
	  ><ul
	  ><li
	    ><a href="#system-requirements"
	      ><span class="toc-section-number"
		>2.2.1</span
		> System Requirements</a
	      ><ul
	      ><li
		><a href="#java"
		  ><span class="toc-section-number"
		    >2.2.1.1</span
		    > Java</a
		  ></li
		><li
		><a href="#network-access"
		  ><span class="toc-section-number"
		    >2.2.1.2</span
		    > Network access</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#installing-from-source"
	      ><span class="toc-section-number"
		>2.2.2</span
		> Installing from Source</a
	      ></li
	    ><li
	    ><a href="#installing-with-rpm"
	      ><span class="toc-section-number"
		>2.2.3</span
		> Installing with RPM</a
	      ></li
	    ><li
	    ><a href="#installing-with-launcher"
	      ><span class="toc-section-number"
		>2.2.4</span
		> Installing with Launcher</a
	      ><ul
	      ><li
		><a href="#launcher-options"
		  ><span class="toc-section-number"
		    >2.2.4.1</span
		    > Launcher Options</a
		  ></li
		><li
		><a href="#system-properties"
		  ><span class="toc-section-number"
		    >2.2.4.2</span
		    > System Properties</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#upgrading-rundeck"
	  ><span class="toc-section-number"
	    >2.3</span
	    > Upgrading RunDeck</a
	  ></li
	><li
	><a href="#first-time-setup"
	  ><span class="toc-section-number"
	    >2.4</span
	    > First-Time Setup</a
	  ><ul
	  ><li
	    ><a href="#logins"
	      ><span class="toc-section-number"
		>2.4.1</span
		> Logins</a
	      ></li
	    ><li
	    ><a href="#group-membership"
	      ><span class="toc-section-number"
		>2.4.2</span
		> Group membership</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#summary"
	  ><span class="toc-section-number"
	    >2.5</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#rundeck-basics-1"
      ><span class="toc-section-number"
	>3</span
	> RunDeck Basics</a
      ><ul
      ><li
	><a href="#rundeck-interfaces"
	  ><span class="toc-section-number"
	    >3.1</span
	    > RunDeck Interfaces</a
	  ><ul
	  ><li
	    ><a href="#graphical-console"
	      ><span class="toc-section-number"
		>3.1.1</span
		> Graphical Console</a
	      ><ul
	      ><li
		><a href="#navigation"
		  ><span class="toc-section-number"
		    >3.1.1.1</span
		    > Navigation</a
		  ></li
		><li
		><a href="#now-running"
		  ><span class="toc-section-number"
		    >3.1.1.2</span
		    > Now running</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#shell-tools"
	      ><span class="toc-section-number"
		>3.1.2</span
		> Shell Tools</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#project-setup"
	  ><span class="toc-section-number"
	    >3.2</span
	    > Project Setup</a
	  ><ul
	  ><li
	    ><a href="#resource-model-1"
	      ><span class="toc-section-number"
		>3.2.1</span
		> Resource model</a
	      ></li
	    ><li
	    ><a href="#resource-model-document-formats"
	      ><span class="toc-section-number"
		>3.2.2</span
		> Resource Model Document formats</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#pluggable-resource-model-sources"
	  ><span class="toc-section-number"
	    >3.3</span
	    > Pluggable Resource Model Sources</a
	  ></li
	><li
	><a href="#command-execution"
	  ><span class="toc-section-number"
	    >3.4</span
	    > Command Execution</a
	  ><ul
	  ><li
	    ><a href="#dispatcher-options"
	      ><span class="toc-section-number"
		>3.4.1</span
		> Dispatcher options</a
	      ><ul
	      ><li
		><a href="#filtering-nodes-graphically"
		  ><span class="toc-section-number"
		    >3.4.1.1</span
		    > Filtering nodes graphically</a
		  ></li
		><li
		><a href="#filtering-nodes-in-the-shell"
		  ><span class="toc-section-number"
		    >3.4.1.2</span
		    > Filtering nodes in the shell</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#ad-hoc-commands"
	      ><span class="toc-section-number"
		>3.4.2</span
		> Ad-hoc commands</a
	      ><ul
	      ><li
		><a href="#shell-tool-command-execution"
		  ><span class="toc-section-number"
		    >3.4.2.1</span
		    > Shell tool command execution</a
		  ></li
		><li
		><a href="#graphical-command-shell-execution"
		  ><span class="toc-section-number"
		    >3.4.2.2</span
		    > Graphical command shell execution</a
		  ><ul
		  ><li
		    ><a href="#following-execution-output"
		      ><span class="toc-section-number"
			>3.4.2.2.1</span
			> Following execution output</a
		      ><ul
		      ><li
			><a href="#separate-execution-follow-page"
			  ><span class="toc-section-number"
			    >3.4.2.2.1.1</span
			    > Separate execution follow page</a
			  ></li
			></ul
		      ></li
		    ></ul
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#controlling-command-execution"
	      ><span class="toc-section-number"
		>3.4.3</span
		> Controlling command execution</a
	      ></li
	    ><li
	    ><a href="#queuing-commands-to-rundeck"
	      ><span class="toc-section-number"
		>3.4.4</span
		> Queuing commands to RunDeck</a
	      ></li
	    ><li
	    ><a href="#tracking-execution"
	      ><span class="toc-section-number"
		>3.4.5</span
		> Tracking execution</a
	      ></li
	    ><li
	    ><a href="#plugins"
	      ><span class="toc-section-number"
		>3.4.6</span
		> Plugins</a
	      ><ul
	      ><li
		><a href="#ssh-plugin"
		  ><span class="toc-section-number"
		    >3.4.6.1</span
		    > SSH Plugin</a
		  ></li
		><li
		><a href="#included-plugins"
		  ><span class="toc-section-number"
		    >3.4.6.2</span
		    > Included Plugins</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#history"
	  ><span class="toc-section-number"
	    >3.5</span
	    > History</a
	  ><ul
	  ><li
	    ><a href="#filtering-event-history"
	      ><span class="toc-section-number"
		>3.5.1</span
		> Filtering event history</a
	      ></li
	    ><li
	    ><a href="#event-view"
	      ><span class="toc-section-number"
		>3.5.2</span
		> Event view</a
	      ></li
	    ><li
	    ><a href="#rss-link"
	      ><span class="toc-section-number"
		>3.5.3</span
		> RSS link</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#tips-and-tricks"
	  ><span class="toc-section-number"
	    >3.6</span
	    > Tips and Tricks</a
	  ><ul
	  ><li
	    ><a href="#saving-filters"
	      ><span class="toc-section-number"
		>3.6.1</span
		> Saving filters</a
	      ></li
	    ><li
	    ><a href="#auto-completion"
	      ><span class="toc-section-number"
		>3.6.2</span
		> Auto-Completion</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#summary-1"
	  ><span class="toc-section-number"
	    >3.7</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#jobs"
      ><span class="toc-section-number"
	>4</span
	> Jobs</a
      ><ul
      ><li
	><a href="#job-groups"
	  ><span class="toc-section-number"
	    >4.1</span
	    > Job groups</a
	  ></li
	><li
	><a href="#job-uuids"
	  ><span class="toc-section-number"
	    >4.2</span
	    > Job UUIDs</a
	  ></li
	><li
	><a href="#listing-and-filtering-jobs"
	  ><span class="toc-section-number"
	    >4.3</span
	    > Listing and filtering Jobs</a
	  ><ul
	  ><li
	    ><a href="#filtering-jobs"
	      ><span class="toc-section-number"
		>4.3.1</span
		> Filtering Jobs</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#viewing-job-detail"
	  ><span class="toc-section-number"
	    >4.4</span
	    > Viewing Job detail</a
	  ></li
	><li
	><a href="#running-a-job"
	  ><span class="toc-section-number"
	    >4.5</span
	    > Running a Job</a
	  ><ul
	  ><li
	    ><a href="#choose-execution-options"
	      ><span class="toc-section-number"
		>4.5.1</span
		> Choose execution options</a
	      ></li
	    ><li
	    ><a href="#following-running-jobs"
	      ><span class="toc-section-number"
		>4.5.2</span
		> Following Running Jobs</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#creating-jobs"
	  ><span class="toc-section-number"
	    >4.6</span
	    > Creating Jobs</a
	  ><ul
	  ><li
	    ><a href="#temporary-jobs"
	      ><span class="toc-section-number"
		>4.6.1</span
		> Temporary Jobs</a
	      ></li
	    ><li
	    ><a href="#saved-jobs"
	      ><span class="toc-section-number"
		>4.6.2</span
		> Saved Jobs</a
	      ></li
	    ><li
	    ><a href="#simple-saved-job"
	      ><span class="toc-section-number"
		>4.6.3</span
		> Simple saved job</a
	      ></li
	    ><li
	    ><a href="#node-dispatching-and-filtering"
	      ><span class="toc-section-number"
		>4.6.4</span
		> Node dispatching and filtering</a
	      ><ul
	      ><li
		><a href="#dynamic-node-filters"
		  ><span class="toc-section-number"
		    >4.6.4.1</span
		    > Dynamic node filters</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#scheduled-jobs"
	  ><span class="toc-section-number"
	    >4.7</span
	    > Scheduled Jobs</a
	  ></li
	><li
	><a href="#job-notifications"
	  ><span class="toc-section-number"
	    >4.8</span
	    > Job Notifications</a
	  ></li
	><li
	><a href="#job-history"
	  ><span class="toc-section-number"
	    >4.9</span
	    > Job history</a
	  ></li
	><li
	><a href="#killing-jobs"
	  ><span class="toc-section-number"
	    >4.10</span
	    > Killing Jobs</a
	  ></li
	><li
	><a href="#deleting-jobs"
	  ><span class="toc-section-number"
	    >4.11</span
	    > Deleting Jobs</a
	  ></li
	><li
	><a href="#updating-and-copying-jobs"
	  ><span class="toc-section-number"
	    >4.12</span
	    > Updating and copying Jobs</a
	  ></li
	><li
	><a href="#exporting-job-definitions"
	  ><span class="toc-section-number"
	    >4.13</span
	    > Exporting Job definitions</a
	  ></li
	><li
	><a href="#importing-job-definitions"
	  ><span class="toc-section-number"
	    >4.14</span
	    > Importing Job definitions</a
	  ></li
	><li
	><a href="#summary-2"
	  ><span class="toc-section-number"
	    >4.15</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#job-workflows"
      ><span class="toc-section-number"
	>5</span
	> Job Workflows</a
      ><ul
      ><li
	><a href="#workflow-definition"
	  ><span class="toc-section-number"
	    >5.1</span
	    > Workflow definition</a
	  ></li
	><li
	><a href="#workflow-control-settings"
	  ><span class="toc-section-number"
	    >5.2</span
	    > Workflow control settings</a
	  ></li
	><li
	><a href="#workflow-steps"
	  ><span class="toc-section-number"
	    >5.3</span
	    > Workflow steps</a
	  ><ul
	  ><li
	    ><a href="#command-step"
	      ><span class="toc-section-number"
		>5.3.1</span
		> Command step</a
	      ></li
	    ><li
	    ><a href="#script-step"
	      ><span class="toc-section-number"
		>5.3.2</span
		> Script step</a
	      ></li
	    ><li
	    ><a href="#script-file-step"
	      ><span class="toc-section-number"
		>5.3.3</span
		> Script file step</a
	      ></li
	    ><li
	    ><a href="#job-reference-step"
	      ><span class="toc-section-number"
		>5.3.4</span
		> Job reference step</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#reordering-steps"
	  ><span class="toc-section-number"
	    >5.4</span
	    > Reordering steps</a
	  ></li
	><li
	><a href="#save-the-changes"
	  ><span class="toc-section-number"
	    >5.5</span
	    > Save the changes</a
	  ></li
	><li
	><a href="#summary-3"
	  ><span class="toc-section-number"
	    >5.6</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#job-options"
      ><span class="toc-section-number"
	>6</span
	> Job Options</a
      ><ul
      ><li
	><a href="#prompting-the-user"
	  ><span class="toc-section-number"
	    >6.1</span
	    > Prompting the user</a
	  ></li
	><li
	><a href="#secure-options"
	  ><span class="toc-section-number"
	    >6.2</span
	    > Secure Options</a
	  ></li
	><li
	><a href="#options-editor"
	  ><span class="toc-section-number"
	    >6.3</span
	    > Options editor</a
	  ></li
	><li
	><a href="#defining-an-option"
	  ><span class="toc-section-number"
	    >6.4</span
	    > Defining an option</a
	  ></li
	><li
	><a href="#remote-option-values"
	  ><span class="toc-section-number"
	    >6.5</span
	    > Remote option values</a
	  ></li
	><li
	><a href="#script-usage"
	  ><span class="toc-section-number"
	    >6.6</span
	    > Script usage</a
	  ></li
	><li
	><a href="#calling-a-job-with-options"
	  ><span class="toc-section-number"
	    >6.7</span
	    > Calling a Job with options</a
	  ></li
	><li
	><a href="#summary-4"
	  ><span class="toc-section-number"
	    >6.8</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#rundeck-by-example"
      ><span class="toc-section-number"
	>7</span
	> RunDeck by example</a
      ><ul
      ><li
	><a href="#acme-anvils"
	  ><span class="toc-section-number"
	    >7.1</span
	    > Acme Anvils</a
	  ></li
	><li
	><a href="#rundeck-set-up"
	  ><span class="toc-section-number"
	    >7.2</span
	    > RunDeck set up</a
	  ></li
	><li
	><a href="#tag-classification-and-command-dispatching"
	  ><span class="toc-section-number"
	    >7.3</span
	    > Tag classification and command dispatching</a
	  ></li
	><li
	><a href="#jobs-1"
	  ><span class="toc-section-number"
	    >7.4</span
	    > Jobs</a
	  ><ul
	  ><li
	    ><a href="#job-structure"
	      ><span class="toc-section-number"
		>7.4.1</span
		> Job structure</a
	      ></li
	    ><li
	    ><a href="#job-grouping"
	      ><span class="toc-section-number"
		>7.4.2</span
		> Job grouping</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#job-option"
	  ><span class="toc-section-number"
	    >7.5</span
	    > Job option</a
	  ><ul
	  ><li
	    ><a href="#allowed-values"
	      ><span class="toc-section-number"
		>7.5.1</span
		> Allowed values</a
	      ></li
	    ><li
	    ><a href="#script-access-to-option-data"
	      ><span class="toc-section-number"
		>7.5.2</span
		> Script access to option data</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#job-workflow-composition"
	  ><span class="toc-section-number"
	    >7.6</span
	    > Job workflow composition</a
	  ></li
	><li
	><a href="#running-the-job"
	  ><span class="toc-section-number"
	    >7.7</span
	    > Running the job</a
	  ></li
	><li
	><a href="#job-access-control"
	  ><span class="toc-section-number"
	    >7.8</span
	    > Job access control</a
	  ></li
	><li
	><a href="#resource-model-source-examples"
	  ><span class="toc-section-number"
	    >7.9</span
	    > Resource model source examples</a
	  ></li
	><li
	><a href="#resource-editor-examples"
	  ><span class="toc-section-number"
	    >7.10</span
	    > Resource editor examples</a
	  ></li
	><li
	><a href="#option-model-provider-examples"
	  ><span class="toc-section-number"
	    >7.11</span
	    > Option model provider examples</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#administration"
      ><span class="toc-section-number"
	>8</span
	> Administration</a
      ><ul
      ><li
	><a href="#startup-and-shutdown"
	  ><span class="toc-section-number"
	    >8.1</span
	    > Startup and shutdown</a
	  ><ul
	  ><li
	    ><a href="#rpm"
	      ><span class="toc-section-number"
		>8.1.1</span
		> RPM</a
	      ><ul
	      ><li
		><a href="#setting-java_home"
		  ><span class="toc-section-number"
		    >8.1.1.1</span
		    > Setting JAVA_HOME</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#launcher"
	      ><span class="toc-section-number"
		>8.1.2</span
		> Launcher</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#configuration"
	  ><span class="toc-section-number"
	    >8.2</span
	    > Configuration</a
	  ><ul
	  ><li
	    ><a href="#configuration-layout"
	      ><span class="toc-section-number"
		>8.2.1</span
		> Configuration layout</a
	      ><ul
	      ><li
		><a href="#rpm-layout"
		  ><span class="toc-section-number"
		    >8.2.1.1</span
		    > RPM layout</a
		  ></li
		><li
		><a href="#launcher-layout"
		  ><span class="toc-section-number"
		    >8.2.1.2</span
		    > Launcher layout</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#configuration-files"
	      ><span class="toc-section-number"
		>8.2.2</span
		> Configuration files</a
	      ><ul
	      ><li
		><a href="#admin.aclpolicy"
		  ><span class="toc-section-number"
		    >8.2.2.1</span
		    > admin.aclpolicy</a
		  ></li
		><li
		><a href="#framework.properties"
		  ><span class="toc-section-number"
		    >8.2.2.2</span
		    > framework.properties</a
		  ></li
		><li
		><a href="#log4j.properties"
		  ><span class="toc-section-number"
		    >8.2.2.3</span
		    > log4j.properties</a
		  ></li
		><li
		><a href="#profile"
		  ><span class="toc-section-number"
		    >8.2.2.4</span
		    > profile</a
		  ></li
		><li
		><a href="#project.properties"
		  ><span class="toc-section-number"
		    >8.2.2.5</span
		    > project.properties</a
		  ></li
		><li
		><a href="#jaas-loginmodule.conf"
		  ><span class="toc-section-number"
		    >8.2.2.6</span
		    > jaas-loginmodule.conf</a
		  ></li
		><li
		><a href="#realm.properties"
		  ><span class="toc-section-number"
		    >8.2.2.7</span
		    > realm.properties</a
		  ></li
		><li
		><a href="#rundeck-config.properties"
		  ><span class="toc-section-number"
		    >8.2.2.8</span
		    > rundeck-config.properties</a
		  ><ul
		  ><li
		    ><a href="#notification-email-settings"
		      ><span class="toc-section-number"
			>8.2.2.8.1</span
			> Notification email settings</a
		      ></li
		    ></ul
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#gui-admin-page"
	      ><span class="toc-section-number"
		>8.2.3</span
		> GUI Admin Page</a
	      ><ul
	      ><li
		><a href="#system-information-page"
		  ><span class="toc-section-number"
		    >8.2.3.1</span
		    > System Information Page</a
		  ></li
		><li
		><a href="#user-profiles-page"
		  ><span class="toc-section-number"
		    >8.2.3.2</span
		    > User Profiles Page</a
		  ></li
		><li
		><a href="#project-configuration"
		  ><span class="toc-section-number"
		    >8.2.3.3</span
		    > Project Configuration</a
		  ></li
		><li
		><a href="#resource-model-sources-configuration"
		  ><span class="toc-section-number"
		    >8.2.3.4</span
		    > Resource Model Sources Configuration</a
		  ><ul
		  ><li
		    ><a href="#file-resource-model-source"
		      ><span class="toc-section-number"
			>8.2.3.4.1</span
			> File Resource Model Source</a
		      ></li
		    ><li
		    ><a href="#directory-resource-model-source"
		      ><span class="toc-section-number"
			>8.2.3.4.2</span
			> Directory Resource Model Source</a
		      ></li
		    ><li
		    ><a href="#script-resource-model-source"
		      ><span class="toc-section-number"
			>8.2.3.4.3</span
			> Script Resource Model Source</a
		      ></li
		    ><li
		    ><a href="#url-resource-model-source"
		      ><span class="toc-section-number"
			>8.2.3.4.4</span
			> URL Resource Model Source</a
		      ></li
		    ></ul
		  ></li
		><li
		><a href="#default-node-executor-configuration"
		  ><span class="toc-section-number"
		    >8.2.3.5</span
		    > Default Node Executor Configuration</a
		  ></li
		><li
		><a href="#default-file-copier-configuration"
		  ><span class="toc-section-number"
		    >8.2.3.6</span
		    > Default File Copier Configuration</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#logs"
	  ><span class="toc-section-number"
	    >8.3</span
	    > Logs</a
	  ></li
	><li
	><a href="#backup-and-recovery"
	  ><span class="toc-section-number"
	    >8.4</span
	    > Backup and recovery</a
	  ><ul
	  ><li
	    ><a href="#recovery"
	      ><span class="toc-section-number"
		>8.4.1</span
		> Recovery</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#relational-database"
	  ><span class="toc-section-number"
	    >8.5</span
	    > Relational Database</a
	  ><ul
	  ><li
	    ><a href="#enable-rdbsupport"
	      ><span class="toc-section-number"
		>8.5.1</span
		> Enable rdbsupport</a
	      ></li
	    ><li
	    ><a href="#customize-the-datasource"
	      ><span class="toc-section-number"
		>8.5.2</span
		> Customize the Datasource</a
	      ></li
	    ><li
	    ><a href="#add-the-jdbc-driver"
	      ><span class="toc-section-number"
		>8.5.3</span
		> Add the JDBC Driver</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#ssh"
	  ><span class="toc-section-number"
	    >8.6</span
	    > SSH</a
	  ><ul
	  ><li
	    ><a href="#ssh-configuration-requirements"
	      ><span class="toc-section-number"
		>8.6.1</span
		> SSH configuration requirements</a
	      ></li
	    ><li
	    ><a href="#ssh-key-generation"
	      ><span class="toc-section-number"
		>8.6.2</span
		> SSH key generation</a
	      ></li
	    ><li
	    ><a href="#configuring-remote-machine-for-ssh"
	      ><span class="toc-section-number"
		>8.6.3</span
		> Configuring remote machine for SSH</a
	      ></li
	    ><li
	    ><a href="#passing-environment-variables-through-remote-command"
	      ><span class="toc-section-number"
		>8.6.4</span
		> Passing environment variables through remote command</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#managing-logins"
	  ><span class="toc-section-number"
	    >8.7</span
	    > Managing logins</a
	  ><ul
	  ><li
	    ><a href="#realm.properties-1"
	      ><span class="toc-section-number"
		>8.7.1</span
		> realm.properties</a
	      ></li
	    ><li
	    ><a href="#active-directory"
	      ><span class="toc-section-number"
		>8.7.2</span
		> Active Directory</a
	      ><ul
	      ><li
		><a href="#communicating-over-secure-ldap-ldaps:"
		  ><span class="toc-section-number"
		    >8.7.2.1</span
		    > Communicating over secure ldap (ldaps://)</a
		  ></li
		><li
		><a href="#redundant-connection-options"
		  ><span class="toc-section-number"
		    >8.7.2.2</span
		    > Redundant Connection Options</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#authorization-1"
	  ><span class="toc-section-number"
	    >8.8</span
	    > Authorization</a
	  ><ul
	  ><li
	    ><a href="#access-control-policy"
	      ><span class="toc-section-number"
		>8.8.1</span
		> Access control policy</a
	      ></li
	    ><li
	    ><a href="#specific-resources-and-resource-types"
	      ><span class="toc-section-number"
		>8.8.2</span
		> Specific Resources and Resource Types</a
	      ></li
	    ><li
	    ><a href="#special-api-token-authentication-group"
	      ><span class="toc-section-number"
		>8.8.3</span
		> Special API Token Authentication group</a
	      ></li
	    ><li
	    ><a href="#rundeck-resource-authorizations"
	      ><span class="toc-section-number"
		>8.8.4</span
		> RunDeck resource authorizations</a
	      ><ul
	      ><li
		><a href="#application-scope-resources-and-actions"
		  ><span class="toc-section-number"
		    >8.8.4.1</span
		    > Application Scope Resources and Actions</a
		  ></li
		><li
		><a href="#project-scope-resources-and-actions"
		  ><span class="toc-section-number"
		    >8.8.4.2</span
		    > Project Scope Resources and Actions</a
		  ></li
		><li
		><a href="#node-resource-properties"
		  ><span class="toc-section-number"
		    >8.8.4.3</span
		    > Node resource properties</a
		  ></li
		><li
		><a href="#access-control-policy-actions-example"
		  ><span class="toc-section-number"
		    >8.8.4.4</span
		    > Access control policy actions example</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#troubleshooting-access-control-policy"
	      ><span class="toc-section-number"
		>8.8.5</span
		> Troubleshooting access control policy</a
	      ></li
	    ><li
	    ><a href="#authorization-caveats"
	      ><span class="toc-section-number"
		>8.8.6</span
		> Authorization caveats</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#configuring-rundeck-for-ssl"
	  ><span class="toc-section-number"
	    >8.9</span
	    > Configuring Rundeck for SSL</a
	  ><ul
	  ><li
	    ><a href="#securing-passwords"
	      ><span class="toc-section-number"
		>8.9.1</span
		> Securing passwords</a
	      ></li
	    ><li
	    ><a href="#troubleshooting-keystore"
	      ><span class="toc-section-number"
		>8.9.2</span
		> Troubleshooting keystore</a
	      ></li
	    ><li
	    ><a href="#optional-pem-export"
	      ><span class="toc-section-number"
		>8.9.3</span
		> Optional PEM export</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#customizing-rundeck-gui"
	  ><span class="toc-section-number"
	    >8.10</span
	    > Customizing RunDeck GUI</a
	  ></li
	><li
	><a href="#customizing-configuration-for-scale"
	  ><span class="toc-section-number"
	    >8.11</span
	    > Customizing configuration for scale</a
	  ><ul
	  ><li
	    ><a href="#file-descriptors"
	      ><span class="toc-section-number"
		>8.11.1</span
		> File descriptors</a
	      ></li
	    ><li
	    ><a href="#java-heap-size"
	      ><span class="toc-section-number"
		>8.11.2</span
		> Java heap size</a
	      ></li
	    ><li
	    ><a href="#quartz-job-threadcount"
	      ><span class="toc-section-number"
		>8.11.3</span
		> Quartz job threadCount</a
	      ></li
	    ><li
	    ><a href="#jmx-instrumentation"
	      ><span class="toc-section-number"
		>8.11.4</span
		> JMX instrumentation</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#resource-model-source"
	  ><span class="toc-section-number"
	    >8.12</span
	    > Resource Model Source</a
	  ><ul
	  ><li
	    ><a href="#requirements"
	      ><span class="toc-section-number"
		>8.12.1</span
		> Requirements</a
	      ></li
	    ><li
	    ><a href="#configuration-1"
	      ><span class="toc-section-number"
		>8.12.2</span
		> Configuration</a
	      ></li
	    ><li
	    ><a href="#implementations-and-examples"
	      ><span class="toc-section-number"
		>8.12.3</span
		> Implementations and Examples</a
	      ><ul
	      ><li
		><a href="#simple-vcs-url-resource-model-source"
		  ><span class="toc-section-number"
		    >8.12.3.1</span
		    > Simple VCS URL resource model source</a
		  ></li
		><li
		><a href="#amazon-ec2-nodes"
		  ><span class="toc-section-number"
		    >8.12.3.2</span
		    > Amazon EC2 Nodes</a
		  ></li
		><li
		><a href="#third-party-url-resource-model-sources"
		  ><span class="toc-section-number"
		    >8.12.3.3</span
		    > Third party URL resource model sources</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#option-model-provider"
	  ><span class="toc-section-number"
	    >8.13</span
	    > Option model provider</a
	  ><ul
	  ><li
	    ><a href="#requirements-1"
	      ><span class="toc-section-number"
		>8.13.1</span
		> Requirements</a
	      ></li
	    ><li
	    ><a href="#configuration-2"
	      ><span class="toc-section-number"
		>8.13.2</span
		> Configuration</a
	      ></li
	    ><li
	    ><a href="#json-format"
	      ><span class="toc-section-number"
		>8.13.3</span
		> JSON format</a
	      ></li
	    ><li
	    ><a href="#variable-expansion-in-remote-urls"
	      ><span class="toc-section-number"
		>8.13.4</span
		> Variable expansion in remote URLs</a
	      ></li
	    ><li
	    ><a href="#remote-request-failures"
	      ><span class="toc-section-number"
		>8.13.5</span
		> Remote request failures</a
	      ></li
	    ><li
	    ><a href="#implementations-and-examples-1"
	      ><span class="toc-section-number"
		>8.13.6</span
		> Implementations and Examples</a
	      ><ul
	      ><li
		><a href="#hudson-artifacts-option-provider"
		  ><span class="toc-section-number"
		    >8.13.6.1</span
		    > Hudson artifacts option provider</a
		  ></li
		><li
		><a href="#yum-repoquery-option-model-provider"
		  ><span class="toc-section-number"
		    >8.13.6.2</span
		    > Yum repoquery option model provider</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#resource-editor"
	  ><span class="toc-section-number"
	    >8.14</span
	    > Resource Editor</a
	  ><ul
	  ><li
	    ><a href="#definition"
	      ><span class="toc-section-number"
		>8.14.1</span
		> Definition</a
	      ></li
	    ><li
	    ><a href="#using-properties"
	      ><span class="toc-section-number"
		>8.14.2</span
		> Using properties</a
	      ></li
	    ><li
	    ><a href="#using-remoteurl"
	      ><span class="toc-section-number"
		>8.14.3</span
		> Using remoteUrl</a
	      ><ul
	      ><li
		><a href="#streamlining-the-interface"
		  ><span class="toc-section-number"
		    >8.14.3.1</span
		    > Streamlining the interface</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#examples"
	      ><span class="toc-section-number"
		>8.14.4</span
		> Examples</a
	      ><ul
	      ><li
		><a href="#simple-site-integration"
		  ><span class="toc-section-number"
		    >8.14.4.1</span
		    > Simple site integration</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#webhooks"
	  ><span class="toc-section-number"
	    >8.15</span
	    > Webhooks</a
	  ><ul
	  ><li
	    ><a href="#execution-notification-content"
	      ><span class="toc-section-number"
		>8.15.1</span
		> Execution Notification Content</a
	      ></li
	    ><li
	    ><a href="#execution-notification-headers"
	      ><span class="toc-section-number"
		>8.15.2</span
		> Execution Notification Headers</a
	      ></li
	    ><li
	    ><a href="#execution-notification-url-token-expansion"
	      ><span class="toc-section-number"
		>8.15.3</span
		> Execution Notification URL Token Expansion</a
	      ></li
	    ></ul
	  ></li
	></ul
      ></li
    ><li
    ><a href="#rundeck-api"
      ><span class="toc-section-number"
	>9</span
	> RunDeck API</a
      ></li
    ><li
    ><a href="#rundeck-plugins"
      ><span class="toc-section-number"
	>10</span
	> RunDeck Plugins</a
      ><ul
      ><li
	><a href="#installing-plugins"
	  ><span class="toc-section-number"
	    >10.1</span
	    > Installing Plugins</a
	  ></li
	><li
	><a href="#uninstalling-or-updating-plugins"
	  ><span class="toc-section-number"
	    >10.2</span
	    > Uninstalling or Updating Plugins</a
	  ></li
	><li
	><a href="#about-plugins"
	  ><span class="toc-section-number"
	    >10.3</span
	    > About Plugins</a
	  ></li
	><li
	><a href="#types-of-plugins"
	  ><span class="toc-section-number"
	    >10.4</span
	    > Types of Plugins</a
	  ><ul
	  ><li
	    ><a href="#node-execution-plugins"
	      ><span class="toc-section-number"
		>10.4.1</span
		> Node Execution Plugins</a
	      ></li
	    ><li
	    ><a href="#resource-model-source-plugins"
	      ><span class="toc-section-number"
		>10.4.2</span
		> Resource Model Source Plugins</a
	      ></li
	    ><li
	    ><a href="#resource-format-plugins"
	      ><span class="toc-section-number"
		>10.4.3</span
		> Resource Format Plugins</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#about-services-and-providers"
	  ><span class="toc-section-number"
	    >10.5</span
	    > About Services and Providers</a
	  ></li
	><li
	><a href="#using-providers"
	  ><span class="toc-section-number"
	    >10.6</span
	    > Using Providers</a
	  ><ul
	  ><li
	    ><a href="#node-execution-services"
	      ><span class="toc-section-number"
		>10.6.1</span
		> Node Execution Services</a
	      ><ul
	      ><li
		><a href="#node-specific"
		  ><span class="toc-section-number"
		    >10.6.1.1</span
		    > Node Specific</a
		  ></li
		><li
		><a href="#project-or-framework-scope"
		  ><span class="toc-section-number"
		    >10.6.1.2</span
		    > Project or Framework Scope</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#resource-model-sources"
	      ><span class="toc-section-number"
		>10.6.2</span
		> Resource Model Sources</a
	      ><ul
	      ><li
		><a href="#resource-model-source-configuration"
		  ><span class="toc-section-number"
		    >10.6.2.1</span
		    > Resource Model Source configuration</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#resource-format-generators-and-parsers"
	      ><span class="toc-section-number"
		>10.6.3</span
		> Resource Format Generators and Parsers</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#when-node-execution-service-providers-are-invoked"
	  ><span class="toc-section-number"
	    >10.7</span
	    > When Node Execution Service providers are invoked</a
	  ></li
	><li
	><a href="#built-in-providers"
	  ><span class="toc-section-number"
	    >10.8</span
	    > Built-in providers</a
	  ><ul
	  ><li
	    ><a href="#node-execution-services-1"
	      ><span class="toc-section-number"
		>10.8.1</span
		> Node Execution services</a
	      ><ul
	      ><li
		><a href="#ssh-provider"
		  ><span class="toc-section-number"
		    >10.8.1.1</span
		    > SSH Provider</a
		  ><ul
		  ><li
		    ><a href="#configuring-scp-file-copier"
		      ><span class="toc-section-number"
			>10.8.1.1.1</span
			> Configuring SCP File Copier</a
		      ></li
		    ><li
		    ><a href="#configuring-ssh-authentication-type"
		      ><span class="toc-section-number"
			>10.8.1.1.2</span
			> Configuring SSH Authentication type</a
		      ></li
		    ><li
		    ><a href="#configuring-ssh-username"
		      ><span class="toc-section-number"
			>10.8.1.1.3</span
			> Configuring SSH Username</a
		      ></li
		    ><li
		    ><a href="#configuring-ssh-private-keys"
		      ><span class="toc-section-number"
			>10.8.1.1.4</span
			> Configuring SSH private keys</a
		      ></li
		    ><li
		    ><a href="#configuring-ssh-password-authentication"
		      ><span class="toc-section-number"
			>10.8.1.1.5</span
			> Configuring SSH Password Authentication</a
		      ></li
		    ><li
		    ><a href="#configuring-secondary-sudo-password-authentication"
		      ><span class="toc-section-number"
			>10.8.1.1.6</span
			> Configuring Secondary Sudo Password Authentication</a
		      ></li
		    ></ul
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#resource-model-sources-1"
	      ><span class="toc-section-number"
		>10.8.2</span
		> Resource Model Sources</a
	      ><ul
	      ><li
		><a href="#file-resource-model-source-configuration"
		  ><span class="toc-section-number"
		    >10.8.2.1</span
		    > File Resource Model Source Configuration</a
		  ></li
		><li
		><a href="#url-resource-model-source-configuration"
		  ><span class="toc-section-number"
		    >10.8.2.2</span
		    > URL Resource Model Source Configuration</a
		  ></li
		><li
		><a href="#directory-resource-model-source-configuration"
		  ><span class="toc-section-number"
		    >10.8.2.3</span
		    > Directory Resource Model Source Configuration</a
		  ></li
		><li
		><a href="#script-resource-model-source-configuration"
		  ><span class="toc-section-number"
		    >10.8.2.4</span
		    > Script Resource Model Source Configuration</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#resource-format-services"
	      ><span class="toc-section-number"
		>10.8.3</span
		> Resource Format services</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#pre-installed-plugins"
	  ><span class="toc-section-number"
	    >10.9</span
	    > Pre-installed plugins</a
	  ><ul
	  ><li
	    ><a href="#script-plugin"
	      ><span class="toc-section-number"
		>10.9.1</span
		> script-plugin</a
	      ><ul
	      ><li
		><a href="#configuring-script-exec"
		  ><span class="toc-section-number"
		    >10.9.1.1</span
		    > Configuring script-exec</a
		  ></li
		><li
		><a href="#configuring-the-command-for-script-exec"
		  ><span class="toc-section-number"
		    >10.9.1.2</span
		    > Configuring the command for script-exec</a
		  ></li
		><li
		><a href="#configuring-the-working-directory"
		  ><span class="toc-section-number"
		    >10.9.1.3</span
		    > Configuring the working directory</a
		  ></li
		><li
		><a href="#configuring-the-shell"
		  ><span class="toc-section-number"
		    >10.9.1.4</span
		    > Configuring the shell</a
		  ></li
		><li
		><a href="#defining-the-script-exec-command"
		  ><span class="toc-section-number"
		    >10.9.1.5</span
		    > Defining the script-exec command</a
		  ></li
		><li
		><a href="#requirements-for-the-script-exec-command"
		  ><span class="toc-section-number"
		    >10.9.1.6</span
		    > Requirements for the script-exec command</a
		  ></li
		><li
		><a href="#configuring-script-copy"
		  ><span class="toc-section-number"
		    >10.9.1.7</span
		    > Configuring script-copy</a
		  ></li
		><li
		><a href="#configuring-the-command-for-script-copy"
		  ><span class="toc-section-number"
		    >10.9.1.8</span
		    > Configuring the command for script-copy</a
		  ></li
		><li
		><a href="#configuring-the-working-directory-1"
		  ><span class="toc-section-number"
		    >10.9.1.9</span
		    > Configuring the working directory</a
		  ></li
		><li
		><a href="#configuring-the-shell-1"
		  ><span class="toc-section-number"
		    >10.9.1.10</span
		    > Configuring the shell</a
		  ></li
		><li
		><a href="#configuring-the-remote-filepath"
		  ><span class="toc-section-number"
		    >10.9.1.11</span
		    > Configuring the remote filepath</a
		  ></li
		><li
		><a href="#defining-the-script-copy-command"
		  ><span class="toc-section-number"
		    >10.9.1.12</span
		    > Defining the script-copy command</a
		  ></li
		><li
		><a href="#defining-the-script-copy-filepath"
		  ><span class="toc-section-number"
		    >10.9.1.13</span
		    > Defining the script-copy filepath</a
		  ></li
		><li
		><a href="#requirements-of-script-copy-command"
		  ><span class="toc-section-number"
		    >10.9.1.14</span
		    > Requirements of script-copy command</a
		  ></li
		><li
		><a href="#example-scripts"
		  ><span class="toc-section-number"
		    >10.9.1.15</span
		    > Example Scripts</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#stub-plugin"
	      ><span class="toc-section-number"
		>10.9.2</span
		> stub-plugin</a
	      ></li
	    ></ul
	  ></li
	></ul
      ></li
    ><li
    ><a href="#plugin-development"
      ><span class="toc-section-number"
	>11</span
	> Plugin Development</a
      ><ul
      ><li
	><a href="#java-plugin-development"
	  ><span class="toc-section-number"
	    >11.1</span
	    > Java Plugin Development</a
	  ><ul
	  ><li
	    ><a href="#provider-classes"
	      ><span class="toc-section-number"
		>11.1.1</span
		> Provider Classes</a
	      ></li
	    ><li
	    ><a href="#jar-dependencies"
	      ><span class="toc-section-number"
		>11.1.2</span
		> Jar Dependencies</a
	      ></li
	    ><li
	    ><a href="#available-services:"
	      ><span class="toc-section-number"
		>11.1.3</span
		> Available Services:</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#provider-lifecycle"
	  ><span class="toc-section-number"
	    >11.2</span
	    > Provider Lifecycle</a
	  ><ul
	  ><li
	    ><a href="#node-executor-providers"
	      ><span class="toc-section-number"
		>11.2.1</span
		> Node Executor Providers</a
	      ></li
	    ><li
	    ><a href="#file-copier-providers"
	      ><span class="toc-section-number"
		>11.2.2</span
		> File Copier Providers</a
	      ></li
	    ><li
	    ><a href="#resource-model-source-providers"
	      ><span class="toc-section-number"
		>11.2.3</span
		> Resource Model Source Providers</a
	      ></li
	    ><li
	    ><a href="#resource-format-parser-and-generator-providers"
	      ><span class="toc-section-number"
		>11.2.4</span
		> Resource Format Parser and Generator Providers</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#script-plugin-development"
	  ><span class="toc-section-number"
	    >11.3</span
	    > Script Plugin Development</a
	  ><ul
	  ><li
	    ><a href="#provider-metadata"
	      ><span class="toc-section-number"
		>11.3.1</span
		> Provider metadata</a
	      ></li
	    ><li
	    ><a href="#configurable-resource-model-source-script-plugin"
	      ><span class="toc-section-number"
		>11.3.2</span
		> Configurable Resource Model Source Script Plugin</a
	      ></li
	    ><li
	    ><a href="#how-script-plugin-providers-are-invoked"
	      ><span class="toc-section-number"
		>11.3.3</span
		> How script plugin providers are invoked</a
	      ></li
	    ><li
	    ><a href="#script-provider-requirements"
	      ><span class="toc-section-number"
		>11.3.4</span
		> Script provider requirements</a
	      ></li
	    ></ul
	  ></li
	></ul
      ></li
    ></ul
  ></div
>
<div id="introduction"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >1</span
      > Introduction</a
    ></h1
  ><div id="what-is-this-guide-about"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.1</span
	> What is this guide about?</a
      ></h2
    ><p
    >Welcome to the RunDeck user guide. This guide was written to help administrators quickly become productive with the RunDeck server and tools.</p
    ></div
  ><div id="what-is-rundeck"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.2</span
	> What is RunDeck?</a
      ></h2
    ><p
    >RunDeck is open source software that helps you automate ad-hoc and routine procedures in data center or cloud environments. RunDeck provides a number of features that will alleviate time-consuming grunt work and make it easy for you to scale up your scripting efforts.</p
    ><p
    >RunDeck allows you to run tasks on any number of nodes from a web-based or command-line interface. RunDeck also includes other features that make it easy to scale up your scripting efforts including: access control, workflow building, scheduling, logging, and integration with external sources for node and option data.</p
    ><p
    >Already itching to install it? Jump ahead to <a href="#installing-rundeck"
      >Installing RunDeck</a
      >.</p
    ><div id="who-makes-the-rundeck-software"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.2.1</span
	  > Who makes the RunDeck software?</a
	></h3
      ><p
      >RunDeck is developed on GitHub as a project called <a href="https://github.com/dtolabs/rundeck"
	>dtolabs/rundeck</a
	>. Many ideas for RunDeck come from <a href="http://www.dtosolutions.com"
	>DTO Solutions</a
	> consultants working in the field, however all are welcome to join the project and contribute.</p
      ><p
      >RunDeck is free software and is public under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html"
	>Apache Software License</a
	>.</p
      ></div
    ></div
  ><div id="getting-help"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.3</span
	> Getting help</a
      ></h2
    ><ul
    ><li
      >Mailing list: <a href="http://groups.google.com/group/rundeck-discuss"
	>http://groups.google.com/group/rundeck-discuss</a
	><br
	 /></li
      ><li
      >IRC: irc://irc.freenode.net/rundeck</li
      ><li
      >Unix manual pages: RunDeck installation includes a set of Unix manual pages describing the shell tools. <code>man -k rundeck</code></li
      ></ul
    ></div
  ><div id="rundeck-from-30000-feet"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.4</span
	> RunDeck from 30,000 feet</a
      ></h2
    ><div id="rundeck-features"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.4.1</span
	  > RunDeck features</a
	></h3
      ><ul
      ><li
	>distributed command execution</li
	><li
	>pluggable execution system uses SSH by default</li
	><li
	>multi-step workflows</li
	><li
	>job definition and on demand or scheduled runs</li
	><li
	>graphical console for command and job execution</li
	><li
	>role-based access control policy with support for LDAP/ActiveDirectory</li
	><li
	>history and auditing logs</li
	><li
	>open integration to external host inventory tools</li
	><li
	>command line interface</li
	><li
	>Web API</li
	></ul
      ></div
    ><div id="rundeck-in-context"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.4.2</span
	  > RunDeck in context</a
	></h3
      ><p
      >RunDeck is meant to compliment the tools you already use (including frameworks like Puppet, Chef, and Rightscale) and is geared towards helping you automate actions across them. If you currently manage your servers by running commands from the terminal or through scripts that SSH commands in a loop, RunDeck is a more user friendly alternative. Instead of managing node lists in a spreadsheet or wiki page and then having to transcribe the list to where you execute commands, RunDeck acts as a command and control portal that lets you execute commands using features like node filtering and parallel execution.</p
      ><p
      >RunDeck also works well for managing virtual servers, be they from a cloud provider or from locally hosted virtualization software. The node abstraction enabled by the RunDeck command dispatcher helps you cope with managing dynamic environments.</p
      ><p
      >Many automation tasks cross the boundaries of tool sets. For example, deploying software or maintaining an application often involves using tools up and down the management tool chain. RunDeck has a simple to use interface to create multi-step workflows that might call a package manager, configuration management tool, system utilities, or your own scripts. RunDeck is really meant to help glue tools together and in return enable a push button interface you can hand off to others.</p
      ></div
    ><div id="rundeck-architecture"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.4.3</span
	  > RunDeck architecture</a
	></h3
      ><p
      >RunDeck is a server application you host on a system you designate a central administrative control point. Internally, RunDeck stores job definitions and execution history in a relational database. Output from command and job executions is saved on disk.</p
      ><p
      >RunDeck distributed command execution is performed using SSH. SSH connections are made using key-based authentication. RunDeck server configuration includes settings to define the outbound user allowed by the remote hosts. Remote machines are not required to make SSH connections back to the server.</p
      ><div class="figure"
      ><img src="figures/fig0001.png" alt="RunDeck architecture"
	 /><p class="caption"
	>RunDeck architecture</p
	></div
      ><p
      >The RunDeck application itself is a Java-based webapp that runs in its own embedded servlet container. The application provides both graphical interface and network interfaces used by the RunDeck shell tools.</p
      ><p
      >Access to the RunDeck application requires a login and password. The default RunDeck installation uses a flat file user directory containing a set of default logins. Logins are defined in terms of a username and password as well as one or more user groups. An alternative configuration to the flat file user directory, is LDAP (e.g., ActiveDirectory). Users must also be authorized to perform actions like command and job execution. This is controlled by an access control facility that reads policy files defined by the RunDeck administrator. Privilege is granted if a user's group membership meets the requirements of the policy.</p
      ><p
      >Two installation methods are supported:</p
      ><ul
      ><li
	><p
	  >RPM: The RPM is intended for managed installation and provides robust tools that integrate with your environment, man pages, shell tool set in your path, init.d startup and shutdown</p
	  ></li
	><li
	><p
	  >Launcher: The launcher is intended for quick setup, to get you running right away. Perfect for bootstrapping a project or trying a new feature.</p
	  ></li
	></ul
      ></div
    ></div
  ><div id="feedback"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.5</span
	> Feedback</a
      ></h2
    ><p
    >If you find problems with RunDeck, or if you have questions, remarks, or ideas about it, please send an email to the RunDeck mailing list, <script type="text/javascript"
      >
<!--
h='&#x67;&#114;&#x6f;&#x75;&#112;&#x73;&#46;&#x67;&#x6f;&#x6f;&#x67;&#108;&#x65;&#46;&#x63;&#x6f;&#x6d;';a='&#64;';n='&#114;&#x75;&#110;&#100;&#x65;&#x63;&#x6b;&#x2d;&#100;&#x69;&#x73;&#x63;&#x75;&#x73;&#x73;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+'<code>'+e+'</code>'+'<\/'+'a'+'>');
// -->
</script
      ><noscript
      >&#114;&#x75;&#110;&#100;&#x65;&#x63;&#x6b;&#x2d;&#100;&#x69;&#x73;&#x63;&#x75;&#x73;&#x73;&#32;&#x61;&#116;&#32;&#x67;&#114;&#x6f;&#x75;&#112;&#x73;&#32;&#100;&#x6f;&#116;&#32;&#x67;&#x6f;&#x6f;&#x67;&#108;&#x65;&#32;&#100;&#x6f;&#116;&#32;&#x63;&#x6f;&#x6d;</noscript
      >.</p
    ></div
  ><div id="whats-next"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.6</span
	> What's next?</a
      ></h2
    ><p
    >The remainder of the guide will give you a quick conceptual overview, and take you through installation and setup. After you are set up, you will learn about the distributed command dispatcher and how to use it to run ad-hoc commands. From there, you will learn about Jobs, defining multi-step procedures with Job workflows and how to parameterize them with options.</p
    ></div
  ></div
><div id="getting-started"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >2</span
      > Getting Started</a
    ></h1
  ><p
  >This chapter helps new users getting started with RunDeck. We will begin by explaining the basics, covering essential RunDeck concepts and terminology and then move on to installation and finally, setup. At the end of this chapter you should understand what RunDeck is, how you should use it and you should be all setup to do so.</p
  ><div id="rundeck-basics"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.1</span
	> RunDeck Basics</a
      ></h2
    ><p
    >Several fundamental concepts underly and drive the development of the RunDeck system. If you are a new user, knowing about them will help you use and integrate RunDeck into your environment.</p
    ><div id="command-dispatching"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.1</span
	  > Command dispatching</a
	></h3
      ><p
      >RunDeck supports a notion called <em
	>command dispatching</em
	> wherein a user specifies dispatch criteria along with an action (called a command) and this specification is used to perform a distributed execution.</p
      ><p
      >The <em
	>command dispatcher</em
	> is an internal mechanism that looks up node resources meeting specified filtering criteria and then performs the distributed command execution. The command executes in a data context that contains information about the Node resource. Besides node filtering, dispatcher options include parameters to control parallel execution, ordering and error handling.</p
      ><p
      >The command dispatcher supports two methods of command execution:</p
      ><ul
      ><li
	><em
	  >Ad-hoc commands</em
	  >: Execute any shell command or shell script across a set of hosts.<br
	   /></li
	><li
	><em
	  >Jobs</em
	  >: Encapsulate commands as a named Job and tie them together into multi-step workflows.</li
	></ul
      ><p
      >RunDeck provides both graphical and command line interfaces to interact with the command dispatcher.</p
      ><p
      >You can also use the Web API to interface with all aspects of the command dispatcher. (See the <a href="api/index.html"
	>RunDeck API</a
	>.)</p
      ></div
    ><div id="resource-model"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.2</span
	  > Resource model</a
	></h3
      ><p
      >The command dispatcher works in conjunction with a resource model. A <em
	>resource model</em
	> is a representation of hosts deployed in your network. A <em
	>Node</em
	> is a resource that is either a physical or virtual instance of a network accessible host.</p
      ><p
      >Nodes have a number of basic properties but these properties can be extended to include arbitrary named key value pairs.</p
      ><p
      >You can configure RunDeck to retrieve and store resource model data from multiple sources, and RunDeck defines several resource model document formats to facilitate the transfer of this information.</p
      ><p
      >Resource Model data sources can be local files on disk, or remotely accessible services. A <em
	>URL resource model source</em
	> is an external service accessible via the HTTP GET method that returns data in one of the supported resource document formats.</p
      ><p
      >RunDeck currently supports XML and YAML document formats. See <a href="#resource-model-document-formats"
	>Resource Model Document formats</a
	>).</p
      ><p
      >Each project can be configured to have multiple sources of Resource Model data. See <a href="#resource-model-sources"
	>Resource Model Sources</a
	>.</p
      ></div
    ><div id="authorization"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.3</span
	  > Authorization</a
	></h3
      ><p
      >RunDeck enforces an <em
	>access control policy</em
	> that grants certain privileges to groups of users. Every action executed through the RunDeck command dispatcher must meet the requirements of an access control policy definition.</p
      ><p
      >Since RunDeck respects the policy definition, you can define role-based authorization to restrict some users to only a subset of actions. This enables a self-service type interface, where some users have access to only a limited set of executable actions.</p
      ><p
      >See: <a href="#authorization-1"
	>Authorization</a
	>.</p
      ></div
    ><div id="project"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.4</span
	  > Project</a
	></h3
      ><p
      >A <em
	>project</em
	> is a place to separate management activity. All RunDeck activities occur within the context of a project. Each project has its own resource model and Job store.</p
      ><p
      >Multiple projects can be maintained on the same RunDeck server. Projects are independent from one another, so you can use them to organize unrelated systems within a single RunDeck installation. This can be useful for managing different infrastructures.</p
      ></div
    ></div
  ><div id="installing-rundeck"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.2</span
	> Installing RunDeck</a
      ></h2
    ><p
    >Assuming the system requirements are met, RunDeck can be installed either from source, system package or via the launcher.</p
    ><div id="system-requirements"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.1</span
	  > System Requirements</a
	></h3
      ><p
      >The following operating systems are known to support RunDeck:</p
      ><ul
      ><li
	>Linux: Most recent distributions are likely to work</li
	><li
	>Windows: XP, Server and above</li
	><li
	>Mac OS X 10.4 or later</li
	></ul
      ><p
      >Root (or Administrator on Windows) is not required or recommended. We recommend using a dedicated user account such as &quot;rundeck&quot;.</p
      ><p
      >If there is need for root access, please set up the RunDeck user to have access via <a href="http://en.wikipedia.org/wiki/Sudo"
	>sudo</a
	>.</p
      ><div id="java"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >2.2.1.1</span
	    > Java</a
	  ></h4
	><p
	>RunDeck is a Java-Servlet based server and therefore requires the Java runtime.</p
	><p
	>The install process requires that the latest version of Java 1.6 be installed. Both the <a href="http://openjdk.java.net/"
	  >Open JDK</a
	  > and <a href="http://java.com/"
	  >Sun/Oracle</a
	  > JVMs can be used. You must have the JAVA_HOME environment variable defined in your environment before running the launcher. The RPM will use the java found on your path. See <a href="#setting-java_home"
	  >Setting JAVA_HOME</a
	  > if you want to run a different version of java.</p
	><p
	>Verify your Java version to check it meets the requirement:</p
	><pre
	><code
	  >$ java -version
java version &quot;1.6.0_22&quot;
Java(TM) SE Runtime Environment (build 1.6.0_22-b04-307-10M3261)
Java HotSpot(TM) 64-Bit Server VM (build 17.1-b03-307, mixed mode)
</code
	  ></pre
	></div
      ><div id="network-access"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >2.2.1.2</span
	    > Network access</a
	  ></h4
	><p
	>When the server starts, it binds to several TCP ports by default:</p
	><ul
	><li
	  >4440 (http)</li
	  ><li
	  >4443 (https)</li
	  ></ul
	><p
	>To check if the ports are free on a Unix host, run:</p
	><pre
	><code
	  >netstat -an | egrep '4440|4443' 
</code
	  ></pre
	><p
	>If the ports are in use on the server, you will see output similar to below:</p
	><pre
	><code
	  >tcp46      0      0  *.4440                 *.*                    LISTEN
</code
	  ></pre
	><p
	>The installation procedures describe how to choose different ports, if there is a conflict.</p
	><p
	>In addition, TCP port 22 (by default) needs to be open on the clients for SSH.</p
	><p
	>Clients should be set up to allow the RunDeck server user to connect to the clients using SSH via public-key authentication. It should not prompt for a password. See <a href="#configuring-remote-machine-for-ssh"
	  >Configure remote machine for SSH</a
	  > in the Administration chapter.</p
	><p
	>There are various ways for installing SSH on Windows; we recommend <a href="http://www.cygwin.org"
	  >Cygwin</a
	  >.</p
	></div
      ></div
    ><div id="installing-from-source"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.2</span
	  > Installing from Source</a
	></h3
      ><p
      >Checkout the sources from <a href="https://github.com/dtolabs/rundeck"
	>GitHub</a
	></p
      ><p
      >You can build either the launcher jar (self-running archive), or a RPM.</p
      ><pre
      ><code
	>make
</code
	></pre
      ><p
      >Creates the rundeck-launcher.jar</p
      ><p
      >Build the RPM:</p
      ><pre
      ><code
	>make rpm
</code
	></pre
      ><p
      >To build clean:</p
      ><pre
      ><code
	>make clean
</code
	></pre
      ><p
      >Documentation can be built using: <code
	>make clean docs</code
	>. Documentation build requires <a href="http://johnmacfarlane.net/pandoc/"
	>pandoc</a
	>. The RPM build depends on the the documentation as well.</p
      ></div
    ><div id="installing-with-rpm"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.3</span
	  > Installing with RPM</a
	></h3
      ><p
      >If you want to install RunDeck on Linux via a binary installer, you can generally do so through the RPM tool that comes with your distribution.</p
      ><pre
      ><code
	># rpm -i rundeck-1.1.0.noarch.rpm
</code
	></pre
      ><p
      >To install it using yum, first install the yum repo package and then run yum install:</p
      ><pre
      ><code
	># rpm -Uvh http://rundeck.org/latest.rpm
# yum install rundeck
</code
	></pre
      ></div
    ><div id="installing-with-launcher"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.4</span
	  > Installing with Launcher</a
	></h3
      ><p
      >Use the launcher as an alternative to a system package:</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Download the launcher jar file.</li
	><li
	><p
	  >Define RDECK_BASE environment variable to the location of the install</p
	  ><pre
	  ><code
	    >export RDECK_BASE=$HOME/rundeck; # or where you like it
</code
	    ></pre
	  ></li
	><li
	><p
	  >Create the directory for the installation.</p
	  ><pre
	  ><code
	    >mkdir -p $RDECK_BASE 
</code
	    ></pre
	  ></li
	><li
	><p
	  >Copy the launcher jar to the installation directory.</p
	  ><pre
	  ><code
	    >cp rundeck-launcher-1.1.0.jar $RDECK_BASE
</code
	    ></pre
	  ></li
	><li
	><p
	  >Change directory and run the jar.</p
	  ><pre
	  ><code
	    >cd $RDECK_BASE    
java -jar rundeck-launcher-1.1.0.jar
</code
	    ></pre
	  ></li
	><li
	><p
	  >Wait for the Started message.</p
	  ><pre
	  ><code
	    >2010-11-19 13:35:51.127::INFO:  Started SocketConnector@0.0.0.0:4440
</code
	    ></pre
	  ></li
	><li
	><p
	  >Update your shell environment</p
	  ><pre
	  ><code
	    >PATH=$PATH:$RDECK_BASE/tools/bin
MANPATH=$MANPATH:$RDECK_BASE/docs/man
</code
	    ></pre
	  ></li
	></ol
      ><p
      >If you get an error message that resembles the one below, you probably are using an unsupported Java version.</p
      ><pre
      ><code
	>Exception in thread &quot;main&quot; java.lang.UnsupportedClassVersionError: Bad version number in .class file
</code
	></pre
      ><p
      >See the <a href="#startup-and-shutdown"
	>startup and shutdown</a
	> section for instructions on using the <code
	>rundeckd</code
	> shell tool to manage the rundeck launcher process.</p
      ><div id="launcher-options"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >2.2.4.1</span
	    > Launcher Options</a
	  ></h4
	><p
	>The launcher jar can take a number of options to specify how the server should start. If you execute with a &quot;-h&quot; you will see the usage information:</p
	><pre
	><code
	  >java -jar rundeck-launcher-1.3.0.jar -h

usage: java [JAVA_OPTIONS] -jar rundeck-launcher.jar  [-c PATH] [-d]
       [--installonly] [-s PATH] [-b PATH] [-p PATH] [-h] [-x PATH]
       [--skipinstall] [--serverdir PATH] [--datadir PATH]

Run the rundeck server, installing the necessary components if they do not
exist.
    --skipinstall         Skip the extraction of the utilities from the
                          launcher.
    --installonly         Perform installation only and do not start the
                          server.
 -b,--basedir &lt;PATH&gt;      The basedir
 -c,--configdir &lt;PATH&gt;    The location of the configuration.
 -d                       Show debug information
 -h,--help                Display this message.
 -p,--projectdir &lt;PATH&gt;   The location of Rundeck's project data.
 -s,--sbindir &lt;PATH&gt;      The install directory for the tools used by
                          administrators.
 -x,--bindir &lt;PATH&gt;       The install directory for the tools used by
                          users.
</code
	  ></pre
	><p
	>These options can be used to customize the directories used by the launcher. By default all the directories are organized by convention within the current working directory where the launcher jar is located.</p
	></div
      ><div id="system-properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >2.2.4.2</span
	    > System Properties</a
	  ></h4
	><p
	>You can also customize the launcher behavior by using some java system properties.</p
	><p
	>Specify these properties using the normal <code
	  >-Dproperty=value</code
	  > commandline options to the <code
	  >java</code
	  > command:</p
	><ul
	><li
	  ><code
	    >server.http.port</code
	    > The HTTP port to use for the server, default &quot;4440&quot;</li
	  ><li
	  ><code
	    >server.https.port</code
	    > The HTTPS port to use or the server, default &quot;4443&quot;</li
	  ><li
	  ><code
	    >server.http.host</code
	    > Address/hostname to listen on, default is all addresses &quot;0.0.0.0&quot;</li
	  ><li
	  ><code
	    >server.hostname</code
	    > Hostname to use for the server, default is the system hostname</li
	  ><li
	  ><code
	    >server.web.context</code
	    > Web context path to use, such as &quot;/rundeck&quot;. Default is &quot;/&quot;.</li
	  ><li
	  ><code
	    >rdeck.base</code
	    > RunDeck Basedir to use, default is the directory containing the launcher jar</li
	  ><li
	  ><code
	    >server.datastore.path</code
	    > Path to server datastore dir</li
	  ><li
	  ><code
	    >default.user.name</code
	    > Username for default user account to create</li
	  ><li
	  ><code
	    >default.user.password</code
	    > Password for default user account to create</li
	  ><li
	  ><code
	    >rundeck.jaaslogin</code
	    > &quot;true/false&quot; - if true, enable JAAS login. If false, use the realm.properties file for login information.</li
	  ><li
	  ><code
	    >loginmodule.name</code
	    > Custom JAAS loginmodule name to use</li
	  ><li
	  ><code
	    >loginmodule.conf.name</code
	    > Name of a custom JAAS config file, located in the server's config dir.</li
	  ><li
	  ><code
	    >rundeck.config.name</code
	    > Name of a custom rundeck config file, located in the server's config dir.</li
	  ><li
	  ><code
	    >rundeck.ssl.config</code
	    > Path to the SSL config properties file to enable SSL. If not set, SSL is not enabled.</li
	  ></ul
	><p
	>For more information about using SSL, see <a href="#configuring-rundeck-for-ssl"
	  >Administration - Configuring Rundeck for SSL</a
	  ></p
	></div
      ></div
    ></div
  ><div id="upgrading-rundeck"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.3</span
	> Upgrading RunDeck</a
      ></h2
    ><p
    >If you are upgrading RunDeck from a previous version, please read the <a href="upgrading/index.html"
      >RunDeck Upgrade Guide</a
      >.</p
    ></div
  ><div id="first-time-setup"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.4</span
	> First-Time Setup</a
      ></h2
    ><div id="logins"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.4.1</span
	  > Logins</a
	></h3
      ><p
      >RunDeck supports a number of user directory configurations. By default, the installation uses a file based directory, but connectivity to LDAP is also available. See <a href="#managing-logins"
	>Managing logins</a
	> in the Administration chapter.</p
      ><p
      >The RunDeck installation process will have defined a set of temporary logins useful during the getting started phase.</p
      ><ul
      ><li
	><code
	  >user</code
	  >: Has access to run commands and jobs but unable to modify job definitions. Password: &quot;user&quot;</li
	><li
	><code
	  >admin</code
	  >: Belongs to the &quot;admin&quot; group and is automatically granted the &quot;admin&quot; and &quot;user&quot; role privileges. Password: &quot;admin&quot;</li
	></ul
      ></div
    ><div id="group-membership"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.4.2</span
	  > Group membership</a
	></h3
      ><p
      >If you installed RunDeck using the RPM installation method, it will have created a unix group called &quot;rundeck&quot;.</p
      ><pre
      ><code
	>$ groups rundeck
rundeck : rundeck
</code
	></pre
      ><p
      >It also made several log files writable to members of the &quot;rundeck&quot; group.</p
      ><pre
      ><code
	>$ ls -l /var/log/rundeck/command.log
-rw-rw-r-- 1 rundeck rundeck 588 Dec  2 11:24 /var/log/rundeck/command.log
</code
	></pre
      ><p
      >If you want to use the RunDeck shell tools, be sure to add that group to the necessary user accounts.</p
      ><p
      >RunDeck shell tool users that do not belong to group, rundeck, will get error messages like so:</p
      ><pre
      ><code
	>$ rd-jobs
log4j:ERROR setFile(null,true) call failed. java.io.FileNotFoundException: /var/log/rundeck/command.log (Permission denied)
</code
	></pre
      ><p
      >Consult the <a href="http://linux.die.net/man/8/usermod"
	>usermod</a
	> command to modify a user account.</p
      ></div
    ></div
  ><div id="summary"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.5</span
	> Summary</a
      ></h2
    ><p
    >You should now have a basic understanding of RunDeck. You should also have a working version of RunDeck on your system and login access. It is now time to learn some RunDeck basics.</p
    ></div
  ></div
><div id="rundeck-basics-1"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >3</span
      > RunDeck Basics</a
    ></h1
  ><p
  >This chapter covers the basics for using RunDeck. The chapter begins by describing the RunDeck user interfaces, both its graphical and command line. From there it will show you how to set up a project and learn about command execution. You will learn more about using the command dispatcher to control execution and finally, how to find and use history.</p
  ><div id="rundeck-interfaces"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.1</span
	> RunDeck Interfaces</a
      ></h2
    ><p
    >RunDeck provides two primary user interfaces:</p
    ><ul
    ><li
      >An HTML-based graphical console</li
      ><li
      >A suite of shell tools</li
      ></ul
    ><p
    >Both interfaces allow you to view resources, dispatch commands, as well as, store and run jobs.</p
    ><p
    >In addition RunDeck provides a Web API which can be used to interact with the server programattically. See <a href="api/index.html"
      >RunDeck API</a
      >.</p
    ><div id="graphical-console"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.1.1</span
	  > Graphical Console</a
	></h3
      ><p
      >To get started, go to the URL for your RunDeck server. Login to the web app with the credentials defined by the RunDeck user directory configuration.</p
      ><div id="navigation"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.1.1.1</span
	    > Navigation</a
	  ></h4
	><p
	>The RunDeck page header contains global navigation control to move between tabbed pages: Run, Jobs and History. It also has links to logout, view your user profile and a link to this online help.</p
	><div class="figure"
	><img src="figures/fig0201.png" alt="Top navigation bar"
	   /><p class="caption"
	  >Top navigation bar</p
	  ></div
	><dl
	><dt
	  >Run</dt
	  ><dd
	  ><p
	    >The Run page is used to execute ad hoc commands. It displays filtered Node resources configured in your Project resource model. A filter control can be used to limit the listing to just the Node resources matching the filter criteria.</p
	    ></dd
	  ><dt
	  >Jobs</dt
	  ><dd
	  ><p
	    >From the Jobs page, one can list, create and run Jobs. A configurable filter allows a user to limit the Job listing to those Jobs matching the filtering criteria. These filter settings can be saved to a Users profile. Only authorized jobs will be visible.</p
	    ></dd
	  ><dt
	  >History</dt
	  ><dd
	  ><p
	    >From the History page, one can view currently executing commands in the &quot;Now Running&quot; area or browse execution history. The execution history can be filtered based on user selected parameters. Once the filter has been set, the matching history is displayed. The current filter settings also configure an RSS link, found in the top right of the page.</p
	    ></dd
	  ><dt
	  >Project menu</dt
	  ><dd
	  ><p
	    >The top navigation bar contains a menu to select the desired project. If only one project exists, the menu will automatically be defaulted.</p
	    ></dd
	  ><dt
	  >Admin</dt
	  ><dd
	  ><p
	    >If your login belongs to the &quot;admin&quot; group and therefore granted &quot;admin&quot; privileges, a wrench icon will be displayed next to your login name. This page allows the admin to view group memberships for all users, as well as, edit their profile data.</p
	    ></dd
	  ><dt
	  >User profile</dt
	  ><dd
	  ><p
	    >Shows a page showing group memberships.</p
	    ></dd
	  ><dt
	  >Logout</dt
	  ><dd
	  ><p
	    >Pressing this link ends the login session and will require a subsequent login.</p
	    ></dd
	  ><dt
	  >Help</dt
	  ><dd
	  ><p
	    >Opens a page to the online help system.</p
	    ></dd
	  ></dl
	></div
      ><div id="now-running"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.1.1.2</span
	    > Now running</a
	  ></h4
	><p
	>The &quot;Now running&quot; section appears at the top of the Run and Jobs pages and provides a view into the execution queue. Any currently executing ad hoc command or Job will be listed and include information like the name of the job, when it started, who ran it, and a link to the execution output.</p
	><div class="figure"
	><img src="figures/fig0215.png" alt="Now running"
	   /><p class="caption"
	  >Now running</p
	  ></div
	><p
	>Jobs that have been run before also have a progress bar approximating duration.</p
	></div
      ></div
    ><div id="shell-tools"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.1.2</span
	  > Shell Tools</a
	></h3
      ><p
      >RunDeck includes a number of shell tools to dispatch commands, load and run Job definitions and interact with the dispatcher queue. These command tools are an alternative to functions accessible in the graphical console.</p
      ><dl
      ><dt
	><a href="dispatch.html"
	  >dispatch</a
	  ></dt
	><dd
	>Execute ad hoc commands and scripts</dd
	><dt
	><a href="rd-queue.html"
	  >rd-queue</a
	  ></dt
	><dd
	>Query the dispatcher for currently running Jobs and possibly kill them<br
	   /></dd
	><dt
	><a href="rd-jobs.html"
	  >rd-jobs</a
	  ></dt
	><dd
	>List defined jobs as well as load them from text file definitions</dd
	><dt
	><a href="run.html"
	  >run</a
	  ></dt
	><dd
	>Invoke the execution of a stored Job</dd
	><dt
	><a href="rd-project.html"
	  >rd-project</a
	  ></dt
	><dd
	>Setup a new RunDeck project</dd
	><dt
	><a href="rd-setup.html"
	  >rd-setup</a
	  ></dt
	><dd
	>(Re-)configure an instance of RunDeck</dd
	></dl
      ><p
      >Consult the online manual pages for options and usage information.</p
      ></div
    ></div
  ><div id="project-setup"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.2</span
	> Project Setup</a
      ></h2
    ><p
    >A RunDeck <em
      >Project</em
      > provides a space to manage related management activities.</p
    ><p
    >A Project can be set up either from the graphical console or using the <code
      >rd-project</code
      > shell tool.</p
    ><p
    >After logging into the graphical console, you will notice a Project menu in the top navigation bar. If no projects exist, you will be prompted to create a new project.</p
    ><div class="figure"
    ><img src="figures/fig0203-a.png" alt="Create project prompt"
       /><p class="caption"
      >Create project prompt</p
      ></div
    ><p
    >To start with, the only field you need to enter is the Project Name. You can change the other values later from the <a href="#gui-admin-page"
      >GUI Admin Page</a
      >.</p
    ><p
    >After entering your project name, RunDeck initializes it and returns you to the &quot;Run&quot; page.</p
    ><p
    >Projects can be created at any time by going back to the Project menu and selecting the &quot;Create a new project...&quot; item.</p
    ><div class="figure"
    ><img src="figures/fig0203.png" alt="Create project menu"
       /><p class="caption"
      >Create project menu</p
      ></div
    ><p
    >The <code
      >rd-project</code
      > shell tool can also be used to create a project.</p
    ><p
    >On the RunDeck server, execute the <code
      >rd-project</code
      > command and specify a project name, here we use &quot;examples&quot;:</p
    ><pre
    ><code
      >rd-project -a create -p examples
</code
      ></pre
    ><p
    >After running this command, you can login into the graphical console and see the new project in the project menu.</p
    ><p
    >You can also add configuration properties when you create the project, for example:</p
    ><pre
    ><code
      >rd-project -a create -p examples --project.ssh-keypath=/private/ssh.key
</code
      ></pre
    ><p
    >The project setup process generates Project configuration in the server, and a bootstrap resource model.</p
    ><div class="figure"
    ><img src="figures/fig0204.png" alt="Run page after new project"
       /><p class="caption"
      >Run page after new project</p
      ></div
    ><p
    >One node will be listed, the RunDeck server host. The server host is distinguished with the word &quot;server&quot; in red text.</p
    ><div id="resource-model-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.2.1</span
	  > Resource model</a
	></h3
      ><p
      >The Resource Model is the set of available Nodes that RunDeck can dispatch commands to, and their associated metadata. Each RunDeck Project has its own Resource Model.</p
      ><p
      >The initial resource model will contain information just about the RunDeck server host and is useful just for running local commands on the RunDeck server. You can browse the project resource model by going to the &quot;Run&quot; page.</p
      ><p
      >In the shell, you can list the Node resources in a resource model using the shell tool, <code
	>dispatch</code
	>. Specify project name using the <code
	>-p project</code
	> option.</p
      ><p
      >Here the <code
	>dispatch</code
	> command lists the registered server for the &quot;examples&quot; project after the project setup. The <code
	>-v</code
	> gives a verbose listing that includes more detail:</p
      ><pre
      ><code
	>$ dispatch -p examples -v   
 strongbad:
    hostname: strongbad
    osArch: x86_64
    osFamily: unix
    osName: Mac OS X
    osVersion: 10.6.2
    tags: ''
</code
	></pre
      ><p
      >Node resources have standard properties, such as &quot;hostname&quot; but these can be extended via attributes. One of the more useful properties is the &quot;tags&quot; property. A <em
	>tag</em
	> is a text label that you give to the Node, perhaps denoting a classification, a role the node plays in the environment, or group membership. Multiple tags can be defined for a given node.</p
      ><p
      >The output above shows the &quot;strongbad&quot; node currently has an empty tags property: <code
	>tags: ''</code
	>.</p
      ><p
      >It is important to start thinking about node tagging for the nodes you manage because you will use them later when specifying filtering options to drive distributed command dispatch.</p
      ><p
      >Each Project has a configuration file called <a href="#project.properties"
	>project.properties</a
	>, located at this path: <code
	>$RDECK_BASE/projects/</code
	><em
	>project</em
	><code
	>/etc/project.properties</code
	>.</p
      ><p
      >This configuration file contains two basic properties for accessing and storing resource model data:</p
      ><ul
      ><li
	><code
	  >project.resources.file</code
	  >: A local file path to read a resource model document</li
	><li
	><code
	  >project.resources.url</code
	  >: URL to an external resource model source (optional)</li
	></ul
      ><p
      >In addition, multiple pluggable &quot;Resource Model Sources&quot; can be configured for a project to retrieve additional Resource Model content from other sources. See <a href="#resource-model-sources"
	>Resource Model Sources</a
	>.</p
      ><p
      >You can configure RunDeck to retrieve and store resource model data from any source, so long as it can produce one of the RunDeck resource model document formats. (See <a href="#resource-model-document-formats"
	>Resource Model Document formats</a
	>.) Set the <code
	>project.resource.url</code
	> to the URL resource model source of your choice.</p
      ><p
      >Here's the XML document stored for the &quot;examples&quot; project that corresponds to the output printed by the <code
	>dispatch -v</code
	> shown earlier:</p
      ><pre
      ><code
	>&lt;project&gt;
    &lt;node name=&quot;strongbad&quot; type=&quot;Node&quot; 
      description=&quot;the RunDeck server host&quot; tags=&quot;&quot; 
      hostname=&quot;strongbad&quot; 
      osArch=&quot;x86_64&quot; osFamily=&quot;unix&quot; osName=&quot;Mac OS X&quot; osVersion=&quot;10.6.2&quot;
      username=&quot;alexh&quot; 
      editUrl=&quot;&quot; remoteUrl=&quot;&quot;/&gt;
&lt;/project&gt;
</code
	></pre
      ><p
      >You'll notice the root node is called <code
	>project</code
	> and there is a single node descriptor for &quot;strongbad&quot;. The <code
	>node</code
	> tag has a number of required and optional attributes. Additional node descriptors can be added by defining new <code
	>node</code
	> elements inside the <code
	>project</code
	> tag.</p
      ><p
      >The strongbad host does not have any tags defined for it. One or more tags can be defined. Use comma for the delimiter (e.g, <code
	>tags=&quot;tag1,tag2&quot;</code
	>).</p
      ><p
      >Here's an example of a node called &quot;homestar&quot; with just the required attributes:</p
      ><pre
      ><code
	>    &lt;node name=&quot;homestar&quot; type=&quot;Node&quot; 
      hostname=&quot;192.168.1.02&quot; 
      username=&quot;alexh&quot; /&gt;
</code
	></pre
      ><p
      >The <code
	>hostname</code
	> and <code
	>username</code
	> values are used for the SSH connection while the <code
	>name</code
	> and <code
	>type</code
	> are used to define Node identity in the resource model. It is possible to overload the hostname value to include port information (eg, hostname=&quot;somehost:2022&quot;). This is useful if your run SSH on a different port.</p
      ><p
      >Chances are you maintain information about your hosts within another tool, perhaps Chef, Puppet, Nagios, Amazon EC2, RightScale or even an in-house database. One of these tools might be considered the authority of knowledge about the nodes deployed in your network. Therefore, it is best to create an interface to the authoritative tool and expose it as RunDeck URL resource model source. This can be done as a simple CGI script that does a transformation from the tool's format to the one RunDeck understands.</p
      ><p
      >Of course, a rudimentary alternative is to maintain this information as an XML document, storing it in a source repository that is periodically exported to Rundeck. This method could be practical if your host infrastructure infrequently changes.</p
      ><p
      >Check the RunDeck web site for URL resource model sources. If you are interested in creating your own, see the <a href="#resource-model-source"
	>Resource model source</a
	> section in the <a href="#integration-with-external-data-providers"
	>Integration with External Data Providers</a
	> chapter.</p
      ></div
    ><div id="resource-model-document-formats"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.2.2</span
	  > Resource Model Document formats</a
	></h3
      ><p
      >RunDeck currently has two resource model document formats built in:</p
      ><ul
      ><li
	>XML: <a href="resource-v13.html"
	  >resource-v13(5) XML</a
	  >. Format name: <code
	  >resourcexml</code
	  >.</li
	><li
	>Yaml: <a href="resource-yaml-v13.html"
	  >resource-v13(5) YAML</a
	  >. Format name: <code
	  >resourceyaml</code
	  >.</li
	></ul
      ><p
      >You can enable more formats using <a href="#resource-format-plugins"
	>Resource Format Plugins</a
	>.</p
      ></div
    ></div
  ><div id="pluggable-resource-model-sources"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.3</span
	> Pluggable Resource Model Sources</a
      ></h2
    ><p
    >Each project can have multiple sources for Resource model information, and you can use or write plugins to enable new sources for entries in the Resource model.</p
    ><p
    >You can configure the sources via the GUI from the Admin page, see <a href="#gui-admin-page"
      >GUI Admin Page</a
      >, or by modifying the project configuration file, see <a href="#resource-model-sources"
      >Resource Model Sources</a
      >.</p
    ></div
  ><div id="command-execution"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.4</span
	> Command Execution</a
      ></h2
    ><p
    >RunDeck supports two modes of execution: <em
      >ad-hoc commands</em
      > and <em
      >Job</em
      >.</p
    ><p
    >An <em
      >ad-hoc command</em
      > is any system command or shell script executed via the command dispatcher. Ad hoc commands can be executed via a command line utility named <code
      >dispatch</code
      > or run from the graphical console.</p
    ><p
    >A <em
      >Job</em
      > specifies a sequence of one or more command invocations that can be run once (i.e, is temporary) or named and stored for later use. Stored jobs can be started via the shell tool, <code
      >run</code
      >, and their progress checked with <code
      >rd-queue</code
      >.</p
    ><div id="dispatcher-options"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.1</span
	  > Dispatcher options</a
	></h3
      ><p
      >Dispatcher execution can be controlled by various types of options.</p
      ><dl
      ><dt
	>Execution control</dt
	><dd
	><p
	  >Concurrency is controlled by setting the &quot;threadcount&quot;. Execution can continue even if some node fails if the &quot;keepgoing&quot; option is set to true.</p
	  ></dd
	><dt
	>Node Filters</dt
	><dd
	><p
	  >Filtering options specify include and exclude filters to determine which nodes from the project resource model to distribute commands to.</p
	  ></dd
	><dt
	>Filter Keywords</dt
	><dd
	><p
	  >Keywords are used within they include and exclude patterns. The &quot;tags&quot; keyword additionally can use a boolean operator to combine logical ORs and ANDs.</p
	  ></dd
	><dt
	>Filter combinations</dt
	><dd
	><p
	  >All keywords can be combined by specifying the include and exclude options multiple times on the command line.</p
	  ></dd
	></dl
      ><p
      >One can experiment querying the resource model in the graphical console or with the <code
	>dispatch</code
	> tool.</p
      ><div id="filtering-nodes-graphically"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.4.1.1</span
	    > Filtering nodes graphically</a
	  ></h4
	><p
	>A project's Node resources are displayed in the Run page. Use the project menu in the navigation bar to change to the desired project. After choosing a project, the server node will be filtered by default.</p
	><p
	>Nodes can be filtered using include and exclude patterns by using the Filter form. The form can be opened by pressing the &quot;Filter&quot; button. Press the triangular disclosure icon to display the form.</p
	><div class="figure"
	><img src="figures/fig0205.png" alt="Resource filter link"
	   /><p class="caption"
	  >Resource filter link</p
	  ></div
	><p
	>When the form opens, you will see it divided into an Include section where simple include expressions can be set, as well as, an &quot;Extended Filters...&quot; link where exclude expressions can be made.</p
	><div class="figure"
	><img src="figures/fig0206.png" alt="Resource filter form"
	   /><p class="caption"
	  >Resource filter form</p
	  ></div
	><p
	>After filling out the filter form, press &quot;Filter&quot; to generate a new listing. Pressing &quot;Clear&quot; resets the form.</p
	><p
	>The Include and Exclude filters allow for filtering nodes based on the following keywords: Name, Tags, Hostname, OS Name, OS Family, OS Architecture, OS Version and Type.</p
	><p
	>Regular expressions can be used for any of the keywords. The <code
	  >.*</code
	  > pattern will match any text.</p
	><p
	>If more than 20 nodes match the filter, the UI will page the results.</p
	></div
      ><div id="filtering-nodes-in-the-shell"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.4.1.2</span
	    > Filtering nodes in the shell</a
	  ></h4
	><p
	><code
	  >dispatch</code
	  > uses the commandline options -I (include) and -X (exclude) to specify which nodes to include and exclude from the base set of nodes. You can specify a single value, a list of values, or a regular expression as the argument to these options.</p
	><p
	><em
	  >Examples</em
	  ></p
	><p
	>List nodes with OS name, Linux:</p
	><pre
	><code
	  >dispatch -p examples -I os-name=Linux
</code
	  ></pre
	><p
	>List Linux nodes but exclude ones with names prefixed &quot;web.&quot;:</p
	><pre
	><code
	  >dispatch -p examples -I os-name=Linux -X &quot;web.*&quot;
</code
	  ></pre
	><p
	>List nodes that are tagged both &quot;web&quot; and &quot;prod&quot; :</p
	><pre
	><code
	  >dispatch -p examples -I tags=web+prod
</code
	  ></pre
	><p
	>Here's an example that will execute the <code
	  >apachectl restart</code
	  > command in 10 threads across all nodes tagged &quot;web&quot; and keepgoing in case an error occurs :</p
	><pre
	><code
	  >dispatch -p examples -I tags=web -K -C 10 -- sudo apachectl restart 
</code
	  ></pre
	><p
	>Consult the <a href="rd-options.html"
	  >rd-options(1)</a
	  > manual page for the complete reference on available dispatcher options.</p
	></div
      ></div
    ><div id="ad-hoc-commands"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.2</span
	  > Ad-hoc commands</a
	></h3
      ><p
      >Typically, an ad-hoc command is a shell script or system executable that you run at an interactive terminal. Ad-hoc commands can be executed via the <code
	>dispatch</code
	> shell command or a graphical shell.</p
      ><div id="shell-tool-command-execution"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.4.2.1</span
	    > Shell tool command execution</a
	  ></h4
	><p
	>Use <code
	  >dispatch</code
	  > to execute individual commands or shell script files.</p
	><p
	>Here <code
	  >dispatch</code
	  > is used to run the Unix <code
	  >uptime</code
	  > command to print system status:</p
	><pre
	><code
	  >$ dispatch -I os-family=unix -- uptime
Succeeded queueing Workflow execution: Workflow:(threadcount:1){ [command( exec: uptime)] }
Queued job ID: 7 &lt;http://strongbad:4440/execution/follow/7&gt;
</code
	  ></pre
	><p
	>The <code
	  >uptime</code
	  > command is queued and executed. The output can be followed by going to the URL returned in the output (eg, http://strongbad:4440/execution/follow/7).</p
	><p
	>Sometimes it is desirable to execute the command directly, and not queue it <sup
	  ><a href="#fn1" class="footnoteRef" id="fnref1"
	    >1</a
	    ></sup
	  >. Use the <code
	  >--noqueue</code
	  > option to execute and follow the output from the console.</p
	><pre
	><code
	  >$ dispatch -I os-family=unix  --noqueue -- uptime
[ctier@centos54 dispatch][INFO]  10:34:54 up 46 min,  2 users,  load average: 0.00, 0.00, 0.00
[alexh@strongbad dispatch][INFO] 10:34  up 2 days, 18:51, 2 users, load averages: 0.55 0.80 0.75
[examples@ubuntu dispatch][INFO]  10:35:01 up 2 days, 18:40,  2 users,  load average: 0.00, 0.01, 0.00
</code
	  ></pre
	><p
	>Notice, the <code
	  >dispatch</code
	  > command prepends the message output with a header that helps understand from where the output originates. The header format includes the login and node where the <code
	  >dispatch</code
	  > execution occurred.</p
	><p
	>Execute the Unix <code
	  >whomi</code
	  > command to see what user ID is used by that Node to run dispatched commands:</p
	><pre
	><code
	  >$ dispatch -I os-family=unix --noqueue -- whoami
[ctier@centos54 dispatch][INFO] ctier
[alexh@strongbad dispatch][INFO] alexh
[examples@ubuntu dispatch][INFO] examples
</code
	  ></pre
	><p
	>You can see that the resource model defines each Node to use a different login to execute <code
	  >dispatch</code
	  > commands. That feature can be handy when Nodes serve different roles and therefore, use different logins to manage processes. See the <code
	  >username</code
	  > attribute in <a href="resource-v13.html"
	  >resource-v13(5) XML</a
	  > or <a href="resource-yaml-v13.html"
	  >resource-v13(5) YAML</a
	  > manual page.</p
	><p
	>The <code
	  >dispatch</code
	  > command can also execute shell scripts. Here's a trivial script that generates a bit of system info:</p
	><pre
	><code
	  >#!/bin/sh
echo &quot;info script&quot;
echo uptime=`uptime`
echo whoami=`whoami`
echo uname=`uname -a`
</code
	  ></pre
	><p
	>Use the -s option to specify the &quot;info.sh&quot; script file:</p
	><pre
	><code
	  >$ dispatch -I os-family=unix -s info.sh
</code
	  ></pre
	><p
	>The <code
	  >dispatch</code
	  > command copies the &quot;info.sh&quot; script located on the server to each &quot;unix&quot; Node and then executes it.</p
	></div
      ><div id="graphical-command-shell-execution"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.4.2.2</span
	    > Graphical command shell execution</a
	  ></h4
	><p
	>The RunDeck graphical console also provides the ability to execute ad-hoc commands to a set of filtered Node resources. The command prompt can accept any ad-hoc command string you might run via an SSH command or via the <code
	  >dispatch</code
	  > shell tool.</p
	><p
	>But before running any commands, you need to select the project containing the Nodes you wish to dispatch. Use the project menu to select the desired project name. After the project has been selected you will see a long horizontal textfield labeled &quot;Command&quot;. This is the RunDeck ad hoc command prompt.</p
	><div class="figure"
	><img src="figures/fig0207.png" alt="Ad hoc command prompt"
	   /><p class="caption"
	  >Ad hoc command prompt</p
	  ></div
	><p
	>To use the command prompt, type the desired ad-hoc command string into the textfield and press the &quot;Run&quot; button. The command will be dispatched to all the Node resources currently listed below the command prompt tool bar. The command prompt also becomes disabled until the execution completes. Output from the command execution will be shown below (see <a href="#following-execution-output"
	  >output</a
	  >).</p
	><div class="figure"
	><img src="figures/fig0208.png" alt="Ad hoc execution output"
	   /><p class="caption"
	  >Ad hoc execution output</p
	  ></div
	><p
	>You will also notice the ad hoc execution listed in the &quot;Now running&quot; part of the page, located above the command prompt. All running executions are listed there. Each running execution is listed, showing the start time, the user running it, and a link to follow execution output on a separate page.</p
	><div class="figure"
	><img src="figures/fig0207-b.png" alt="Now running ad hoc command"
	   /><p class="caption"
	  >Now running ad hoc command</p
	  ></div
	><p
	>At the bottom of the page, you will see a &quot;History&quot; section containing all executions in the selected project for the last 24 hours. After the execution completes, a new event will be added to the history. A yellow highlight indicates when the command leaves the Now running section and enters the history table.</p
	><div class="figure"
	><img src="figures/fig0207-c.png" alt="Run history"
	   /><p class="caption"
	  >Run history</p
	  ></div
	><p
	>History is organized in summary form using a table layout. The &quot;Summary&quot; column shows the command or script executed. The &quot;Node Failure Count&quot; contains the number of nodes where an error in execution occurred. If no errors occurred, &quot;ok&quot; will be displayed. The &quot;User&quot; and &quot;Time&quot; columns show the user that executed the command and when.</p
	><div id="following-execution-output"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >3.4.2.2.1</span
	      > Following execution output</a
	    ></h5
	  ><p
	  >Ad hoc command execution output is displayed below the command prompt.</p
	  ><p
	  >This page section provides several views to read the output using different formats.</p
	  ><dl
	  ><dt
	    >Tail Output</dt
	    ><dd
	    ><p
	      >Displays output messages from the command execution as if you were running the Unix <code
		>tail -f</code
		> command on the output log file. By default, only the last 20 lines of output is displayed but this can be expanded or reduced by pressing the &quot;-&quot; or &quot;+&quot; buttons. You can also type in an exact number into the textfield. <img src="figures/fig0208.png" alt="Ad hoc execution output"
		 /></p
	      ></dd
	    ><dt
	    >Annotated</dt
	    ><dd
	    ><p
	      >The annotated mode displays the output messages in the order they are received but labels the each line with the Node from which the message originated. Through its additional controls each Node context can be expanded to show the output it produced, or completely collapsed to hide the textual detail.<br
		 /><img src="figures/fig0209.png" alt="Annotated output"
		 /></p
	      ></dd
	    ><dt
	    >Compact</dt
	    ><dd
	    ><p
	      >Output messages are sorted into Node specific sections and are not interlaced. By default, the messages are collapsed but can be revealed by pressing the disclosure icon to the right. <img src="figures/fig0210.png" alt="Node output"
		 /></p
	      ></dd
	    ></dl
	  ><div id="separate-execution-follow-page"
	  ><h6
	    ><a href="#TOC"
	      ><span class="header-section-number"
		>3.4.2.2.1.1</span
		> Separate execution follow page</a
	      ></h6
	    ><p
	    >Sometimes it is useful to have a page where just the execution output is displayed separately. One purpose is to share a link to others interested in following the output messages. Click the &quot;output &gt;&gt;&quot; link in the &quot;Now running&quot; section to go to the execution follow page.</p
	    ><p
	    >Also, notice the URL in the location bar of your browser. This URL can be shared to others interested in the progress of execution. The URL contains the execution ID (EID) and has a form like:</p
	    ><pre
	    ><code
	      > http://rundeckserver/execution/follow/{EID}
</code
	      ></pre
	    ><p
	    >After execution completes, the command will have a status:</p
	    ><ul
	    ><li
	      >Successful: No errors occurred during execution of the command across the filtered Node set</li
	      ><li
	      >Failed: One or more errors occurred. A list of Nodes that incurred an error is displayed. The page will also contain a link &quot;Retry Failed Nodes...&quot; in case you would like to retry the command.</li
	      ></ul
	    ><p
	    >You can download the entire output as a text file from this page. Press the &quot;Download&quot; link to retrieve the file to your desk top.</p
	    ></div
	  ></div
	></div
      ></div
    ><div id="controlling-command-execution"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.3</span
	  > Controlling command execution</a
	></h3
      ><p
      >Parallel execution is managed using thread count via &quot;-C&quot; option. The &quot;-C&quot; option specifies the number of execution threads. Here's an example that runs the uptime command across the Linux hosts with two threads:</p
      ><pre
      ><code
	>dispatch -I os-name=Linux -C 2 -- uptime
</code
	></pre
      ><p
      >The keepgoing and retry flags control when to exit incase an error occurs. Use &quot;-K/-R&quot; flags. Here's an example script that checks if the host has port 4440 in the listening state. If it does not, it will exit with code 1.</p
      ><pre
      ><code
	>#!/bin/sh
netstat -an | grep 4440 | grep -q LISTEN
if [ &quot;$?&quot; != 0 ]; then
echo &quot;not listening on 4440&quot;
exit 1;
fi
echo  listening port=4440, host=`hostname`;
</code
	></pre
      ><p
      >Commands or scripts that exit with a non-zero exit code will cause the dispatch to fail unless the keepgoing flag is set.</p
      ><pre
      ><code
	>$ dispatch -I os-family=unix -s /tmp/listening.sh --noqueue
[alexh@strongbad dispatch][INFO] Connecting to centos54:22
[alexh@strongbad dispatch][INFO] done.
[ctier@centos54 dispatch][INFO] not listening on 4440
error: Remote command failed with exit status 1
</code
	></pre
      ><p
      >The script failed on centos54 and caused dispatch to error out immediately.</p
      ><p
      >Running the command again, but this time with the &quot;-K&quot; keepgoing flag will cause dispatch to continue and print on which nodes the script failed:</p
      ><pre
      ><code
	>$ dispatch  --noqueue -K -I tags=web -s /tmp/listening.sh
[alexh@strongbad dispatch][INFO] Connecting to centos54:22
[alexh@strongbad dispatch][INFO] done.
[ctier@centos54 dispatch][INFO] not listening on 4440
[ctier@centos54 dispatch][ERROR] Failed execution for node: centos54: Remote command failed with exit status 1
[alexh@strongbad dispatch][INFO] listening port=4440, host=strongbad
[alexh@strongbad dispatch][INFO] Connecting to 172.16.167.211:22
[alexh@strongbad dispatch][INFO] done.
[examples@ubuntu dispatch][INFO] not listening on 4440
[examples@ubuntu dispatch][ERROR] Failed execution for node: ubuntu: Remote command failed with exit status 1
error: Execution failed on the following 2 nodes: [centos54, ubuntu]
error: Execute this command to retry on the failed nodes:
    dispatch -K -s /tmp/listening.sh -p examples -I
    name=centos54,ubuntu
</code
	></pre
      ></div
    ><div id="queuing-commands-to-rundeck"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.4</span
	  > Queuing commands to RunDeck</a
	></h3
      ><p
      >By default, commands or scripts executed on the command line by <code
	>dispatch</code
	> are queued as temporary jobs in RunDeck. The <code
	>dispatch</code
	> command is equivalent to a &quot;Run and Forget&quot; action in the graphical console.</p
      ><p
      >The script below is a long running check that will conduct a check periodically waiting a set time between each pass. The script can be run with or without arguments as the parameters are defaulted inside the script:</p
      ><pre
      ><code
	>$ cat ~/bin/checkagain.sh 
#!/bin/bash
iterations=$1 secs=$2 port=$3
echo &quot;port ${port:=4440} will be checked ${iterations:=30} times waiting ${secs:=5}s between each iteration&quot; 
i=0
while [ $i -lt ${iterations} ]; do
  echo &quot;iteration: #${i}&quot;
  netstat -an | grep $port | grep LISTEN &amp;&amp; exit 0
  echo ----
  sleep ${secs}
  i=$(($i+1))
done
echo &quot;Not listening on $port after $i checks&quot; ; exit 1
</code
	></pre
      ><p
      >Running <code
	>dispatch</code
	> causes the execution to queue in RunDeck and controlled as temporary Job. The <code
	>-I centos54</code
	> limits execution to just the &quot;centos54&quot; node:</p
      ><pre
      ><code
	>$ dispatch -I centos54 -s ~/bin/checkagain.sh 
Succeeded queueing workflow: Workflow:(threadcount:1){ [command( scriptfile: /Users/alexh/bin/checkagain.sh)] }
Queued job ID: 5 &lt;http://strongbad:4440/execution/follow/4&gt;
</code
	></pre
      ><p
      >To pass arguments to the script pass them after the &quot;--&quot; (double dash):</p
      ><pre
      ><code
	>$ iters=5 secs=60 port=4440
$ dispatch -I centos54 -s ~/bin/checkagain.sh -- $iters $secs $ports
</code
	></pre
      ></div
    ><div id="tracking-execution"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.5</span
	  > Tracking execution</a
	></h3
      ><p
      >Queued ad-hoc command and temporary or saved Job executions can be tracked from the &quot;Run&quot; page in the &quot;<a href="#now-running"
	>Now Running</a
	>&quot; area at the top of the page.</p
      ><p
      >Execution can also be tracked using the <a href="rd-queue.html"
	>rd-queue</a
	> shell tool.</p
      ><pre
      ><code
	>$ rd-queue -p project
Queue: 1 items
[5] workflow: Workflow:(threadcount:1){[command( scriptfile: /Users/alexh/bin/checkagain.sh)]} &lt;http://strongbad:4440/execution/follow/5&gt;
</code
	></pre
      ><p
      >Each job in the execution queue has an execution ID. The example above shows one item with the ID, 5.</p
      ><p
      >Running jobs can also be killed via <code
	>rd-queue kill</code
	>. Specify execution ID using the &quot;-e&quot; option:</p
      ><pre
      ><code
	>$ rd-queue kill -e 5
rd-queue kill: success. [5] Job status: killed
</code
	></pre
      ></div
    ><div id="plugins"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.6</span
	  > Plugins</a
	></h3
      ><p
      >RunDeck supports a plugin model for the execution service, which allows you to fully customize the way that a particular Node, Project or your entire RunDeck installation executes commands and scripts remotely (or locally).</p
      ><p
      >By default RunDeck uses an internal plugin to perform execution via SSH for remote nodes, and local execution on the RunDeck server itself.</p
      ><p
      >Plugins can be installed by copying them to the <code
	>libext</code
	> directory of your RunDeck installation.</p
      ><p
      >Plugins are used to add new &quot;providers&quot; for particular &quot;services&quot;. The services used for command execution on nodes are the &quot;node-executor&quot; and &quot;file-copier&quot; services.</p
      ><p
      >To use a particular plugin, it must be set as the provider for a service by configuring the <code
	>framework.properties</code
	> file, the <code
	>project.properties</code
	> file, or by adding attributes to Nodes in your project's resources definitions. For more about configuring the providers, see <a href="#using-providers"
	>Using Providers</a
	>.</p
      ><p
      >The internal SSH command execution plugin is described below, and more information about plugins can be found in the <a href="#rundeck-plugins"
	>RunDeck Plugins</a
	> chapter.</p
      ><div id="ssh-plugin"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.4.6.1</span
	    > SSH Plugin</a
	  ></h4
	><p
	>RunDeck by default uses SSH to execute commands on remote nodes, SCP to copy scripts to remote nodes, and locally executes commands and scripts for the local (server) node.</p
	><p
	>The SSH plugin expects each node definition to have the following properties in order to create the SSH connection:</p
	><ul
	><li
	  ><code
	    >hostname</code
	    >: the hostname of the remote node. It can be in the format &quot;hostname:port&quot; to indicate that a non-default port should be used. The default port is 22.</li
	  ><li
	  ><code
	    >username</code
	    >: the username to connect to the remote node.</li
	  ></ul
	><p
	>When a Script is executed on a remote node, it is copied over via SCP first, and then executed. In addition to the SSH connection properties above, these node attributes can be configured for SCP:</p
	><ul
	><li
	  ><code
	    >file-copy-destination-dir</code
	    >: The directory on the remote node to copy the script file to before executing it. The default value is <code
	    >C:/WINDOWS/TEMP/</code
	    > on Windows nodes, and <code
	    >/tmp</code
	    > for other nodes.</li
	  ><li
	  ><code
	    >osFamily</code
	    >: specify &quot;windows&quot; for windows nodes.</li
	  ></ul
	><p
	>In addition, for both SSH and SCP, you must either configure a public/private keypair for the remote node or configure the node for SSH Password authentication.</p
	><ul
	><li
	  >See <a href="#ssh"
	    >Administration - SSH</a
	    > for more information on setting up your SSH server</li
	  ><li
	  >See <a href="#ssh-provider"
	    >SSH Provider</a
	    > for more information on the configuration of Nodes for SSH</li
	  ></ul
	></div
      ><div id="included-plugins"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.4.6.2</span
	    > Included Plugins</a
	  ></h4
	><p
	>Two plugin files are included with the default RunDeck installation for your use in testing or development. (See <a href="#pre-installed-plugins"
	  >Pre-Installed Plugins</a
	  >)</p
	><ul
	><li
	  ><a href="#stub-plugin"
	    >Stub plugin</a
	    >: simply prints the command or script instead of running it.</li
	  ><li
	  ><a href="#script-plugin"
	    >Script plugin</a
	    >: executes an external script file to perform the command, useful for developing your own plugin with the <a href="#script-plugin-development"
	    >Script Plugin Development</a
	    > model.</li
	  ></ul
	></div
      ></div
    ></div
  ><div id="history"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.5</span
	> History</a
      ></h2
    ><p
    >History for queued ad-hoc commands, as well as, temporary and saved Job executions is stored by the RunDeck server. History data can be filtered and viewed inside the &quot;History&quot; page.</p
    ><div class="figure"
    ><img src="figures/fig0211.png" alt="History page"
       /><p class="caption"
      >History page</p
      ></div
    ><div id="filtering-event-history"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.5.1</span
	  > Filtering event history</a
	></h3
      ><p
      >By default, the History page will list history for the last day's executions. The page contains a filter control that can be used to expand or limit the executions.</p
      ><p
      >The filter form contains a number of fields to limit search:</p
      ><ul
      ><li
	>Within: Time range. Choices include 1 day, 1 week, 1 month or other (given a start after/before to ended after/before).</li
	><li
	>Name: Job title name.</li
	><li
	>Project: Project name. This may be set if the project menu was used.</li
	><li
	>User: User initiating action.</li
	><li
	>Summary: Message text.</li
	><li
	>Result: Success or failure status.</li
	></ul
      ><div class="figure"
      ><img src="figures/fig0212.png" alt="History filter form"
	 /><p class="caption"
	>History filter form</p
	></div
      ><p
      >After filling the form pressing the &quot;Filter&quot; button, the page will display events matching the search.</p
      ><p
      >Filters can be saved to a menu that makes repeating searches more convenient. Click the &quot;save this filter...&quot; link to save the filter configuration.</p
      ></div
    ><div id="event-view"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.5.2</span
	  > Event view</a
	></h3
      ><p
      >History for each execution contains the command(s) executed, dispatcher options, success status and a link to a file containing all the output messages.</p
      ><div class="figure"
      ><img src="figures/fig0213.png" alt="Event view"
	 /><p class="caption"
	>Event view</p
	></div
      ><p
      >If any errors occurred, the &quot;Node Failure Count&quot; column will show the number of nodes in red text. A bar chart indicates the percent failed.</p
      ><div class="figure"
      ><img src="figures/fig0216.png" alt="Event view"
	 /><p class="caption"
	>Event view</p
	></div
      ></div
    ><div id="rss-link"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.5.3</span
	  > RSS link</a
	></h3
      ><p
      >An RSS icon provides a link to an RSS view of the events that match the current filtering criteria.</p
      ><div class="figure"
      ><img src="figures/fig0214.png" alt="RSS link"
	 /><p class="caption"
	>RSS link</p
	></div
      ></div
    ></div
  ><div id="tips-and-tricks"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.6</span
	> Tips and Tricks</a
      ></h2
    ><div id="saving-filters"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.6.1</span
	  > Saving filters</a
	></h3
      ><p
      >Each of the filter controls provides the means to save the current filter configuration. Press the &quot;save this filter...&quot; link to give it a name. Each saved filter is added to a menu you can access the next time you want that filter configuration.</p
      ></div
    ><div id="auto-completion"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.6.2</span
	  > Auto-Completion</a
	></h3
      ><p
      >If you use the Bash shell, RunDeck comes with a nice auto-completion script you can enable. Add this to your <code
	>.bashrc</code
	> file:</p
      ><pre
      ><code
	>source $RDECK_BASE/etc/bash_completion.bash
</code
	></pre
      ><p
      >Press the Tab key when you're writing a dispatch command, and it should return a set of suggestions for you to pick from:</p
      ><pre
      ><code
	>$ dispatch &lt;tab&gt;&lt;tab&gt;
</code
	></pre
      ></div
    ></div
  ><div id="summary-1"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.7</span
	> Summary</a
      ></h2
    ><p
    >At this point, you can do basic RunDeck operations - setup a project, define and query the project resource model, execute ad-hoc commands, run and save Jobs and view history.</p
    ><p
    >Next, we'll cover one of RunDeck's core features: Jobs.</p
    ></div
  ></div
><div id="jobs"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >4</span
      > Jobs</a
    ></h1
  ><p
  >In previous sections of this manual, you learned how to execute ad-hoc commands across a filtered set of Node resources. This chapter introduces a fundamental RunDeck feature, <em
    >Jobs</em
    >. But first, one might ask why introduce another layer over ad-hoc command execution.</p
  ><p
  >Here are some issues that might arise over time:</p
  ><ul
  ><li
    >One might find certain ad-hoc command executions are repeated, and perhaps, represent what has become a routine procedure.</li
    ><li
    >Another user in your group needs a simple self-service interface to run a procedure across a set of nodes.</li
    ><li
    >Routine procedures need to be encapsulated and become the basis for other routine procedures.</li
    ></ul
  ><p
  >Jobs provide a means to encapsulate a procedure in a logically named Job. A <em
    >Job</em
    > is a configuration representing the steps in a procedure, a Node filter specification, and dispatcher execution control parameters. Jobs access is governed by an access control policy that describes how users are granted authorization to use Jobs.</p
  ><p
  >RunDeck lets you organize and execute Jobs, and observe the output as the Job is running. You can view a list of the currently running Jobs that is dynamically updated as the Jobs progress. Jobs can also be killed if they need to be stopped.</p
  ><p
  >Each Job has a record of every time it has been executed, and the output from those executions can be viewed.</p
  ><p
  >The next sections describes how to navigate and run existing Jobs. In later sections, the topic of Job creation will be covered.</p
  ><p
  >If you want to skip ahead, you can go straight to <a href="#creating-jobs"
    >Creating Jobs</a
    >.</p
  ><div id="job-groups"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.1</span
	> Job groups</a
      ></h2
    ><p
    >As many jobs will accumulate over time, it is useful to organize Jobs into groups. A group is a logical set of jobs, and one job group can exist inside another. RunDeck displays job lists as a set of folders corresponding to the group structure your jobs define.</p
    ><p
    >Beyond organizing jobs, groups assist in defining access control policy, as we'll cover later in the Authorization chapter.</p
    ></div
  ><div id="job-uuids"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.2</span
	> Job UUIDs</a
      ></h2
    ><p
    >When created, each new job will be assigned a unique UUID. If you are writing the Job definition using one of the supported formats you can assign the UUID yourself.</p
    ><p
    >You can use the UUID to make sure that when you rename or change the group for your job in your job definition, it will modify the correct job in the server.</p
    ><p
    >The UUID is also useful when porting Job definitions between RunDeck instances.</p
    ><p
    >(Note: RunDeck also assigns each Job an internal &quot;ID&quot; value, although this value is not portable between RunDeck instances. As of RunDeck 1.3+ the UUID should be used in lieu of ID.)</p
    ></div
  ><div id="listing-and-filtering-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.3</span
	> Listing and filtering Jobs</a
      ></h2
    ><p
    >All Job activity begins on the main &quot;Jobs&quot; page inside RunDeck. After logging in, press the &quot;Jobs&quot; button in the top navigation bar and any Jobs you are authorized to see will be displayed.</p
    ><p
    >If the Jobs were defined inside groups, you will see the listing grouped into a folder like structure. These folders represent the Job groups described earlier. You can navigate these folders by pressing the folder icon to reveal its contents.</p
    ><p
    >Once you have navigated to a Job, you will see its name, possibly its description and a summary total of how many times it has been executed.</p
    ><p
    >Clicking on the job name will will expand the window to show the Job detail. You will see a button bar containing icons representing the actions you are able to perform. Other Job detail will include what command(s) it will run, filter expressions and other dispatcher options.</p
    ><div id="filtering-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.3.1</span
	  > Filtering Jobs</a
	></h3
      ><p
      >The Job page lets you search for Jobs using the Filter option.</p
      ><p
      >Click the &quot;Filter&quot; link to show the filter options:</p
      ><div class="figure"
      ><img src="figures/fig0317.png" alt="Job filter form"
	 /><p class="caption"
	>Job filter form</p
	></div
      ><p
      >This will show the Filter fields. Enter a value in any of the filter fields:</p
      ><ul
      ><li
	>Job Name: the name of the job</li
	><li
	>Group: the name of the job group</li
	><li
	>Description: Job description text</li
	></ul
      ><p
      >You can type a substring or a regular expression in any of these fields.</p
      ><p
      >After pressing the &quot;Filter&quot; button, the Job list will be filtered to include only the matching jobs.</p
      ><div class="figure"
      ><img src="figures/fig0318.png" alt="Job filtered list"
	 /><p class="caption"
	>Job filtered list</p
	></div
      ><p
      >To refine the filter, click on the blue-outlined Filter description, and change the filter fields.</p
      ><p
      >To reset the filter and go back to the full job page, click the &quot;Clear&quot; button in the Filter fields.</p
      ></div
    ></div
  ><div id="viewing-job-detail"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.4</span
	> Viewing Job detail</a
      ></h2
    ><p
    >From a filtered job listing, a Job's detail can be previewed by hovering the mouse pointer over the Job's name. A popup view contains the Job's detail. Click outside the popup to close it.</p
    ><div class="figure"
    ><img src="figures/fig0320.png" alt="Job detail popup"
       /><p class="caption"
      >Job detail popup</p
      ></div
    ><p
    >Pressing the link for the Job name will navigate to a separate page where job detail and a button control bar is displayed. These buttons enable users to delete, copy, edit export or run the Job.</p
    ><div class="figure"
    ><img src="figures/fig0321.png" alt="Job detail page"
       /><p class="caption"
      >Job detail page</p
      ></div
    ><p
    >The buttons displayed on the control bar reflect the <a href="#authorization-1"
      >authorization policy</a
      > enforced for the user.</p
    ><p
    >The information in the Job detail view includes:</p
    ><ul
    ><li
      >Name, description and group</li
      ><li
      >Execution statistics like when the job was last run, it's average success rate, and duration</li
      ><li
      >Details including project name and workflow steps, and log level</li
      ></ul
    ><p
    >Pressing the &quot;Show Matches&quot; link will display the list of Nodes where the Job will run.</p
    ></div
  ><div id="running-a-job"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.5</span
	> Running a Job</a
      ></h2
    ><p
    >Jobs can be run from the shell or from the graphical console.</p
    ><p
    >From the command line, use the <a href="run.html"
      >run</a
      > shell tool. Here's an example that starts a hypothetical job named &quot;restart&quot; belonging in the &quot;apps/web&quot; Job group in project &quot;myproject&quot;:</p
    ><pre
    ><code
      >$ run -j apps/web/restart -p myproject
Job execution started:
[51] restart &lt;http://strongbad:4440/execution/follow/51&gt;
</code
      ></pre
    ><p
    >From the graphical console, any stored job can be started from the Jobs page. Navigate to the desired Job from the filtered listing and then press the green &quot;Run&quot; icon to immediately queue and run the Job. If you do not see the Run icon, it means your login does not have &quot;run&quot; privileges.</p
    ><div class="figure"
    ><img src="figures/fig0319.png" alt="Job run button"
       /><p class="caption"
      >Job run button</p
      ></div
    ><p
    >If you navigated to the Job's detail page, you press the &quot;Run&quot; button from there.</p
    ><div class="figure"
    ><img src="figures/fig0319-b.png" alt="Job run button"
       /><p class="caption"
      >Job run button</p
      ></div
    ><p
    >After the Run button has been pressed, a dialog will open where you can choose execution options.</p
    ><div id="choose-execution-options"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.5.1</span
	  > Choose execution options</a
	></h3
      ><p
      >Jobs can be defined to prompt the user for options. This page contains a form presenting any of these Job options.</p
      ><p
      >Some options will have default values while others may present you with a menu of choices. Some options are optional while others are required. Lastly, their might be a pattern governing what values are acceptable.</p
      ><p
      >If there are any such Job options, you can change them here before proceeding with the execution.</p
      ><p
      >When you are ready, press &quot;Run Job Now&quot;. The job will enter the execution queue and you can track its execution in the <a href="#now-running"
	>Now running</a
	> section.</p
      ></div
    ><div id="following-running-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.5.2</span
	  > Following Running Jobs</a
	></h3
      ><p
      >Once you have started running a Job, you can follow the Job's output in the Execution Follow page.</p
      ><p
      >On the Jobs page, look in the &quot;Now running&quot; section and click the &quot;output &gt;&gt;&quot; link in the row with the desired Job name.</p
      ><p
      >If you pressed the &quot;run&quot; button from the Job's detail page, your browser will already have been directed to the Execution Follow page.</p
      ></div
    ></div
  ><div id="creating-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.6</span
	> Creating Jobs</a
      ></h2
    ><p
    >RunDeck allows you to define two kinds of Jobs.</p
    ><ul
    ><li
      >Temporary: A <em
	>temporary Job</em
	> defines a set of commands to execute and a node filter configuration.</li
      ><li
      >Saved: A <em
	>saved job</em
	> also defines a set of commands to execute and dispatcher options but can be given a name and stored in a group. Additionally, saved Jobs can be given an execution schedule.</li
      ></ul
    ><p
    >From the Jobs, page press the &quot;New Job&quot; button to begin creating a Job.</p
    ><div class="figure"
    ><img src="figures/fig0301.png" alt="New Job button"
       /><p class="caption"
      >New Job button</p
      ></div
    ><div id="temporary-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.6.1</span
	  > Temporary Jobs</a
	></h3
      ><p
      >A temporary job is a bit like an ad-hoc command except you get more control over how the commands will execute plus the execution can be better tracked within the RunDeck webapp.</p
      ><p
      >To create a temporary job, begin by logging in to the RunDeck graphical console, and press the &quot;Jobs&quot; tab.</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Locate the &quot;New Job&quot; button in the right hand corner and press it to display the &quot;Create New Job&quot; form.</li
	><li
	>A job is defined in terms of one or more workflow steps. In the Workflows area, click the &quot;Add a step&quot; link.</li
	><li
	>Workflow steps can be one of several types. Click the &quot;Script&quot; workflow step type.</li
	><li
	>A script type can be any script that can be executed on the target hosts. Type in the &quot;info&quot; shell script we executed earlier using dispatch.</li
	><li
	>At the bottom of the form, push the &quot;Run and Forget&quot; button to begin execution.</li
	><li
	>Execution output can be followed on the subsequent page.</li
	></ol
      ><div class="figure"
      ><img src="figures/fig0302.png" alt="Temporary job form"
	 /><p class="caption"
	>Temporary job form</p
	></div
      ></div
    ><div id="saved-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.6.2</span
	  > Saved Jobs</a
	></h3
      ><p
      >Running ad hoc commands and temporary jobs are a typical part of day to day administrative work. Occasionally, ad-hoc commands become routine procedures and if were reusable, would become more valuable. These jobs could be handed off to others in the team or invoked from within other Jobs. RunDeck provides an interface to declare and save jobs, both graphically or declared with an XML file.</p
      ></div
    ><div id="simple-saved-job"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.6.3</span
	  > Simple saved job</a
	></h3
      ><p
      >For the first saved Job example, create a Job that calls the info script.</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Like in the earlier example, begin by pressing the &quot;New Job&quot; button.</li
	><li
	>Within the new job form:<ul
	  ><li
	    >Select &quot;Yes&quot; for the &quot;Save this job?&quot; prompt. Pressing Yes reveals a form to define a name, group and description for the job.</li
	    ><li
	    >For &quot;Job Name&quot;, enter &quot;info&quot; and for the &quot;Group&quot;, enter &quot;adm/resources&quot;.</li
	    ><li
	    >If you want to specify your own UUID you can enter it in the field. Otherwise a unique value will be set for you.</li
	    ><li
	    >Providing a description will be come helpful to other users to understand the intent and purpose for the Job.</li
	    ><li
	    >Check the box for &quot;Dispatch to Nodes&quot;</li
	    ><li
	    >Choose the &quot;Node Exclude Filters&quot; and enter the name of your RunDeck server. This will cause the job to run on just the remote Nodes (eg., centos54 and ubuntu).</li
	    ><li
	    >Type in and info script</li
	    ><li
	    >Save the Workflow step</li
	    ><li
	    >Press the &quot;Create&quot; button at the bottom of the page. <img src="figures/fig0303.png" alt="Simple saved job form"
	       /></li
	    ></ul
	  ></li
	><li
	>After the the job is created, the browser is directed to the Jobs page. The folder structure reflecting the group naming will show one Job.<ul
	  ><li
	    >Navigate through the folders buttons to the new job</li
	    ></ul
	  ></li
	><li
	>Notice the green arrow button.<ul
	  ><li
	    >Press the button to run the Job. <img src="figures/fig0304.png" alt="Simple saved job"
	       /></li
	    ></ul
	  ></li
	><li
	>Press the &quot;Run Job Now&quot; button to begin execution.<ul
	  ><li
	    >The job will be queued and executed.</li
	    ></ul
	  ></li
	><li
	>Look in the &quot;Now running&quot; section.<ul
	  ><li
	    >Press the &quot;output &gt;&gt;&quot; link to go to the execution follow page. <img src="figures/fig0305.png" alt="Simple saved job output"
	       /></li
	    ></ul
	  ></li
	></ol
      ></div
    ><div id="node-dispatching-and-filtering"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.6.4</span
	  > Node dispatching and filtering</a
	></h3
      ><p
      >When you create a job you can choose between either running the job only locally (on the RunDeck server), or dispatching it to multiple nodes (including the RunDeck server if you want).</p
      ><p
      >In the GUI, the &quot;Dispatch to Nodes&quot; checkbox lets you enable node dispatching. When you click this box you are presented with the Node Filtering interface:</p
      ><div class="figure"
      ><img src="figures/fig0305-b.png" alt="Node Filtering interface"
	 /><p class="caption"
	>Node Filtering interface</p
	></div
      ><p
      >You can click the different filter fields &quot;Name&quot;, and &quot;Tags&quot; to enter filter values for those fields. As you update the values you will see the &quot;Matched Nodes&quot; section updated to reflect the list of nodes that will match the inputs. You can click &quot;More&quot; to see more of the available inclusion filters, and you can click &quot;Extended Filters&quot; to enter exclusion filters for the same fields.</p
      ><p
      >You can set the maximum number of simultaneous threads to use by changing the &quot;Thread Count&quot; box. A value of 1 means all node dispatches happen sequentially, and any greater value means that the node dispatches will happen in parallel.</p
      ><p
      >If you set &quot;Keep going on error?&quot; to &quot;Yes&quot;, then if any node dispatches fail for any reason, the rest will continue to be executed until all have been executed. At the end of the workflow for all nodes, the Job Execution will fail if any of the nodes had failed.</p
      ><p
      >If you leave it at the default value of &quot;No&quot;, then if any node dispatches fail for any reason, no further dispatches will be executed and the Job Execution will fail immediately.</p
      ><div id="dynamic-node-filters"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >4.6.4.1</span
	    > Dynamic node filters</a
	  ></h4
	><p
	>In addition to entering static values that match the nodes, you can also use more dynamic values.</p
	><p
	>If you have defined Options for the Job (see <a href="#job-options"
	  >Job Options</a
	  >), you can use the values submitted by the user when the job is executed as part of the node filtering.</p
	><p
	>Simply set the filter value to <code
	  >${option.name}</code
	  >, where &quot;name&quot; is the name of the option.</p
	><p
	>When the job is executed, the user will be prompted to enter the value of the option, and that will then be used in the node filter to determine the nodes to dispatch to.</p
	><p
	><strong
	  >Note</strong
	  >: Since the dynamic option value is not set yet, the &quot;Matched Nodes&quot; shown in the node filtering input may indicate that there are &quot;None&quot; matched. Also, when the Job is executed, you may see a message saying &quot;Warning: The Node filters specified for this Job do not match any nodes, execution may fail.&quot; The nodes matched will be determined after the user enters the option values.</p
	></div
      ></div
    ></div
  ><div id="scheduled-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.7</span
	> Scheduled Jobs</a
      ></h2
    ><p
    >Saved jobs can be configured to run on a periodic basis. If you want to create a Scheduled Job, select Yes under &quot;Schedule to run repeatedly?&quot;</p
    ><div class="figure"
    ><img src="figures/fig0306.png" alt="Scheduled job simple form"
       /><p class="caption"
      >Scheduled job simple form</p
      ></div
    ><p
    >The schedule can be defined in a simple graphical chooser or Unix crontab format.</p
    ><p
    >To use the simple chooser, choose an hour and minute. You can then choose &quot;Every Day&quot; (default), or uncheck that option and select individual days of the week. You can select &quot;Every Month&quot; (default) or unselect that option and choose specific months of the year:</p
    ><p
    >If the crontab time and date format is preferred, enter a cron expression.</p
    ><div class="figure"
    ><img src="figures/fig0307.png" alt="Scheduled job crontab form"
       /><p class="caption"
      >Scheduled job crontab form</p
      ></div
    ><p
    >Use the crontab syntax referenced here: <a href="http://www.quartz-scheduler.org/docs/api/1.8.1/org/quartz/CronExpression.html"
      >CronExpression</a
      ></p
    ><p
    >After the Job has been updated to include a schedule, a clock icon will be displayed when the Job is listed:</p
    ><div class="figure"
    ><img src="figures/fig0308.png" alt="Scheduled job icon"
       /><p class="caption"
      >Scheduled job icon</p
      ></div
    ></div
  ><div id="job-notifications"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.8</span
	> Job Notifications</a
      ></h2
    ><p
    >You can configure notifications to occur when a Job Execution finishes with either success or failure.</p
    ><p
    >If you want to receive notifications, click Yes under &quot;Send Notification?&quot;.</p
    ><div class="figure"
    ><img src="figures/fig0322.png" alt="Notification form"
       /><p class="caption"
      >Notification form</p
      ></div
    ><p
    >You can enable notifications for either Success or Failure, and either notification by email, or by webhooks. Click the checkbox next to the type of notification to enable.</p
    ><div class="figure"
    ><img src="figures/fig0323.png" alt="Notifications enabled"
       /><p class="caption"
      >Notifications enabled</p
      ></div
    ><p
    >Enter either comma-separated email addresses for email notification, or comma-separated URLs for webhook notification.</p
    ><p
    >When the Job finishes executing, all &quot;success&quot; notifications will be triggered if the Job is successful. Otherwise, all &quot;failure&quot; notifications will be triggered if the Job fails or is cancelled.</p
    ><ul
    ><li
      >For more information about the Webhook mechanism used, see the chapter <a href="RunDeck-Guide.html#webhooks"
	>Integration - Webhooks</a
	>.</li
      ></ul
    ></div
  ><div id="job-history"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.9</span
	> Job history</a
      ></h2
    ><p
    >In the Jobs page, you can see the outcome of previous executions of Jobs by clicking the &quot;Executions&quot; link for the Job.</p
    ><div class="figure"
    ><img src="figures/fig0309.png" alt="Job executions link"
       /><p class="caption"
      >Job executions link</p
      ></div
    ><p
    >This returns a filtered history pertaining to that Job. You can click on any past execution in the list to see the full execution state.</p
    ><div class="figure"
    ><img src="figures/fig0310.png" alt="Job executions matches"
       /><p class="caption"
      >Job executions matches</p
      ></div
    ><p
    >From the Job detail page, one can also see previous execution history.</p
    ></div
  ><div id="killing-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.10</span
	> Killing Jobs</a
      ></h2
    ><p
    >Jobs that are currently running can be Killed immediately.</p
    ><p
    >WARNING: This feature should be used with caution, as it forcibly kills the Java Thread that the Job is running on. It may result in the RunDeck server becoming flaky. It is a deprecated feature of Java that is not recommended to be used, so do so only when extremely necessary.</p
    ><p
    >From the History view Now Running section, or in the Job execution follow page, click on the &quot;Kill Job Now&quot; button for the running Job.</p
    ><p
    >When prompted &quot;Really kill this job?&quot; Click the &quot;Yes&quot; button.</p
    ><p
    >The Job will terminate with a &quot;Killed&quot; completion status.</p
    ><p
    >See also: <a href="rd-queue.html"
      >rd-queue</a
      >.</p
    ></div
  ><div id="deleting-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.11</span
	> Deleting Jobs</a
      ></h2
    ><p
    >In the Job detail page, click the red &quot;X&quot; icon for to delete the Job.</p
    ><div class="figure"
    ><img src="figures/fig0311.png" alt="Job delete button"
       /><p class="caption"
      >Job delete button</p
      ></div
    ><p
    >Click &quot;Yes&quot; when it says &quot;Really delete this Job?&quot;</p
    ></div
  ><div id="updating-and-copying-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.12</span
	> Updating and copying Jobs</a
      ></h2
    ><p
    >All of the data you set when creating a job can be modified (except UUID). To edit a Job, you can click the Pencil icon:</p
    ><div class="figure"
    ><img src="figures/fig0312.png" alt="Job edit button"
       /><p class="caption"
      >Job edit button</p
      ></div
    ><p
    >Similarly, to Copy a Job definition to a new Job, press the Copy button.</p
    ><div class="figure"
    ><img src="figures/fig0313.png" alt="Job copy button"
       /><p class="caption"
      >Job copy button</p
      ></div
    ></div
  ><div id="exporting-job-definitions"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.13</span
	> Exporting Job definitions</a
      ></h2
    ><p
    >Job definitions created inside the RunDeck graphical console can be exported to XML or YAML file formats and be used for later import.</p
    ><p
    >Two methods exist to retrieve the Job definitions: via RunDeck's graphical interface, and via the <code>rd-jobs</code> shell tool.</p
    ><p
    >In the Job detail page, locate the icon with a document symbol in the toolbar. It is labeled &quot;Download Job definition file&quot; in the mouse tool tip. Clicking on the icon will let you choose either XML or YAML format to download the definition.</p
    ><div class="figure"
    ><img src="figures/fig0314.png" alt="Job export button"
       /><p class="caption"
      >Job export button</p
      ></div
    ><p
    >Click the preferred format to initiate the file download to your browser.</p
    ><p
    >If you prefer to use the command line, open a shell on the RunDeck server. Run the <code
      >rd-jobs</code
      > command to write it to disk. By default, rd-jobs will dump all Job definitions to one file. To limit it to just a single Job specify its name with <code
      >-n</code
      > or its ID with <code
      >-i</code
      >:</p
    ><pre
    ><code
      >rd-jobs -p project -n &quot;job-name&quot; -f job.xml
</code
      ></pre
    ><p
    >This will store the results in the &quot;job.xml&quot; file.</p
    ><p
    >To export it in YAML format, specify the <code
      >-F</code
      > option:</p
    ><pre
    ><code
      >rd-jobs -p project -n &quot;job-name&quot; -F yaml -f job.yaml
</code
      ></pre
    ><p
    >This will export in the YAML document format file.</p
    ><p
    >The XML and YAML document formats are described here:</p
    ><ul
    ><li
      >XML: <a href="job-v20.html"
	>job-v20(5)</a
	></li
      ><li
      >YAML: <a href="job-yaml-v12.5.html"
	>job-yaml-v12(5)</a
	></li
      ></ul
    ><p
    >Consult the <a href="rd-jobs.html"
      >rd-jobs(1)</a
      > manual page for additional command usage.</p
    ></div
  ><div id="importing-job-definitions"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.14</span
	> Importing Job definitions</a
      ></h2
    ><p
    >If you have a &quot;job.xml&quot; file (See above) and want to upload it via the GUI web interface, you can do so.</p
    ><p
    >Click on the New Job&quot; button in the Job list.</p
    ><p
    >In the &quot;Create New Job&quot; form, click on the button that says &quot;Upload Definition...&quot; on the right side:</p
    ><div class="figure"
    ><img src="figures/fig0315.png" alt="Job import button"
       /><p class="caption"
      >Job import button</p
      ></div
    ><p
    >Click the Choose File button and choose your job.xml file to upload.</p
    ><div class="figure"
    ><img src="figures/fig0316.png" alt="Job import form"
       /><p class="caption"
      >Job import form</p
      ></div
    ><p
    >Choose an option where it says &quot;When a job with the same name already exists:&quot;:</p
    ><ul
    ><li
      >Update - this means that a job defined in the xml will overwrite any existing job with the same name<br
	 /></li
      ><li
      >Skip - this means that a job defined in the xml will be skipped over if there is an existing job with the same name<br
	 /></li
      ><li
      >Create - this means that the job defined in the xml will be used to create a new job if there is an existing job with the same name.</li
      ></ul
    ><p
    >Click the Upload button. If there are any errors with the Job definitions in the XML file, they will show up on the page.</p
    ></div
  ><div id="summary-2"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.15</span
	> Summary</a
      ></h2
    ><p
    >After reading this chapter, you should be familiar with RunDeck Jobs and able to find and run them. You should understand how to create temporary and saved jobs and understand how to find their history. Finally, you should be aware of how to export and import Job definitions as XML documents.</p
    ><p
    >Next, we'll cover how to create multi-step procedures using Job Workflows.</p
    ></div
  ></div
><div id="job-workflows"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >5</span
      > Job Workflows</a
    ></h1
  ><p
  >The Job's most basic feature is its ability to execute one or more commands across a set of nodes. This sequence of commands is called a <em
    >workflow</em
    >, and each step in the workflow is defined as an invocation to a command.</p
  ><p
  >The steps of the Job workflow are displayed when viewing a Job's detail from a Job listing or within the Job editor form.</p
  ><div id="workflow-definition"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.1</span
	> Workflow definition</a
      ></h2
    ><p
    >Workflows can be defined within the RunDeck graphical console or as an XML or YAML document that is loaded to the server.</p
    ><p
    >The graphical console provides an authoring environment where steps can be added, edited, removed or reordered.</p
    ><p
    >Users preferring to define Jobs in a text format should refer to the two format definitions:</p
    ><ul
    ><li
      >XML: <a href="job-v20.html"
	>job-v20(5)</a
	></li
      ><li
      >YAML: <a href="job-yaml-v12.5.html"
	>job-yaml-v12(5)</a
	></li
      ></ul
    ><p
    >It is also possible to author Jobs inside the graphical console and then export the definition as a file using the <code
      >rd-jobs</code
      > shell tool (<a href="rd-jobs.html"
      >rd-jobs(1)</a
      >).</p
    ><p
    >See <a href="#exporting-job-definitions"
      >Exporting Job definitions</a
      > and <a href="#importing-job-definitions"
      >Importing Job definitions</a
      >.</p
    ></div
  ><div id="workflow-control-settings"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.2</span
	> Workflow control settings</a
      ></h2
    ><p
    >Workflow execution is controlled by two important settings: <em
      >Keepgoing</em
      > and <em
      >Strategy</em
      >.</p
    ><div class="figure"
    ><img src="figures/fig0401.png" alt="Workflow controls"
       /><p class="caption"
      >Workflow controls</p
      ></div
    ><p
    ><em
      >Keepgoing</em
      >: This manages what to do if a step incurs and error:</p
    ><ul
    ><li
      >No: Fail immediately (default)</li
      ><li
      >Yes: Continue to next step</li
      ></ul
    ><p
    >The default is to fail immediately but depending on the procedure at hand you can choose to have the execution continue.</p
    ><p
    ><em
      >Strategy</em
      >: Controls the order of execution of steps and command dispatch to nodes: <em
      >Node-oriented</em
      > and <em
      >Step-oriented</em
      >.</p
    ><ul
    ><li
      ><em
	>Node-oriented</em
	>: Executes the full workflow on each node before the next node. (default)</li
      ><li
      ><em
	>Step-oriented</em
	>: Executes each step on all nodes before the next node.</li
      ></ul
    ><p
    >The following illustrations contrast the strategies showing how three steps proceed across two nodes.</p
    ><p
    >Node-oriented flow illustrated:</p
    ><pre
    ><code
      >1.   NodeA    step#1
2.     &quot;      step#2
3.     &quot;      step#3
4.   NodeB    step#1
5.     &quot;      step#2
6.     &quot;      step#3
</code
      ></pre
    ><p
    >Step-oriented flow illustrated:</p
    ><pre
    ><code
      >1.   NodeA    step#1
2.   NodeB      &quot;
3.   NodeA    step#2
4.   NodeB      &quot;
5.   NodeA    step#1
6.   NodeB      &quot;
</code
      ></pre
    ><p
    >The process you are automating will determine which strategy is correct, though the node-oriented flow is more commonplace.</p
    ></div
  ><div id="workflow-steps"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.3</span
	> Workflow steps</a
      ></h2
    ><p
    >The following sections describe how to construct a workflow as a set of steps that call commands of different types.</p
    ><p
    >When creating a new Job definition, the Workflow form will be set with defaults and have no workflow steps defined. The workflow editor will have a form open asking to enter a shell command as the first step.</p
    ><div class="figure"
    ><img src="figures/fig0402.png" alt="Add a step"
       /><p class="caption"
      >Add a step</p
      ></div
    ><p
    >To add new steps simply press the &quot;Add a step&quot; link inside the workflow editor form. This will prompt you with a dialog asking which kind of workflow step you would like to add. Each kind of step has its own form. When you are done filling out the form, press &quot;Save&quot; to add it to the sequence. Pressing &quot;Cancel&quot; will close the form and leave the sequence unchanged.</p
    ><div class="figure"
    ><img src="figures/fig0403.png" alt="Workflow step types"
       /><p class="caption"
      >Workflow step types</p
      ></div
    ><p
    >New steps are always added to the end of the sequence. See <a href="#reordering-steps"
      >Reordering steps</a
      > for directions on modifying the step order.</p
    ><p
    >The next several sections describe the specification of each kind of command step.</p
    ><div id="command-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.1</span
	  > Command step</a
	></h3
      ><p
      >Use the command step to call system commands. This is the default type of workflow step when creating a Job. Enter any command string you would type at the terminal on the remote hosts.</p
      ><div class="figure"
      ><img src="figures/fig0404.png" alt="Command step type"
	 /><p class="caption"
	>Command step type</p
	></div
      ><p
      >This is similar to calling the command with <code>dispatch</code>:</p
      ><pre
      ><code
	>dispatch [filter-options] -- command
</code
	></pre
      ></div
    ><div id="script-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.2</span
	  > Script step</a
	></h3
      ><p
      >Execute the supplied shell script content. Optionally, can pass an argument to the script specified in the lower text field.</p
      ><div class="figure"
      ><img src="figures/fig0405.png" alt="Script step type"
	 /><p class="caption"
	>Script step type</p
	></div
      ><p
      >This is similar to calling the command with <code>dispatch</code>:</p
      ><pre
      ><code
	>dispatch [filter-options] --stdin -- args &lt;&lt;EOF 
script content here 
EOF
</code
	></pre
      ></div
    ><div id="script-file-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.3</span
	  > Script file step</a
	></h3
      ><p
      >Executes the script file local to the sever to the filtered Node set. Arguments can be passed to the script by specifying them in the lower text field.</p
      ><div class="figure"
      ><img src="figures/fig0406.png" alt="Script file step type"
	 /><p class="caption"
	>Script file step type</p
	></div
      ><p
      >This is similar to calling the script file with <code>dispatch</code>:</p
      ><pre
      ><code
	>dispatch [filter-options] -s scriptfile -- args
</code
	></pre
      ></div
    ><div id="job-reference-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.4</span
	  > Job reference step</a
	></h3
      ><p
      >To call another saved Job, create a Job Reference step. Enter the name of the Job and its group.</p
      ><div class="figure"
      ><img src="figures/fig0407.png" alt="Job step type"
	 /><p class="caption"
	>Job step type</p
	></div
      ><p
      >The Job Reference form provides a Job browser to make it easier to select from the existing set of saved Jobs. Click the &quot;Choose A Job...&quot; link and navigate to the desired Job.</p
      ><p
      >Finally, if the Job defines Options, you can specify them in the commandline arguments text field and can include variable expansion to pass any input options for the current job. Format:</p
      ><pre
      ><code
	>-optname &lt;value&gt; -optname &lt;value&gt; ...
</code
	></pre
      ><p
      >The format for specifying options is exactly the same as you would pass to the <code
	>run</code
	> commandline tool, and you can substitute values of input options to the current job. For example:</p
      ><pre
      ><code
	>-opt1 something -opt2 ${option.opt2}
</code
	></pre
      ><p
      >This would set the value &quot;something&quot; for the Job's &quot;opt1&quot; option, and then pass the &quot;opt2&quot; option directly from the top-level job to the Job reference.</p
      ><p
      >This is similar to calling the other Job with <a href="run.html"
	>run</a
	>:</p
      ><pre
      ><code
	>run [filter-options] -j group/jobname -- -opt1 something -opt2 somethingelse
</code
	></pre
      ><p
      >If the Job has required Options that are not specified on the arguments line, then a &quot;defaultValue&quot; of that option will be used if it is defined. If a required option does not have a default value, then the execution will fail because the option is not specified.</p
      ></div
    ></div
  ><div id="reordering-steps"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.4</span
	> Reordering steps</a
      ></h2
    ><p
    >The order of the Workflow steps can be modified by hovering over any step and then clicking and dragging the double arrow icon to the desired position. A blue horizontal bar helps highlight the position where the Job will land.</p
    ><div class="figure"
    ><img src="figures/fig0408.png" alt="Job step reorder"
       /><p class="caption"
      >Job step reorder</p
      ></div
    ><p
    >After releasing the select Job, it will land in the desired position and the step order will be updated.</p
    ><p
    >If you wish to Undo the step reordering, press the &quot;Undo&quot; link above the steps.</p
    ><p
    >The &quot;Redo&quot; button can be pressed to reapply the last undone change.</p
    ><p
    >Press the &quot;Revert All Changes&quot; button to go back to the original step order.</p
    ></div
  ><div id="save-the-changes"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.5</span
	> Save the changes</a
      ></h2
    ><p
    >Once the Workflow steps have been defined and order, changes are permanently saved after pressing the &quot;Create&quot; button if new or the &quot;Update&quot; button if the Job is being modified.</p
    ></div
  ><div id="summary-3"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.6</span
	> Summary</a
      ></h2
    ><p
    >At this point you should understand what a Job workflow is, the kinds of steps they can contain and how to define a workflow.</p
    ><p
    >Next, we'll cover more about RunDeck's Job Option features.</p
    ></div
  ></div
><div id="job-options"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >6</span
      > Job Options</a
    ></h1
  ><p
  >Any command or script can be wrapped as a Job. Creating a Job for every use case will proliferate a large number of Jobs differing only by how the Job calls the scripts. These differences are often environment or application version related. Other times only the person running the Job can provide the needed information to run the Job correctly.</p
  ><p
  >Making your scripts and commands data driven, will also make them more generic and therefore, reusable in different contexts. Rather than maintain variations of the same basic process, letting Jobs be driven by a model of options from externally provided data will lead to better abstraction and encapsulation of your process.</p
  ><p
  >RunDeck Jobs can be configured to prompt a user for input by defining one or more named <em
    >options</em
    >. An <em
    >option</em
    > models a named parameter that can be required or optional and include a range of choices that will be presented to the user when the Job is run.</p
  ><p
  >Users supply options by typing in a value or selecting from a menu of choices. A validation pattern ensures input complies to the option requirement. Once chosen, the value chosen for the option is accessible to the commands called by the Job.</p
  ><p
  >Option choices can be modeled as a static set or from a dynamic source. Static choices can be modeled as a comma separated list in the job definition. When option values must be dynamic, the Job can be defined to use a URL to retrieve option data from an external source. Enabling Jobs to access external sources via URL opens the door to integrating RunDeck with other tools and incorporating their data into Job workflows.</p
  ><div id="prompting-the-user"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.1</span
	> Prompting the user</a
      ></h2
    ><p
    >The obvious effect from defining Job options is their appearance to the user running the Job. Users will be presented a page called &quot;Choose Execution Options...&quot; where input and menu choices must be configured.</p
    ><p
    >Command line users executing Jobs via the <code
      >run</code
      > shell tool also will specify options as an argument string.</p
    ><p
    >It is worth spending a moment to consider how options become part of the user interface to Jobs and give some thought to this next level of procedure formalization.</p
    ><ul
    ><li
      >Naming and description convention: Visualize how the user will read the option name and judge its purpose from the description you supply.</li
      ><li
      >Required options: Making an option required means the Job will fail if a user leaves it out.</li
      ><li
      >Input restrictions and validation: If you need to make the option value be somewhat open ended consider how you can create safeguards to control their choice.</li
      ></ul
    ></div
  ><div id="secure-options"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.2</span
	> Secure Options</a
      ></h2
    ><p
    >The built-in <a href="#ssh-provider"
      >SSH Provider</a
      > for node execution allows using passwords for SSH and/or Sudo authentication mechanisms, and the passwords are supplied by Secure Options defined in a Job.</p
    ><p
    >A Secure Option will always show a password prompt in the GUI, instead of a normal text field or drop down menu.</p
    ><p
    >Secure Options have some limitations compared to regular options:</p
    ><ul
    ><li
      >The values entered by the user are not available for normal script and command option value expansion. This means that they can only be used for the purposes of the SSH Provider at the moment.</li
      ><li
      >Secure Options do not support allow Multi-valued input</li
      ><li
      >Secure option values are not stored with the Execution as are the other option values.</li
      ></ul
    ></div
  ><div id="options-editor"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.3</span
	> Options editor</a
      ></h2
    ><p
    >Options can be created for any stored Job. The Job edit page contains an area displaying a summary to existing options and a link to add new ones or edit existing ones.</p
    ><div class="figure"
    ><img src="figures/fig0501.png" alt="Add option link"
       /><p class="caption"
      >Add option link</p
      ></div
    ><p
    >The option summary shows each option and its default value if it defines them.</p
    ><p
    >Clicking the &quot;edit&quot; link opens the options editor.</p
    ><div class="figure"
    ><img src="figures/fig0503.png" alt="Option editor"
       /><p class="caption"
      >Option editor</p
      ></div
    ><p
    >The options editor displays an expanded summary for each defined option. Each option is listed with its usage summary, description, values list and any restrictions. Pressing the &quot;Add an option&quot; link will open a form to define a new parameter. Pressing the &quot;Close&quot; link will collapse the options editor and return back to the summary view.</p
    ><p
    >Moving the mouse over any row in the options editor reveals links to delete or edit the highlighted option. Pressing the remove icon will display a prompt confirming you want to delete that option from the Job. Clicking the &quot;edit&quot; link opens a new form that lets you modify all aspects of that option.</p
    ><p
    >Options can also be defined as part of a job definition and later loaded to the RunDeck server. See <a href="job-v20.html"
      >job-v20(5)</a
      >(XML) and <a href="job-yaml-v12.html"
      >job-yaml-v12(5)</a
      >(YAML) and <a href="rd-jobs.html"
      >rd-jobs(1)</a
      > manual pages if you prefer using an textual Job definition.</p
    ></div
  ><div id="defining-an-option"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.4</span
	> Defining an option</a
      ></h2
    ><p
    >New options can be defined by pressing the &quot;Add an option&quot; link while existing ones can be changed by pressing their &quot;edit&quot; link.</p
    ><div class="figure"
    ><img src="figures/fig0502.png" alt="Option edit form"
       /><p class="caption"
      >Option edit form</p
      ></div
    ><p
    >The option definition form is organized into several areas:</p
    ><dl
    ><dt
      >Identification</dt
      ><dd
      ><p
	>Here you provide the option's name and description. The name becomes part of acceptable arguments to the Job while the description will be provided as help text to users running the Job.</p
	><p
	>The Default Value will be pre-selected in the GUI when the option is presented.</p
	></dd
      ><dt
      >Secure Input</dt
      ><dd
      ><p
	>Set to true to define a Secure Option. The multi-valued option will be disabled.</p
	></dd
      ><dt
      >Allowed values</dt
      ><dd
      ><p
	>Allowed values provide a model of possible choices. This can contain a static list of values or a URL to a server providing option data. Values can be specified as a comma separated list as seen above but can also be requested from an external source using a &quot;remote URL&quot; <a href="#remote-option-values"
	  >See below</a
	  >.</p
	></dd
      ><dt
      >Restrictions</dt
      ><dd
      ><p
	>Defines criteria on which input to accept or present. Option choices can be controlled using the &quot;Enforced from values&quot; restriction. When set &quot;true&quot;, RunDeck will only present a popup menu. If set &quot;false&quot;, a text field will also be presented. Enter a regular expression in the &quot;Match Regular Expression&quot; field the Job will evaluate when run.</p
	></dd
      ><dt
      >Requirement</dt
      ><dd
      ><p
	>Indicates if the Job can only run if a choice is provided for that Option. Choosing &quot;No&quot; states the option is not required Choose &quot;Yes&quot; to state the option is required.</p
	><p
	>If a Default Value is set for the option, then this value will automatically be set for the option if it is Required, even if not specified among the arguments when executing a job via the command-line or API.</p
	></dd
      ><dt
      >Multi-valued</dt
      ><dd
      ><p
	>Defines if the user input can consist of multiple values. Choosing &quot;No&quot; states that only a single value can chosen as input. Choosing &quot;Yes&quot; states that the user may select multiple input values from the Allowed values and/or enter multiple values of their own. The delimiter string will be used to separate the multiple values when the Job is run.</p
	></dd
      ></dl
    ><p
    >Once satisfied with the option definition, press the &quot;Save&quot; button to add it to the Job definition. Pressing the &quot;Cancel&quot; button will dismiss the changes and close the form.</p
    ></div
  ><div id="remote-option-values"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.5</span
	> Remote option values</a
      ></h2
    ><p
    >A model of option values can be retrieved from an external source. When the <code
      >valuesUrl</code
      > is specified for an Option, then the model of allowed values is retrieved from the specified URL.</p
    ><p
    >This is useful in a couple of scenarios when RunDeck is used to coordinate process that depend on other systems:</p
    ><ul
    ><li
      >Deploying packages or artifacts produced by a build or CI server, e.g. Hudson.<ul
	><li
	  >A list of recent Hudson build artifacts can be imported as Options data, so that a User can pick an appropriate package name to deploy from a list.</li
	  ></ul
	></li
      ><li
      >Selecting from a set of available environments, defined in a CMDB</li
      ><li
      >Any situation in which input variables for your Jobs must be selected from some set of values produced by a different system.</li
      ></ul
    ><p
    >See <a href="#option-model-provider"
      >Chapter 9 - Option Model Provider</a
      >.</p
    ></div
  ><div id="script-usage"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.6</span
	> Script usage</a
      ></h2
    ><p
    >Option values can be passed to scripts as an argument or referenced inside the script via a named token. Option values can be accessed in one of several ways:</p
    ><dl
    ><dt
      >Value passed as an environment variable:</dt
      ><dd
      ><p
	>Bash: $RD_OPTION_<em
	  >NAME</em
	  > <sup
	  ><a href="#fn2" class="footnoteRef" id="fnref2"
	    >2</a
	    ></sup
	  ></p
	></dd
      ><dt
      >Value passed as an argument to a script:</dt
      ><dd
      ><p
	>Commandline Arguments: ${option.<em
	  >name</em
	  >}</p
	></dd
      ><dt
      >Value referenced as a replacement token inside the script:</dt
      ><dd
      ><p
	>Script Content: @option.<em
	  >name</em
	  >@</p
	></dd
      ></dl
    ><p
    >A single example helps illustrate these methods. Imagine a trivial script is wrapped in a Job named &quot;hello&quot; and has an option named &quot;message&quot;.</p
    ><p
    >The &quot;hello&quot; Job option signature would be: <code
      >-message &lt;&gt;</code
      >.</p
    ><div class="figure"
    ><img src="figures/fig0504.png" alt="Option usage"
       /><p class="caption"
      >Option usage</p
      ></div
    ><p
    >Here's the content of this simple script.</p
    ><pre class="sourceCode bash"
    ><code
      ><span class="Normal NormalText"
	>    </span
	><span class="Comment"
	>#!/bin/sh    </span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Builtin"
	>echo</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Variable"
	>envvar=$RD_OPTION_MESSAGE</span
	><span class="Normal NormalText"
	> ;</span
	><span class="Comment"
	># read from environment</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Builtin"
	>echo</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Variable"
	>args=$1</span
	><span class="Normal NormalText"
	>                   ;</span
	><span class="Comment"
	># comes from argument vector</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Builtin"
	>echo</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Variable"
	>message=</span
	><span class="Normal NormalText"
	>@option.message@  ;</span
	><span class="Comment"
	># replacement token</span
	><br
	 /></code
      ></pre
    ><p
    >When the user runs the &quot;hello&quot; job they will be prompted for the &quot;message&quot; value.</p
    ><div class="figure"
    ><img src="figures/fig0505.png" alt="Option entered"
       /><p class="caption"
      >Option entered</p
      ></div
    ><p
    >Let's assume they entered the word &quot;howdy&quot; in response. The output of the Job will be:</p
    ><pre
    ><code
      >envar=howdy
args=howdy    
message=howdy    
</code
      ></pre
    ><p
    >It's important to know what happens if the option isn't set. This can happen if you define an option that is not required and do not give it a default value.</p
    ><p
    >Let's imagine the Job was run without a message option supplied, the output would look like this:</p
    ><pre
    ><code
      >envar=
args=
message=@option.message@
</code
      ></pre
    ><p
    >Here are some tips to deal with this possibility:</p
    ><dl
    ><dt
      >Environment variable:</dt
      ><dd
      ><p
	>As a precaution you might test existence for the variable and perhaps set a default value. To test its existence you might use:</p
	><pre
	><code
	  > test -s  $RD_OPTION_NAME
</code
	  ></pre
	><p
	>You might also use a Bash feature that tests and defaults it to a value:</p
	><pre
	><code
	  > ${RD_OPTION_NAME:=mydefault} 
</code
	  ></pre
	></dd
      ><dt
      >Replacement token</dt
      ><dd
      >If the option is unset the token will be left alone inside the script. You might write your script a bit more defensively and change the implementation like so:</dd
      ></dl
    ><pre class="sourceCode bash"
    ><code
      ><span class="Normal NormalText"
	>        </span
	><span class="Others Variable"
	>message=</span
	><span class="Normal NormalText"
	>@option.message@</span
	><br
	 /><span class="Normal NormalText"
	>        </span
	><span class="Keyword"
	>if</span
	><span class="Keyword Builtin"
	> [</span
	><span class="Normal NormalText"
	> </span
	><span class="String StringDoubleQ"
	>&quot;</span
	><span class="Others Variable"
	>$message</span
	><span class="String StringDoubleQ"
	>&quot;</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Expression"
	>==</span
	><span class="Normal NormalText"
	> </span
	><span class="String StringDoubleQ"
	>&quot;@option.message@&quot;</span
	><span class="Keyword Builtin"
	> ]</span
	><span class="Normal NormalText"
	> ; </span
	><span class="Keyword"
	>then</span
	><br
	 /><span class="Normal NormalText"
	>           </span
	><span class="Others Variable"
	>message=</span
	><span class="Normal NormalText"
	>mydefault</span
	><br
	 /><span class="Normal NormalText"
	>        </span
	><span class="Keyword"
	>fi</span
	><span class="Normal NormalText"
	> </span
	><br
	 /></code
      ></pre
    ></div
  ><div id="calling-a-job-with-options"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.7</span
	> Calling a Job with options</a
      ></h2
    ><p
    >Jobs can be invoked from the command line using the <code
      >run</code
      > shell tool or as a step in another Job's workflow.</p
    ><p
    >The format for specifying options is <code
      >-name value</code
      >.</p
    ><p
    >Using the <code
      >run</code
      > command pass them after the double hyphen:</p
    ><pre
    ><code
      >run -i jobId -- -paramA valA -paramB valB
run -j group/name -p project -- -paramA valA -paramB valB
</code
      ></pre
    ><p
    >Inside an XML definition, insert them as an <code
      >arg</code
      > element:</p
    ><pre class="sourceCode xml"
    ><code
      ><span class="Keyword Element"
	>&lt;command&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;jobref</span
	><span class="Others Attribute"
	> group=</span
	><span class="String Value"
	>&quot;test&quot;</span
	><span class="Others Attribute"
	> name=</span
	><span class="String Value"
	>&quot;other tests&quot;</span
	><span class="Keyword Element"
	>&gt;</span
	><br
	 /><span class="Normal NormalText"
	>        </span
	><span class="Keyword Element"
	>&lt;arg</span
	><span class="Others Attribute"
	> line=</span
	><span class="String Value"
	>&quot;-paramA valA -paramB valB&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;/jobref&gt;</span
	><br
	 /><span class="Keyword Element"
	>&lt;/command&gt;</span
	><br
	 /></code
      ></pre
    ><p
    >Consult the <a href="run.html"
      >run(1)</a
      > and <a href="job-v20.html"
      >job-v20(5)</a
      > manual pages for additional information.</p
    ></div
  ><div id="summary-4"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.8</span
	> Summary</a
      ></h2
    ><p
    >After reading this chapter you should understand how to run Jobs with options, as well as, add and edit them. If you are interested in generating option data for one of your jobs, see the <a href="#option-model-provider-examples"
      >option model provider</a
      > section in the <a href="#rundeck-by-example"
      >Examples</a
      > chapter.</p
    ></div
  ></div
><div id="rundeck-by-example"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >7</span
      > RunDeck by example</a
    ></h1
  ><p
  >This chapter presents working examples reflecting a variety of solutions you can create with RunDeck. Helping you apply concepts and features introduced in earlier chapters is the focus of these examples. Rather than make the examples abstract, they are set in the context of Acme Anvils, a fictitious organization that manages an online application.</p
  ><div id="acme-anvils"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.1</span
	> Acme Anvils</a
      ></h2
    ><p
    >Acme Anvils is a hypothetical start up selling new and used anvils from their web site. Two teams inside the company are involved with the development and support of the anvil sales application. Being a new company, there isn't much control over access to the live environment. Either team can make changes to systems which has led to mistakes and outages. Because the senior management is so enthusiastic, they push the teams to deliver new features as frequently as possible. Unfortunately, this has led to another problem: the Acme Anvil web site is an unstable memory hog and requires occasional restarts.</p
    ><p
    >There are actually two methods to the restart procedure depending on the problem: &quot;kill&quot; versus &quot;normal&quot;. The &quot;kill&quot; restart is required when the application becomes totally unresponsive. The &quot;normal&quot; restart occurs when the application needs to free memory.</p
    ><p
    >Depending on the urgency or the staff on hand, either a developer or an administrator conducts the restart, albeit differently. Because the developers write the software, they understand the restart requirements from an application perspective. The administrators on the other hand, are not always informed of these requirements but are well versed in restarting the application from a systems perspective. This has led to a divergence in procedures and has become the main source of problems that affect their customers.</p
    ><p
    >An administrator, tired of the late night calls to restart the application, and frustrated by the knowledge gap between operations and development has decided to take the initiative come up with a better approach.</p
    ></div
  ><div id="rundeck-set-up"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.2</span
	> RunDeck set up</a
      ></h2
    ><p
    >The administrator chooses a machine with access to the servers in the live environment and installs the RunDeck software there.</p
    ><p
    >A project called &quot;anvils&quot; is created to manage the application support activities.</p
    ><p
    >The administrator creates the project using the <a href="rd-project.html"
      >rd-project</a
      > shell tool though this could be done with the RunDeck GUI (see (<a href="#project-setup"
      >project setup</a
      >). After logging into the RunDeck server, the command is run:</p
    ><pre
    ><code
      >rd-project -p anvils -a create
</code
      ></pre
    ><p
    >This initialized the &quot;anvils&quot; project in RunDeck so it only contains information about the server node. Adding information about the nodes deployed in the live environment is the next step (see <a href="#resource-model"
      >resource model</a
      >).</p
    ><p
    >The environment has five nodes: anv1-anv5. Anvils is a three tier application and has web, application and database components installed across the five nodes.</p
    ><p
    >Additionally, the administrator decides to incorporate a recent convention to use different system logins to execute SSH commands to control running application components. The web component are run as the &quot;www&quot; user while the app and database components run as user &quot;anvils&quot;.</p
    ><p
    >With this information in hand, the administrator prepares the project resource model using the <a href="resource-v13.html"
      >resource-v13(5) XML</a
      > or <a href="resource-yaml-v13.html"
      >resource-v13(5) YAML</a
      > document format. The file listing below contains the node definitions for the five nodes -- anv1, anv2, anv3, anv4, anv5:</p
    ><p
    >File listing: resources.xml</p
    ><pre
    ><code
      >&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;project&gt;
  &lt;node name=&quot;anv1&quot; type=&quot;Node&quot;
     description=&quot;an anvils web server&quot; 
     hostname=&quot;anv1.acme.com&quot;  username=&quot;www&quot; tags=&quot;web&quot;/&gt;
  &lt;node name=&quot;anv2&quot; type=&quot;Node&quot; 
     description=&quot;an anvils web server&quot; 
     hostname=&quot;anv2.acme.com&quot;  username=&quot;www&quot; tags=&quot;web&quot;/&gt;
  &lt;node name=&quot;anv3&quot; type=&quot;Node&quot; 
     description=&quot;an avnils app server&quot; 
     hostname=&quot;anv3.acme.com&quot;  username=&quot;anvils&quot; tags=&quot;app&quot;/&gt;
  &lt;node name=&quot;anv4&quot; type=&quot;Node&quot; 
     description=&quot;an anvils app server&quot; 
     hostname=&quot;anv4.acme.com&quot;  username=&quot;anvils&quot; tags=&quot;app&quot;/&gt;
  &lt;node name=&quot;anv5&quot; type=&quot;Node&quot; 
     description=&quot;the anvils database server&quot; 
     hostname=&quot;anv5.acme.com&quot;  username=&quot;anvils&quot; tags=&quot;db&quot;/&gt; 
&lt;/project&gt;
</code
      ></pre
    ><p
    >Reviewing the XML content one sees the XML tag set represent the host information described above. A logical name for each node is defined with the <code
      >name</code
      > attribute (eg name=&quot;anv1&quot;). The address used by SSH is set with <code
      >hostname</code
      > (eg hostname=&quot;anv1.acme.com&quot;) while the login used to execute SSH commands has been specified with the <code
      >username</code
      > attribute (username=&quot;www&quot; vs username=&quot;anvils&quot;). The value for the <code
      >tags</code
      > attribute reflects the node function (tags=&quot;web&quot; vs tags=&quot;app&quot;).</p
    ><p
    >The administrator saves the file and places it in a path of his choice. To make RunDeck aware of it, the administrator modifies the project configuration file, $RDECK_BASE/projects/anvils/etc/project.properties, modifying the <code
      >project.resources.file</code
      > setting :</p
    ><pre
    ><code
      >project.resources.file = /etc/rundeck/projects/anvils/resources.xml
</code
      ></pre
    ><p
    >With the resources file in place and the project configuration updated, the administrator has finished with the resource model preparation and can begin dispatching commands.</p
    ><p
    >List all the nodes in the anvils project by opening the Filter and typing <code
      >.*</code
      > in the <em
      >Name</em
      > field and then press &quot;Filter&quot;. You should see a listing of 6 nodes.</p
    ><div class="figure"
    ><img src="figures/fig0601.png" alt="Anvils resources"
       /><p class="caption"
      >Anvils resources</p
      ></div
    ></div
  ><div id="tag-classification-and-command-dispatching"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.3</span
	> Tag classification and command dispatching</a
      ></h2
    ><p
    >With tags that describe application role, commands can be targeted to specific sub sets of nodes without hard coding any hostnames. The <a href="dispatch.html"
      >dispatch</a
      > command's listing feature illustrates how tag filtering selects particular node sets in the shell:</p
    ><p
    >Use the <code
      >tags</code
      > keyword to list the web nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=web
anv1 anv2
</code
      ></pre
    ><p
    >List the app nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=app
anv3 anv4
</code
      ></pre
    ><p
    >List the db nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=db
anv5
</code
      ></pre
    ><p
    >Use the &quot;+&quot; (AND) operator to list the web and app nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=web+app
anv1 anv2 anv3 anv4
</code
      ></pre
    ><p
    >Exclude the web and app nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -X tags=web+app
anv5
</code
      ></pre
    ><p
    >Using a wildcard for node name, list all the nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I '.*' 
anv1 anv2 anv3 anv4 anv5 
</code
      ></pre
    ><p
    >Here's an example using filters in the graphical console:</p
    ><div class="figure"
    ><img src="figures/fig0602.png" alt="Anvils filtered list"
       /><p class="caption"
      >Anvils filtered list</p
      ></div
    ><p
    >Filtering with tags provides an abstraction over hostnames and lets the administrator think about scripting process using loose classifications. New nodes can be added, others decommissioned while others given new purpose, and the procedures stay unchanged because they are bound to the filtering criteria.</p
    ><p
    >This simple classification scheme will allow the developers and administrators to share a common vocabulary when talking about the kinds of nodes supporting the Anvils application.</p
    ></div
  ><div id="jobs-1"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.4</span
	> Jobs</a
      ></h2
    ><p
    >Jobs are a convenient method to establish a library of routine procedures. By its nature, a saved Job encapsulates a process into a logically named interface. Jobs can begin as a single item workflow that calls a small or large shell script but evolve into a multi-step workflow. One job can also call another job as a step in its workflow. Using this approach one can view each Job as a reusable building block upon which more complex automation can be built.</p
    ><p
    >The administrator decides Jobs can be used to encapsulate procedures to manage the restart process. Both developers and administrators can collaborate on their definition and evolution and maintenance.</p
    ><p
    >Two sets of scripts are already in use to manage the startup and shutdown procedures. Rather than force the issue as to which one is correct or superior, the administrator focuses on creating a skeleton to more easily present how scripts can be encapsulated by the job workflow. After demonstrating this simple framework, the administrator can discuss how to incorporate the best of both script implementations into the Job definitions.</p
    ><p
    >For the skeleton, the administrator creates simple placeholder scripts that merely echo their intent and the arguments passed to the them. Two scripts - start.sh and stop.sh - represent the two steps of the restart process.</p
    ><p
    >Scripts:</p
    ><p
    >File listing: start.sh</p
    ><pre
    ><code
      >#!/bin/sh
# Usage: $0 
echo Web started.
</code
      ></pre
    ><p
    >File listing: stop.sh</p
    ><pre
    ><code
      >#!/bin/sh
# Usage: $0 [normal|kill]
echo Web stopped with method: $1.
</code
      ></pre
    ><p
    >Because either the normal or kill can be specified for the &quot;method&quot; option, the Jobs will need to pass the user's choice as an argument to the script.</p
    ><p
    >There is no script for the restart process itself since that will be defined as a Job workflow.</p
    ><div id="job-structure"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.4.1</span
	  > Job structure</a
	></h3
      ><p
      >With an idea of the restart scripts in mind, the next step is to define a job to encapsulate the restart procedure. Though the overall goal is to provide a single restart procedure, for the sake of reusability, it might be preferred to break each step of the process into separate jobs.</p
      ><p
      >Using this approach the administrator imagines the following jobs:</p
      ><ul
      ><li
	>start: call the start.sh script to start the web service</li
	><li
	>stop: call the stop.sh script to stop the web service</li
	><li
	>Restart: calls the jobs: stop, start</li
	></ul
      ><p
      >Since the restart procedure is the primary focus, it is capitalized for distinction.</p
      ><p
      >The extra complexity from defining a job for every individual step can pay off later, if those steps can be recombined with future jobs to serve later management needs. How far a process is decomposed into individual jobs is a judgement balancing maintenance requirements and the desire for job reuse.</p
      ></div
    ><div id="job-grouping"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.4.2</span
	  > Job grouping</a
	></h3
      ><p
      >Though not a requirement, it is helpful to use job groups and have a convention for naming them. A good convention assists others with a navigation scheme that helps them remember and find the desired procedure.</p
      ><p
      >The administrator chooses to create a top level group named &quot;/anvils/web/&quot; where the web restart related jobs will be organized.</p
      ><pre
      ><code
	>anvils/
`-- web/
    |-- Restart
    |-- start
    `-- stop
</code
	></pre
      ><p
      >After choosing the &quot;anvils&quot; project users will see this grouping of jobs.</p
      ><div class="figure"
      ><img src="figures/fig0604.png" alt="Anvils job group"
	 /><p class="caption"
	>Anvils job group</p
	></div
      ></div
    ></div
  ><div id="job-option"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.5</span
	> Job option</a
      ></h2
    ><p
    >To support specifying the restart method to the scripts, the the three jobs will declare an option named &quot;method&quot;. Without such a parameter, the administrator would be forced to duplicate restart Jobs for both the kill and normal stop methods.</p
    ><p
    >Another benefit from defining the job option is the ability to display a menu of choices to the user running the job. Once chosen, the value selected by the menu is then passed to the script.</p
    ><div id="allowed-values"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.5.1</span
	  > Allowed values</a
	></h3
      ><p
      >An option can be defined to only allow values from a specified list. This places safe guards on how a Job can be run by limiting choices to those the scripts can safely handle.</p
      ><p
      >The administrator takes advantage of this by limiting the &quot;method&quot; option values to just &quot;normal&quot; or &quot;kill&quot; choices.</p
      ><p
      >The screenshot below contains the Option edit form for the &quot;method&quot; option. The form includes elements to define description and default value, as well as, Allowed Values and Restrictions.</p
      ><div class="figure"
      ><img src="figures/fig0605.png" alt="Option editor for method"
	 /><p class="caption"
	>Option editor for method</p
	></div
      ><p
      >Allowed values can be specified as a comma separated list as seen above but can also be requested from an external source using a &quot;remote URL&quot;.</p
      ><p
      >Option choices can be controlled using the &quot;Enforced from values&quot; restriction. When set &quot;true&quot;, the RunDeck UI will only present a popup menu. If set &quot;false&quot;, a text field will also be presented. Use the &quot;Match Regular Expression&quot; form to validate the input option.</p
      ><p
      >Here's a screenshot of how RunDeck will display the menu choices:</p
      ><div class="figure"
      ><img src="figures/fig0606.png" alt="Option menu for method"
	 /><p class="caption"
	>Option menu for method</p
	></div
      ></div
    ><div id="script-access-to-option-data"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.5.2</span
	  > Script access to option data</a
	></h3
      ><p
      >Option values can be passed to scripts as an argument or referenced inside the script using a named token. For example, the value for the &quot;method&quot; option selection can be accessed in one of several ways:</p
      ><p
      >Value referenced as an environment variable:</p
      ><ul
      ><li
	>Bash: $CT_OPTION_METHOD</li
	></ul
      ><p
      >Value passed in the argument vector to the executed script or command via the <code
	>scriptargs</code
	> tag:</p
      ><ul
      ><li
	>Commandline Arguments: ${option.method}</li
	></ul
      ><p
      >Value represented as a named token inside the script and replaced before execution:</p
      ><ul
      ><li
	>Script Content: @option.method@</li
	></ul
      ></div
    ></div
  ><div id="job-workflow-composition"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.6</span
	> Job workflow composition</a
      ></h2
    ><p
    >With an understanding of the scripts and the option needed to control the restart operation, the final step is to compose the Job definitions.</p
    ><p
    >While each job can be defined graphically in RunDeck, each can succinctly be defined using an XML file conforming to the <a href="job-v20.html"
      >job-v20(5)</a
      > document format. This document contains a set of tags corresponding to the choices seen in the RunDeck GUI form.</p
    ><p
    >Below are the XML definitions for the jobs. One or more jobs can be defined inside a single XML file but your convention will dictate how to organize the definitions. The files can be named any way desired and do not have to correspond to the Job name or its group.</p
    ><p
    >File listing: stop.xml</p
    ><pre
    ><code
      >&lt;joblist&gt;   
    &lt;job&gt; 
       &lt;name&gt;stop&lt;/name&gt;  
       &lt;description&gt;the web stop procedure&lt;/description&gt;  
       &lt;loglevel&gt;INFO&lt;/loglevel&gt;  
       &lt;group&gt;anvils/web&lt;/group&gt;  
       &lt;context&gt; 
           &lt;project&gt;anvils&lt;/project&gt;  
             &lt;options&gt; 
               &lt;option name=&quot;method&quot; enforcedvalues=&quot;true&quot;
                       required=&quot;true&quot; 
                   values=&quot;normal,kill&quot;/&gt; 
               &lt;/options&gt; 
       &lt;/context&gt;  
       &lt;sequence threadcount=&quot;1&quot; keepgoing=&quot;false&quot; strategy=&quot;node-first&quot;&gt; 
         &lt;command&gt; 
           &lt;script&gt;&lt;![CDATA[#!/bin/sh
echo Web stopped with method: $1.]]&gt;&lt;/script&gt;  
            &lt;scriptargs&gt;${option.method}&lt;/scriptargs&gt; 
         &lt;/command&gt; 
       &lt;/sequence&gt;  
       &lt;nodefilters excludeprecedence=&quot;true&quot;&gt; 
         &lt;include&gt; 
          &lt;tags&gt;web&lt;/tags&gt; 
          &lt;/include&gt; 
       &lt;/nodefilters&gt;  
       &lt;dispatch&gt; 
         &lt;threadcount&gt;1&lt;/threadcount&gt;  
         &lt;keepgoing&gt;false&lt;/keepgoing&gt; 
       &lt;/dispatch&gt; 
     &lt;/job&gt;
&lt;/joblist&gt;
</code
      ></pre
    ><p
    >Defines Job, /anvils/web/stop, and executes the shell script to Nodes tagged &quot;web&quot;. Using the <code
      >scriptargs</code
      > tag, the shell script is passed a single argument, <code
      >${option.method}</code
      >, containing the value chosen in the Job run form.</p
    ><p
    >File listing: start.xml</p
    ><pre
    ><code
      >&lt;joblist&gt;   
   &lt;job&gt; 
     &lt;name&gt;start&lt;/name&gt;  
     &lt;description&gt;the web start procedure&lt;/description&gt;  
     &lt;loglevel&gt;INFO&lt;/loglevel&gt;  
     &lt;group&gt;anvils/web&lt;/group&gt;  
    &lt;context&gt; 
      &lt;project&gt;anvils&lt;/project&gt;  
    &lt;/context&gt;  
    &lt;sequence threadcount=&quot;1&quot; keepgoing=&quot;false&quot; strategy=&quot;node-first&quot;&gt; 
     &lt;command&gt; 
      &lt;script&gt;&lt;![CDATA[#!/bin/sh
 echo Web started.]]&gt;&lt;/script&gt;
     &lt;/command&gt; 
  &lt;/sequence&gt;  
    &lt;nodefilters excludeprecedence=&quot;true&quot;&gt; 
      &lt;include&gt; 
        &lt;tags&gt;web&lt;/tags&gt; 
      &lt;/include&gt; 
   &lt;/nodefilters&gt;  
   &lt;dispatch&gt; 
     &lt;threadcount&gt;1&lt;/threadcount&gt;  
     &lt;keepgoing&gt;false&lt;/keepgoing&gt; 
   &lt;/dispatch&gt; 
  &lt;/job&gt;
&lt;/joblist&gt;
</code
      ></pre
    ><p
    >Defines Job, /anvils/web/start, that also executes a shell script to Nodes tagged &quot;web&quot;.</p
    ><p
    >File listing: restart.xml</p
    ><pre
    ><code
      >&lt;joblist&gt;   
   &lt;job&gt; 
     &lt;name&gt;Restart&lt;/name&gt;  
     &lt;description&gt;restart the web server&lt;/description&gt;  
     &lt;loglevel&gt;INFO&lt;/loglevel&gt;  
     &lt;group&gt;anvils/web&lt;/group&gt;  
     &lt;context&gt; 
       &lt;project&gt;anvils&lt;/project&gt;  
         &lt;options&gt; 
           &lt;option name=&quot;method&quot; enforcedvalues=&quot;true&quot; required=&quot;false&quot; 
          values=&quot;normal,kill&quot; /&gt; 
        &lt;/options&gt; 
     &lt;/context&gt;  
     &lt;sequence threadcount=&quot;1&quot; keepgoing=&quot;false&quot; strategy=&quot;node-first&quot;&gt; 
      &lt;command&gt; 
        &lt;jobref name=&quot;stop&quot; group=&quot;anvils/web&quot;&gt;
          &lt;arg line=&quot;-method ${option.method}&quot;/&gt; 
        &lt;/jobref&gt; 
      &lt;/command&gt;  
      &lt;command&gt; 
        &lt;jobref name=&quot;start&quot; group=&quot;anvils/web&quot;&gt;
        &lt;/jobref&gt; 
      &lt;/command&gt; 
    &lt;/sequence&gt;
   &lt;/job&gt;   
&lt;/joblist&gt;
</code
      ></pre
    ><p
    >Defines Job, /anvils/web/Restart, that executes a sequence of Job calls, using the <code
      >jobref</code
      > tag.</p
    ><p
    >Note that we don't define a <code
      >&lt;nodefilters&gt;</code
      > or <code
      >&lt;dispatch&gt;</code
      > section, because we only want this sequence to execute <strong
      >once</strong
      >, on the server node. The Job references will each be called once, and the &quot;start&quot; and &quot;stop&quot; Jobs will each be dispatched to the nodes they define.</p
    ><p
    >Saving the XML definitions files located on the RunDeck server, one can load them using the <a href="rd-jobs.html"
      >rd-jobs</a
      > command.</p
    ><p
    >Run the <code
      >rd-jobs load</code
      > command for each job definition file:</p
    ><pre
    ><code
      >rd-jobs load -f start.xml
rd-jobs load -f stop.xml
rd-jobs load -f restart.xml
</code
      ></pre
    ><p
    >The <code
      >rd-jobs list</code
      > command queries RunDeck and prints out the list of defined jobs:</p
    ><pre
    ><code
      >rd-jobs list -p anvils
Found 3 jobs:
- Restart - 'the web restart procedure'
- start - 'the web start procedure'
- stop - 'the web stop procedure'
</code
      ></pre
    ><p
    >Of course, the jobs can be viewed inside the RunDeck graphical console by going to the Jobs page. Hovering over the &quot;Restart&quot; job name reveals job detail.</p
    ><div class="figure"
    ><img src="figures/fig0607.png" alt="Anvils restart jobs"
       /><p class="caption"
      >Anvils restart jobs</p
      ></div
    ><p
    >You will see the composition of the &quot;Restart&quot; job as a workflow calling the jobs: stop and start. The &quot;Restart&quot; job passes the <code
      >-method</code
      > option value to the lower level stop Job.</p
    ></div
  ><div id="running-the-job"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.7</span
	> Running the job</a
      ></h2
    ><p
    >The Jobs can be run from the RunDeck graphical console by going to the &quot;Jobs&quot; page. From there, navigate to the &quot;Anvils/web&quot; job group to display the three stored Jobs.</p
    ><p
    >Clicking the &quot;Run&quot; button for the Restart job, will display the options selection page. The menu for the &quot;method&quot; option displays the two choices: &quot;normal&quot; and &quot;kill&quot;. No other choices can be made, nor a textfield for free form entry, because the &quot;method&quot; option was defined with the restriction &quot;enforced from allowed values&quot;.</p
    ><div class="figure"
    ><img src="figures/fig0608.png" alt="Restart run page"
       /><p class="caption"
      >Restart run page</p
      ></div
    ><p
    >The jobs can also be started from the command line using the <a href="run.html"
      >run</a
      > shell tool. The job group and name are specified using the &quot;-j&quot; parameter. Any options the Job supports are supplied after the &quot;--&quot; (double dash) parameter. (The &quot;-p&quot; parameter specifies the project, but it can be left out if there is only one project available.)</p
    ><p
    >Run Restart specifying the method, &quot;normal&quot;:</p
    ><pre
    ><code
      >run -j &quot;anvils/web/Restart&quot; -p anvils -- -method normal
</code
      ></pre
    ><p
    >Run Restart specifying the method, &quot;kill&quot;:</p
    ><pre
    ><code
      >run -j &quot;anvils/web/Restart&quot; -p anvils -- -method kill
</code
      ></pre
    ></div
  ><div id="job-access-control"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.8</span
	> Job access control</a
      ></h2
    ><p
    >Access to running or modifying Jobs is managed in an access control policy defined using the aclpolicy document format (<a href="aclpolicy-v10.html"
      >aclpolicy-v10(5)</a
      >). This file contains a number of policy elements that describe what user group is allowed to perform which actions. The <a href="#authorization"
      >Authorization</a
      > section of the Administration chapter covers this in detail.</p
    ><p
    >The administrator wants to use the aclpolicy to define two levels of access. The first level, has limited privilege and allows for just running jobs. The second level, is administrative and can modify job definitions.</p
    ><p
    >Policies can be organized into more than one file to help organize access by group or pattern of use. The normal RunDeck install will define two user groups: &quot;admin&quot; and &quot;user&quot; and have a generated a policy for the &quot;admin&quot; group.</p
    ><p
    >The Acme administrator decides to create a policy that allows users in the &quot;user&quot; group to run commands just in the &quot;anvils&quot; and &quot;anvils/web&quot; Job groups. We can employ the &quot;user&quot; login and group as it was also included in the normal install.</p
    ><p
    >To create the aclpolicy file for the &quot;user&quot; group:</p
    ><pre
    ><code
      >cp $RDECK_BASE/etc/admin.aclpolicy $RDECK_BASE/etc/user.aclpolicy
</code
      ></pre
    ><p
    >Modify the <command> and <group> elements as shown in the example below. Notice that just workflow_read,workflow_run actions are allowed.</p
    ><pre class="sourceCode xml"
    ><code
      ><span class="Normal NormalText"
	>$ cat $RDECK_BASE/etc/user.aclpolicy</span
	><br
	 /><span class="Keyword Element"
	>&lt;policies&gt;</span
	><br
	 /><span class="Normal NormalText"
	>  </span
	><span class="Keyword Element"
	>&lt;policy</span
	><span class="Others Attribute"
	> description=</span
	><span class="String Value"
	>&quot;User group access policy.&quot;</span
	><span class="Keyword Element"
	>&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;context</span
	><span class="Others Attribute"
	> project=</span
	><span class="String Value"
	>&quot;*&quot;</span
	><span class="Keyword Element"
	>&gt;</span
	><br
	 /><span class="Normal NormalText"
	>      </span
	><span class="Keyword Element"
	>&lt;command</span
	><span class="Others Attribute"
	> group=</span
	><span class="String Value"
	>&quot;anvils&quot;</span
	><span class="Others Attribute"
	> job=</span
	><span class="String Value"
	>&quot;*&quot;</span
	><span class="Others Attribute"
	> actions=</span
	><span class="String Value"
	>&quot;workflow_read,workflow_run&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>      </span
	><span class="Keyword Element"
	>&lt;command</span
	><span class="Others Attribute"
	> group=</span
	><span class="String Value"
	>&quot;anvils/web&quot;</span
	><span class="Others Attribute"
	> job=</span
	><span class="String Value"
	>&quot;*&quot;</span
	><span class="Others Attribute"
	> actions=</span
	><span class="String Value"
	>&quot;workflow_read,workflow_run&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;/context&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;by&gt;</span
	><br
	 /><span class="Normal NormalText"
	>      </span
	><span class="Keyword Element"
	>&lt;group</span
	><span class="Others Attribute"
	> name=</span
	><span class="String Value"
	>&quot;user&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;/by&gt;</span
	><br
	 /><span class="Normal NormalText"
	>  </span
	><span class="Keyword Element"
	>&lt;/policy&gt;</span
	><br
	 /><span class="Keyword Element"
	>&lt;/policies&gt;</span
	><br
	 /></code
      ></pre
    ><p
    >Restart RunDeck to load the new policy file (see <a href="#startup-and-shutdown"
      >startup and shutdown</a
      >).</p
    ><pre
    ><code
      >rundeckd restart
</code
      ></pre
    ><p
    >Once the RunDeck webapp has started, login as the &quot;user&quot; user (the password is probably &quot;user&quot;). Just the Jobs in the &quot;anvils&quot; group are displayed in the Jobs page. The &quot;user&quot; user does is not allowed to access jobs outside of &quot;/anvils group.</p
    ><p
    >Notice the absence of the &quot;New Job&quot; button that would be displayed if logged in as &quot;admin&quot;. Job creation is an action not granted to &quot;user&quot;. Notice also, that the button bar for the listed Jobs does not include icons for editing or deleting the Job. Only workflow_read and workflow_actions were allowed in the <code
      >user.aclpolicy</code
      > file.</p
    ></div
  ><div id="resource-model-source-examples"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.9</span
	> Resource model source examples</a
      ></h2
    ><p
    >See <a href="#resource-model-source"
      >Chapter 9 - Resource Model Source</a
      >.</p
    ></div
  ><div id="resource-editor-examples"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.10</span
	> Resource editor examples</a
      ></h2
    ><p
    >See <a href="#resource-editor"
      >Chapter 9 - Resource Editor</a
      >.</p
    ></div
  ><div id="option-model-provider-examples"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.11</span
	> Option model provider examples</a
      ></h2
    ><p
    >See <a href="#option-model-provider"
      >Chapter 9 - Option Model Provider</a
      >.</p
    ></div
  ></div
><div id="administration"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >8</span
      > Administration</a
    ></h1
  ><div id="startup-and-shutdown"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.1</span
	> Startup and shutdown</a
      ></h2
    ><p
    >RunDeck installation includes a control script used for starting and stopping the RunDeck server process. The control script provides a number of actions:</p
    ><pre
    ><code
      >rundeckd [start|stop|restart|condrestart|status]
</code
      ></pre
    ><div id="rpm"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.1.1</span
	  > RPM</a
	></h3
      ><p
      >The RPM installation includes the placement of the boot control script that will automatically start RunDeck when the system boots.</p
      ><p
      >The script is located here: <code
	>/etc/init.d/rundeckd</code
	></p
      ><p
      ><em
	>Startup</em
	></p
      ><pre
      ><code
	>/etc/init.d/rundeckd start
</code
	></pre
      ><p
      ><em
	>Shutdown</em
	></p
      ><pre
      ><code
	>/etc/initd./rundeckd stop
</code
	></pre
      ><div id="setting-java_home"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.1.1.1</span
	    > Setting JAVA_HOME</a
	  ></h4
	><p
	>When using the RPM, by default rundeck will use <em
	  >java</em
	  > found in your path. Various RPM based distributions provide ways of managing which version of java is found. CentOS uses <em
	  >/usr/sbin/alternatives</em
	  > and the processing of setting alternatives can be found here: <a href="http://wiki.centos.org/HowTos/JavaOnCentO"
	  >http://wiki.centos.org/HowTos/JavaOnCentOS</a
	  >.</p
	><p
	>If you have installed a JDK or JRE in a unique directory and do not want to alter the global system configuration, then simply setting JAVA_HOME before running any command will use the version of java found in JAVA_HOME/bin. Updating /etc/rundeck/profile with JAVA_HOME is another option as well.</p
	></div
      ></div
    ><div id="launcher"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.1.2</span
	  > Launcher</a
	></h3
      ><p
      >The Launcher installation generates the script into the RDECK_BASE directory.</p
      ><p
      >The script is located here: <code
	>$RDECK_BASE/server/sbin/rundeckd</code
	>.</p
      ><p
      ><em
	>Startup</em
	></p
      ><pre
      ><code
	>$RDECK_BASE/server/sbin/rundeckd start
</code
	></pre
      ><p
      ><em
	>Shutdown</em
	></p
      ><pre
      ><code
	>$RDECK_BASE/server/sbin/rundeckd stop
</code
	></pre
      ><p
      >You may choose to incorporate this script into your server's operating system specific boot process.</p
      ></div
    ></div
  ><div id="configuration"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.2</span
	> Configuration</a
      ></h2
    ><div id="configuration-layout"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.2.1</span
	  > Configuration layout</a
	></h3
      ><p
      >Configuration file layout differs between the RPM and Launcher installation methods. See <a href="#rpm-layout"
	>RPM layout</a
	> and <a href="#launcher-layout"
	>Launcher layout</a
	> for details.</p
      ><div id="rpm-layout"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.1.1</span
	    > RPM layout</a
	  ></h4
	><pre
	><code
	  >/etc/rundeck
|-- admin.aclpolicy
|-- framework.properties
|-- log4j.properties
|-- profile
|-- project.properties
|-- jaas-loginmodule.conf
|-- log4j.properties
|-- realm.properties
|-- rundeck-config.properties
`-- ssl
    |-- ssl.properties
    |-- keystore (not packaged)
    `-- truststore (not packaged)
</code
	  ></pre
	></div
      ><div id="launcher-layout"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.1.2</span
	    > Launcher layout</a
	  ></h4
	><pre
	><code
	  >$RDECK_BASE/etc
|-- admin.aclpolicy
|-- framework.properties
|-- log4j.properties
|-- profile
`-- project.properties
$RDECK_BASE/server/config
|-- jaas-loginmodule.conf
|-- realm.properties
`-- rundeck-config.properties
</code
	  ></pre
	></div
      ></div
    ><div id="configuration-files"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.2.2</span
	  > Configuration files</a
	></h3
      ><p
      >Configuration is specified in a number of standard RunDeck configuration files generated during the installation process.</p
      ><p
      >See the <a href="#configuration-layout"
	>Configuration layout</a
	> section for where these files reside for RPM and Launcher installations.</p
      ><p
      >The purpose of each configuration file is described in its own section.</p
      ><div id="admin.aclpolicy"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.1</span
	    > admin.aclpolicy</a
	  ></h4
	><p
	>Administrator access control policy defined with a &quot;aclpolicy(5)&quot; XML document.</p
	><p
	>This file governs the access for the &quot;admin&quot; group and role.</p
	><p
	>See <a href="#authorization"
	  >Authorization</a
	  > for information about setting up policy files for other user groups.</p
	></div
      ><div id="framework.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.2</span
	    > framework.properties</a
	  ></h4
	><p
	>Configuration file used by shell tools and core RunDeck services. This file will be created for you at install time.</p
	><p
	>Some important settings:</p
	><ul
	><li
	  ><code
	    >framework.node.hostname</code
	    >: Hostname of the RunDeck server node</li
	  ><li
	  ><code
	    >framework.node.name</code
	    >: Name (identity) of the RunDeck server node</li
	  ><li
	  ><code
	    >framework.projects.dir</code
	    >: Path to the directory containing RunDeck Project directories. Default is <code
	    >$RDECK_BASE/projects</code
	    >.</li
	  ><li
	  ><code
	    >framework.var.dir</code
	    >: Base directory for output and temp files used by the server and CLI tools. Default is <code
	    >$RDECK_BASE/var</code
	    >.</li
	  ><li
	  ><code
	    >framework.logs.dir</code
	    >: Directory for log files written by core services and RunDeck Server's Job executions. Default is <code
	    >$RDECK_BASE/var/logs</code
	    ></li
	  ><li
	  ><code
	    >framework.server.username</code
	    >: Username for connection to the RunDeck server</li
	  ><li
	  ><code
	    >framework.server.password</code
	    >: Password for connection to the RunDeck server</li
	  ><li
	  ><code
	    >framework.rundeck.url</code
	    >: Base URL for RunDeck server.</li
	  ></ul
	><p
	>Resource Provider settings:</p
	><ul
	><li
	  ><code
	    >framework.resources.allowedURL.X</code
	    >: a sequence of regular expressions (for <code
	    >X</code
	    > starting at 0 and increasing). These are matched against requested providerURL values when the <code
	    >/project/name/resources/refresh</code
	    > API endpoint is called. See <a href="api/index.html#refreshing-resources-for-a-project"
	    >Refreshing Resources for a Project</a
	    >.</li
	  ></ul
	><p
	>SSH Connection settings:</p
	><ul
	><li
	  ><code
	    >framework.ssh.keypath</code
	    >: Path to the SSH private key file used for SSH connections</li
	  ><li
	  ><code
	    >framework.ssh.user</code
	    >: Default username for SSH Connections, if not overridden by Node specific value.</li
	  ><li
	  ><code
	    >framework.ssh.timeout</code
	    >: timeout in milliseconds for SSH connections and executions. The default is &quot;0&quot; (no timeout). You can modify this to change the maximum time allowed for SSH connections.</li
	  ></ul
	><p
	>Other settings:</p
	><ul
	><li
	  ><code
	    >framework.log.dispatch.console.format</code
	    >: Default format for non-terse node execution logging run by the <code
	    >dispatch</code
	    > CLI tool.</li
	  ></ul
	></div
      ><div id="log4j.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.3</span
	    > log4j.properties</a
	  ></h4
	><p
	>RunDeck uses <a href="http://logging.apache.org/log4j/"
	  >log4j</a
	  > as its application logging facility. This file defines the logging configuration for the RunDeck server.</p
	></div
      ><div id="profile"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.4</span
	    > profile</a
	  ></h4
	><p
	>Shell environment variables used by the shell tools. This file contains several parameters needed during the startup of the shell tools like umask, Java home and classpath, and SSL options.</p
	></div
      ><div id="project.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.5</span
	    > project.properties</a
	  ></h4
	><p
	>RunDeck <a href="#project"
	  >project</a
	  > configuration file. One of these is generated at project setup time.</p
	><table
	><thead
	  ><tr class="header"
	    ><th align="left"
	      >Property</th
	      ><th align="left"
	      >Description</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>project.resources.file</code
		></td
	      ><td align="left"
	      >A local file path to read a resource model document</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>project.resources.url</code
		></td
	      ><td align="left"
	      >The URL to an external <a href="#resource-model-source"
		>Resource Model Source</a
		>.(Optional)</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>project.resources.allowedURL.X</code
		></td
	      ><td align="left"
	      >A sequence of regular expressions (for <code
		>X</code
		> starting at 0 and increasing).</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>resources.source.N...</code
		></td
	      ><td align="left"
	      >Defines a Resource model source see <a href="#resource-model-sources"
		>Resource Model Sources</a
		>.</td
	      ></tr
	    ></tbody
	  ></table
	><p
	>The <code
	  >project.resources.allowedURL.X</code
	  > values are matched against requested providerURL values when the <code
	  >/project/name/resources/refresh</code
	  > API endpoint is called. See <a href="api/index.html#refreshing-resources-for-a-project"
	  >Refreshing Resources for a Project</a
	  >.</p
	></div
      ><div id="jaas-loginmodule.conf"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.6</span
	    > jaas-loginmodule.conf</a
	  ></h4
	><p
	><a href="http://docs.codehaus.org/display/JETTY/JAAS"
	  >JAAS</a
	  > configuration for the RunDeck server. The listing below shows the file content for a normal RPM installation. One can see it specifies the use of the <a href="http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/plus/jaas/spi/PropertyFileLoginModule.html"
	  >PropertyFileLoginModule</a
	  >:</p
	><pre
	><code
	  >RDpropertyfilelogin {
  org.mortbay.jetty.plus.jaas.spi.PropertyFileLoginModule required
  debug=&quot;true&quot;
  file=&quot;/etc/rundeck/realm.properties&quot;;
};
</code
	  ></pre
	></div
      ><div id="realm.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.7</span
	    > realm.properties</a
	  ></h4
	><p
	>Property file user directory when PropertyFileLoginModule is used. Specified from <a href="#jaas-loginmodule.conf"
	  >jaas-loginmodule.conf</a
	  >.</p
	></div
      ><div id="rundeck-config.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.8</span
	    > rundeck-config.properties</a
	  ></h4
	><p
	>The primary RunDeck webapp configuration file. Defines default loglevel, datasource configuration, <a href="#role-mapping"
	  >role mapping</a
	  >, and <a href="#customizing-rundeck-gui"
	  >GUI customization</a
	  >.</p
	><div id="notification-email-settings"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >8.2.2.8.1</span
	      > Notification email settings</a
	    ></h5
	  ><p
	  >The URL and From: address used in email notifications are managed via the settings located in the rundeck-config.properties file.</p
	  ><p
	  >The two properties are:</p
	  ><ul
	  ><li
	    >grails.serverURL</li
	    ><li
	    >grails.mail.default.from</li
	    ></ul
	  ><p
	  >Here's an example:</p
	  ><pre
	  ><code
	    >grails.serverURL=https://node.fully.qualified.domain.name:4443
grails.mail.default.from=deployer@domain.com
</code
	    ></pre
	  ></div
	></div
      ></div
    ><div id="gui-admin-page"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.2.3</span
	  > GUI Admin Page</a
	></h3
      ><p
      >The RunDeck GUI has an Admin Page which contains lets you view and manage some configuration options. If you have <code
	>admin</code
	> role access, when you log in you will see an &quot;Admin&quot; link in the header of the page near your username:</p
      ><div class="figure"
      ><img src="figures/fig0701.png" alt="Admin page link"
	 /><p class="caption"
	>Admin page link</p
	></div
      ><p
      >Clicking on this link will take you to the Admin Page:</p
      ><div class="figure"
      ><img src="figures/fig0702.png" alt="Admin page"
	 /><p class="caption"
	>Admin page</p
	></div
      ><p
      >This page contains links to two sub-pages, and configuration information about the currently selected Project.</p
      ><div id="system-information-page"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.3.1</span
	    > System Information Page</a
	  ></h4
	><p
	>The System Information page gives you a breakdown of some of the RunDeck server's system statistics and information:</p
	><div class="figure"
	><img src="figures/fig0703.png" alt="System Info Page"
	   /><p class="caption"
	  >System Info Page</p
	  ></div
	><p
	>This information is also available via the API: <a href="api/index.html#system-info"
	  >API &gt; System Info</a
	  ></p
	></div
      ><div id="user-profiles-page"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.3.2</span
	    > User Profiles Page</a
	  ></h4
	><p
	>The User Profiles page lists all User Profile records in the system. User Profiles are used to store some user preferences, and can be used to generate API Tokens for admin users.</p
	><div class="figure"
	><img src="figures/fig0704.png" alt="User Profiles Page"
	   /><p class="caption"
	  >User Profiles Page</p
	  ></div
	></div
      ><div id="project-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.3.3</span
	    > Project Configuration</a
	  ></h4
	><p
	>The selected project will be displayed with basic configuration options, and the list of configure Resource Model Sources, as well as the default Node Executor and File Copier settings.</p
	><p
	>If you click on &quot;Configure Project&quot;, you will be taken to the Project Configuration form.</p
	><div class="figure"
	><img src="figures/fig0705.png" alt="Project Configuration Form"
	   /><p class="caption"
	  >Project Configuration Form</p
	  ></div
	><p
	>The first two fields allow configuration of some simple project basics.</p
	><p
	>First, you can enter a URL for a Resource Model Source, which will be used as a URL Resource Model Source with default configuration options.</p
	><p
	>Secondly, you can enter the Default SSH Key File, which is the private SSH Key file used by default for SSH and SCP actions. If you are not using SSH or SCP you do not have to enter one.</p
	><p
	>There are then several more sections: Resource Model Sources, Default Node Executor, and Default File Copier sections. These are described below:</p
	></div
      ><div id="resource-model-sources-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.3.4</span
	    > Resource Model Sources Configuration</a
	  ></h4
	><p
	>This section lets you add and modify <a href="#resource-model-sources"
	  >Resource Model Sources</a
	  > for the project.</p
	><p
	>To add a new one, click &quot;Add Source&quot;. You are prompted to select a type of source. The list shown will include all of the built-in types of sources, as well as any Plugins you have installed.</p
	><div class="figure"
	><img src="figures/fig0706.png" alt="Add Resource Model Source"
	   /><p class="caption"
	  >Add Resource Model Source</p
	  ></div
	><p
	>When you click &quot;Add&quot; for a type, you will be shown the configuration options for the type.</p
	><div class="figure"
	><img src="figures/fig0707.png" alt="Configure Resource Model Source"
	   /><p class="caption"
	  >Configure Resource Model Source</p
	  ></div
	><p
	>You can then click &quot;Cancel&quot; or &quot;Save&quot; to discard or add the configuration to the list.</p
	><p
	>Each item you add will be shown in the list:</p
	><div class="figure"
	><img src="figures/fig0708.png" alt="Configured Source"
	   /><p class="caption"
	  >Configured Source</p
	  ></div
	><p
	>To edit an item in the list click the &quot;Edit&quot; button. To delete an item in the list click the &quot;Delete&quot; button.</p
	><p
	>Each type of Resource Model Source will have different configuration settings of its own. The built-in Resource Model Source providers are shown below.</p
	><p
	>You can install more sources as plugins, see <a href="#resource-model-source-plugins"
	  >Resource Model Source Plugins</a
	  >.</p
	><div id="file-resource-model-source"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >8.2.3.4.1</span
	      > File Resource Model Source</a
	    ></h5
	  ><p
	  >This is the File Resource Model Source configuration form:</p
	  ><div class="figure"
	  ><img src="figures/fig0707.png" alt="File Resource Model Source"
	     /><p class="caption"
	    >File Resource Model Source</p
	    ></div
	  ><p
	  >See <a href="#file-resource-model-source-configuration"
	    >File Resource Model Source Configuration</a
	    > for more configuration information.</p
	  ></div
	><div id="directory-resource-model-source"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >8.2.3.4.2</span
	      > Directory Resource Model Source</a
	    ></h5
	  ><p
	  >Allows a directory to be scanned for resource document files. All files with an extension supported by one of the <a href="#resource-model-document-formats"
	    >Resource Model Document Formats</a
	    > are included.</p
	  ><div class="figure"
	  ><img src="figures/fig0709.png" alt="Directory Resource Model Source"
	     /><p class="caption"
	    >Directory Resource Model Source</p
	    ></div
	  ><p
	  >See <a href="#directory-resource-model-source-configuration"
	    >Directory Resource Model Source Configuration</a
	    > for more configuration information.</p
	  ></div
	><div id="script-resource-model-source"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >8.2.3.4.3</span
	      > Script Resource Model Source</a
	    ></h5
	  ><p
	  >This source can run an external script to produce the resource model definitions.</p
	  ><div class="figure"
	  ><img src="figures/fig0710.png" alt="Script Resource Model Source"
	     /><p class="caption"
	    >Script Resource Model Source</p
	    ></div
	  ><p
	  >See <a href="#script-resource-model-source-configuration"
	    >Script Resource Model Source Configuration</a
	    > for more configuration information.</p
	  ></div
	><div id="url-resource-model-source"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >8.2.3.4.4</span
	      > URL Resource Model Source</a
	    ></h5
	  ><p
	  >This source performs a HTTP GET request on a URL to return the resource definitions.</p
	  ><div class="figure"
	  ><img src="figures/fig0711.png" alt="URL Resource Model Source"
	     /><p class="caption"
	    >URL Resource Model Source</p
	    ></div
	  ><p
	  >See <a href="#url-resource-model-source-configuration"
	    >URL Resource Model Source Configuration</a
	    > for more configuration information.</p
	  ></div
	></div
      ><div id="default-node-executor-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.3.5</span
	    > Default Node Executor Configuration</a
	  ></h4
	><p
	>When RunDeck executes a command on a node, it does so via a &quot;Node Executor&quot;. The most common built-in Node Executor is the &quot;SSH&quot; implementation, which uses SSH to connect to the remote node, however other implementations can be used.</p
	><p
	>Select the Default Node Executor you wish to use for all remote Nodes for the project:</p
	><div class="figure"
	><img src="figures/fig0712.png" alt="Default Node Executor Choice"
	   /><p class="caption"
	  >Default Node Executor Choice</p
	  ></div
	><p
	>You can install more types of Node Executors as plugins, see <a href="#node-execution-plugins"
	  >Node Execution Plugins</a
	  >.</p
	></div
      ><div id="default-file-copier-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.3.6</span
	    > Default File Copier Configuration</a
	  ></h4
	><p
	>When RunDeck executes a script on a node, it does so by first copying the script as a file to the node, via a &quot;File Copier&quot;. (It then uses a &quot;Node Executor&quot; to execute the script like a command.)</p
	><p
	>The most common built-in File Copier is the &quot;SCP&quot; implementation, which uses SCP to copy the file to the remote node, however other implementations can be used.</p
	><p
	>Select the Default File Copier you wish to use for all remote Nodes for the project:</p
	><div class="figure"
	><img src="figures/fig0713.png" alt="Default File Copier Choice"
	   /><p class="caption"
	  >Default File Copier Choice</p
	  ></div
	><p
	>You can install more types of File Copiers as plugins, see <a href="#node-execution-plugins"
	  >Node Execution Plugins</a
	  >.</p
	></div
      ></div
    ></div
  ><div id="logs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.3</span
	> Logs</a
      ></h2
    ><p
    >Depending on the installer used, the log files will be under a base directory:</p
    ><ul
    ><li
      >RPM: <code
	>/var/log/rundeck</code
	></li
      ><li
      >Launcher: <code
	>$RDECK_BASE/server/logs</code
	></li
      ></ul
    ><p
    >The following files will be found in the log directory:</p
    ><pre
    ><code
      > .
 |-- command.log
 |-- rundeck.audit.log
 |-- rundeck.jobs.log
 |-- rundeck.options.log
 |-- rundeck.log
 `-- service.log
</code
      ></pre
    ><p
    >Different facilities log to their own files:</p
    ><ul
    ><li
      ><code
	>command.log</code
	>: Shell tools log their activity to the command.log</li
      ><li
      ><code
	>rundeck.audit.log</code
	>: Authorization messages pertaining to aclpolicy</li
      ><li
      ><code
	>rundeck.job.log</code
	>: Log of all job definition changes</li
      ><li
      ><code
	>rundeck.options.log</code
	>: Logs remote HTTP requests for Options JSON data</li
      ><li
      ><code
	>rundeck.log</code
	>: General RunDeck application messages</li
      ><li
      ><code
	>service.log</code
	>: Standard input and output generated during runtime</li
      ></ul
    ><p
    >See the <a href="#log4j.properties"
      >#log4j.properties</a
      > section for information about customizing log message formats and location.</p
    ></div
  ><div id="backup-and-recovery"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.4</span
	> Backup and recovery</a
      ></h2
    ><p
    >While running, export the Job definitions if you do not have these in source control:</p
    ><ol style="list-style-type: decimal;"
    ><li
      ><p
	>Export the jobs. You will have to do this for each project</p
	><pre
	><code
	  >rd-jobs list -f /path/to/backup/dir/project1/jobs.xml -p project1
rd-jobs list -f /path/to/backup/dir/project2/jobs.xml -p project2
...
</code
	  ></pre
	></li
      ><li
      ><p
	>Stop the server. See: <a href="#startup-and-shtudown"
	  >startup and shutdown</a
	  >. (RunDeck data file backup should only be done with the server down.)</p
	><pre
	><code
	  >rundeckd stop
</code
	  ></pre
	></li
      ><li
      ><p
	>Copy the data files. (Assumes file datastore configuration). The location of the data directory depends on the installation method:</p
	><ul
	><li
	  >RPM install: <code
	    >/var/lib/rundeck/data</code
	    ></li
	  ><li
	  ><p
	    >Launcher install: <code
	      >$RDECK_BASE/server/data</code
	      ></p
	    ><pre
	    ><code
	      >cp -r data /path/to/backup/dir
</code
	      ></pre
	    ></li
	  ></ul
	></li
      ><li
      ><p
	>Copy the log (execution output) files.</p
	><ul
	><li
	  >RPM install: <code
	    >/var/lib/rundeck/logs</code
	    ></li
	  ><li
	  ><p
	    >Launcher install: <code
	      >$RDECK_BASE/var/logs</code
	      ></p
	    ><pre
	    ><code
	      >cp -r logs /path/to/backup/dir
</code
	      ></pre
	    ></li
	  ></ul
	></li
      ><li
      ><p
	>Start the server</p
	><pre
	><code
	  > rundeckd start
</code
	  ></pre
	></li
      ></ol
    ><div id="recovery"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.4.1</span
	  > Recovery</a
	></h3
      ><ol style="list-style-type: decimal;"
      ><li
	><p
	  >Stop the server. See: <a href="#startup-and-shtudown"
	    >startup and shutdown</a
	    >. (RunDeck recovery should only be done with the server down.)</p
	  ><pre
	  ><code
	    >rundeckd stop
</code
	    ></pre
	  ></li
	><li
	><p
	  >Restore data/logs dir from backup (Refer to above for appropriate log/data path):</p
	  ><pre
	  ><code
	    >cp -r /path/to/backup/logs logspath
cp -r /path/to/backup/data datapath
</code
	    ></pre
	  ></li
	><li
	><p
	  >Start the server:</p
	  ><pre
	  ><code
	    >rundeckd start
</code
	    ></pre
	  ></li
	><li
	><p
	  >Reload the Job definitions. You will have to do this for each project:</p
	  ><pre
	  ><code
	    >rd-jobs load -f /path/to/backup/dir/project1/jobs.xml -p project1
rd-jobs load -f /path/to/backup/dir/project2/jobs.xml -p project2
</code
	    ></pre
	  ></li
	></ol
      ></div
    ></div
  ><div id="relational-database"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.5</span
	> Relational Database</a
      ></h2
    ><p
    >You can configure RunDeck to use a RDB instead of the default file-based data storage.</p
    ><p
    >You must modify the <code
      >server/config/rundeck-config.properties</code
      > file, to change the <code
      >dataSource</code
      > configuration, and you will have to add the appropriate JDBC driver JAR file to the lib directory.</p
    ><div id="enable-rdbsupport"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.5.1</span
	  > Enable rdbsupport</a
	></h3
      ><p
      >First, you <strong
	>must</strong
	> enable the <code
	>rundeck.v14.rdbsupport</code
	> property:</p
      ><pre
      ><code
	>#note, make sure this is set to &quot;true&quot; if you are using Oracle or Mysql
rundeck.v14.rdbsupport=true
</code
	></pre
      ><p
      >This makes RunDeck use table/field names that are compatible with Oracle/Mysql.</p
      ><p
      >Note: It is safe to set this to true if you are using the default file based backend, but only for a fresh install. It will cause a problem if you set it to true for an existing Rundeck 1.3 HSQLDB database. Make sure it is set to &quot;false&quot; or is absent from your config file if you are upgrading from Rundeck 1.3 and using the filesystem storage.</p
      ></div
    ><div id="customize-the-datasource"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.5.2</span
	  > Customize the Datasource</a
	></h3
      ><p
      >The default dataSource is configured for filesystem storage using HSQLDB:</p
      ><pre
      ><code
	>dataSource.url = jdbc:hsqldb:file:/var/lib/rundeck/data/grailsdb;shutdown=true
</code
	></pre
      ><p
      >Here is an example configuration to use an Oracle backend:</p
      ><pre
      ><code
	>dataSource.url = jdbc:oracle:thin:@localhost:1521:XE
dataSource.driverClassName = oracle.jdbc.driver.OracleDriver
dataSource.username = dbuser
dataSource.password = dbpass
dataSource.dialect = org.hibernate.dialect.Oracle10gDialect
</code
	></pre
      ><p
      >Here is an example configuration to use Mysql:</p
      ><pre
      ><code
	>dataSource.url = jdbc:mysql://myserver/rundeckdb
dataSource.username = dbuser
dataSource.password = dbpass
</code
	></pre
      ></div
    ><div id="add-the-jdbc-driver"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.5.3</span
	  > Add the JDBC Driver</a
	></h3
      ><p
      >Copy the appropriate JDBC driver, such as &quot;ojdbc14.jar&quot; for Oracle into the server <code
	>lib</code
	> dir:</p
      ><pre
      ><code
	>cp ojdbc14.jar $RDECK_BASE/server/lib
</code
	></pre
      ><p
      >Or:</p
      ><pre
      ><code
	>cp mysql-connector-java-5.1.17-bin.jar $RDECK_BASE/server/lib
</code
	></pre
      ></div
    ></div
  ><div id="ssh"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.6</span
	> SSH</a
      ></h2
    ><p
    >RunDeck by default uses <a href="http://en.wikipedia.org/wiki/Secure_Shell"
      >SSH</a
      > for remote execution. You do <em
      >not</em
      > need to have root account access on either the server or the remote hosts.</p
    ><p
    >See more about settings up Nodes and Jobs for SSH execution in the section about built-in providers: <a href="#ssh-provider"
      >SSH Provider</a
      >.</p
    ><div id="ssh-configuration-requirements"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.6.1</span
	  > SSH configuration requirements</a
	></h3
      ><ul
      ><li
	>The SSH configuration requires that the RunDeck server machine can ssh commands to the client machines.</li
	><li
	>SSH is assumed to be installed and configured appropriately to allow this access.<br
	   /></li
	><li
	>SSH can be configured for either <em
	  >password</em
	  > based authentication or <em
	  >public/private key</em
	  > based authentication.</li
	><li
	>For public/private key authentication:<ul
	  ><li
	    >No passphrase should be set on the private key.</li
	    ><li
	    >SSH should not prompt for a password. There are many resources available on how to configure ssh to use public key authentication instead of passwords such as: <a href="http://www.debian-administration.org/articles/152"
	      >Password-less logins with OpenSSH</a
	      > or <a href="http://www.cs.wustl.edu/~mdeters/how-to/ssh/"
	      >How-To: Password-less SSH</a
	      ></li
	    ></ul
	  ></li
	><li
	>For password authentication:<ul
	  ><li
	    >each Node definition must be configured to allow password authentication</li
	    ><li
	    >each Job definition that will use it must be configured correctly</li
	    ></ul
	  ></li
	></ul
      ></div
    ><div id="ssh-key-generation"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.6.2</span
	  > SSH key generation</a
	></h3
      ><ul
      ><li
	>The RunDeck installation can be configured to use RSA <em
	  >or</em
	  > DSA type keys.</li
	></ul
      ><p
      >Here's an example of SSH RSA key generation on a Linux system:</p
      ><pre
      ><code
	>$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/home/demo/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/demo/.ssh/id_rsa.
Your public key has been saved in /home/demo/.ssh/id_rsa.pub.
The key fingerprint is:
a7:31:01:ca:f0:62:42:9d:ab:c8:b7:9c:d1:80:76:c6 demo@ubuntu
The key's randomart image is:
+--[ RSA 2048]----+
| .o . .          |
|.  * . .         |
|. = =   .        |
| = E     .       |
|+ + o   S .      |
|.o o .   =       |
|  o +   .        |
|   +             |
|                 |
+-----------------+
</code
	></pre
      ></div
    ><div id="configuring-remote-machine-for-ssh"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.6.3</span
	  > Configuring remote machine for SSH</a
	></h3
      ><p
      >To be able to directly ssh to remote machines, the SSH public key of the client should be shared to the remote machine.</p
      ><p
      >Follow the steps given below to enable ssh to remote machines.</p
      ><p
      >The ssh public key should be copied to the <code
	>authorized_keys</code
	> file of the remote machine. The public key will be available in <code
	>~/.ssh/id_rsa.pub</code
	> file.</p
      ><p
      >The <code
	>authorized_keys</code
	> file should be created in the <code
	>.ssh</code
	> directory of the remote machine.</p
      ><p
      >The file permission of the authorized key should be read/write for the user and nothing for group and others. To do this check the permission and change it as shown below.</p
      ><pre
      ><code
	>$ cd ~/.ssh
$ ls -la
-rw-r--r--   1 raj  staff     0 Nov 22 18:14 authorized_keys

$ chmod 600 authorized_keys 
$ ls -la
-rw-------   1 raj  staff     0 Nov 22 18:14 authorized_keys
</code
	></pre
      ><p
      >The permission for the .ssh directory of the remote machine should be read/write/execute for the user and nothing for the group and others. To do this, check the permission and change it as shown below.</p
      ><pre
      ><code
	>$ ls -la
drwxr-xr-x   2 raj  staff    68 Nov 22 18:19 .ssh
$ chmod 700 .ssh
$ ls -la
drwx------   2 raj  staff    68 Nov 22 18:19 .ssh
</code
	></pre
      ><p
      >If you are running RunDeck on Windows, we heartily recommend using <a href="http://www.cygwin.org"
	>Cygwin</a
	> on Windows as it includes SSH and a number of Unix-like tools that are useful when you work in a command line environment.</p
      ></div
    ><div id="passing-environment-variables-through-remote-command"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.6.4</span
	  > Passing environment variables through remote command</a
	></h3
      ><p
      >To pass environment variables through remote command dispatches, it is required to properly configure the SSH server on the remote end. See the <code
	>AcceptEnv</code
	> directive in the &quot;sshd_config(5)&quot; manual page for instructions.</p
      ><p
      >Use a wild card pattern to permit <code
	>RD_</code
	> prefixed variables to provide open access to RunDeck generated environment variables.</p
      ></div
    ></div
  ><div id="managing-logins"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.7</span
	> Managing logins</a
      ></h2
    ><div id="realm.properties-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.7.1</span
	  > realm.properties</a
	></h3
      ><p
      >These instructions explain how to manage user credentials for RunDeck in the <code>realm.properties</code> file.</p
      ><p
      >The default RunDeck webapp handles user authentication via its container, which in turn is configured to pull its user authentication from the <code
	>$RDECK_BASE/server/config/realm.properties</code
	> file. This file is created at the time that you install the server.</p
      ><p
      >Assuming it wasn't modified, your realm.properties file will probably look something like this:</p
      ><pre
      ><code
	>#
# This file defines users passwords and roles for a HashUserRealm
#
# The format is
#  &lt;username&gt;: &lt;password&gt;[,&lt;rolename&gt; ...]
#
# Passwords may be clear text, obfuscated or checksummed.  
#
# This sets the default user accounts for the RunDeck apps
#
admin:admin,user,admin
user:user,user
</code
	></pre
      ><p
      ><em
	>Adding additional users</em
	></p
      ><p
      >You may wish to have additional users with various privileges rather than giving out role accounts to groups. You may also want to avoid having the passwords in plaintext within the configuration file.</p
      ><p
      >To accomplish this, you'll need a properly hashed or encrypted password to use in the config. On the RunDeck server, move into the directory that contains your installation and pass the username and password to the <code
	>Password</code
	> utility. In this example, we'll setup a new user named &quot;jsmith&quot;, with a password of &quot;mypass&quot;:</p
      ><pre
      ><code
	>$ cd $RDECK_BASE
$ java -cp server/lib/jetty-6.1.21.jar:server/lib/jetty-util-6.1.21.jar org.mortbay.jetty.security.Password jsmith mypass
OBF:1xfd1zt11uha1ugg1zsp1xfp
MD5:a029d0df84eb5549c641e04a9ef389e5
CRYPT:jsnDAc2Xk4W4o
</code
	></pre
      ><p
      >Then add this to the <code
	>realm.properties</code
	> file with a line like so:</p
      ><pre
      ><code
	>jsmith: MD5:a029d0df84eb5549c641e04a9ef389e5,user,admin
</code
	></pre
      ><p
      >Then restart RunDeck to ensure it picks up the change and you're done.</p
      ></div
    ><div id="active-directory"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.7.2</span
	  > Active Directory</a
	></h3
      ><p
      ><em
	>note</em
	> Because the underlying security mechanism relies on JAAS, you are free to use what ever JAAS provider you feel is suitable for your environment.</p
      ><ol style="list-style-type: decimal;"
      ><li
	><p
	  >Setup the LDAP login module configuration file</p
	  ><p
	  >Create a <code
	    >jaas-activedirectory.conf</code
	    > file in the same directory as the <code
	    >jaas-loginmodule.conf</code
	    > file.</p
	  ><ul
	  ><li
	    >RPM install: /etc/rundeck/</li
	    ><li
	    >Launcher install: $RDECK_BASE/server/config</li
	    ></ul
	  ><pre
	  ><code
	    >activedirectory {
    com.dtolabs.rundeck.jetty.jaas.JettyCachingLdapLoginModule required
    debug=&quot;true&quot;
    contextFactory=&quot;com.sun.jndi.ldap.LdapCtxFactory&quot;
    providerUrl=&quot;ldap://localhost:389&quot;
    bindDn=&quot;cn=Manager,dc=rundeck,dc=com&quot;
    bindPassword=&quot;secret&quot;
    authenticationMethod=&quot;simple&quot;
    forceBindingLogin=&quot;true&quot;
    userBaseDn=&quot;ou=users,dc=rundeck,dc=com&quot;
    userRdnAttribute=&quot;cn&quot;
    userIdAttribute=&quot;cn&quot;
    userPasswordAttribute=&quot;unicodePwd&quot;
    userObjectClass=&quot;user&quot;
    roleBaseDn=&quot;ou=roles,dc=rundeck,dc=com&quot;
    roleNameAttribute=&quot;cn&quot;
    roleMemberAttribute=&quot;member&quot;
    roleObjectClass=&quot;group&quot;
    cacheDurationMillis=&quot;300000&quot;
    reportStatistics=&quot;true&quot;;
    };
</code
	    ></pre
	  ></li
	></ol
      ><p
      ><strong
	>Note</strong
	>: The <code
	>bindDn</code
	> and <code
	>bindPassword</code
	> must escape any special characters with <code
	>\</code
	> character. Special characters include <code
	>\</code
	> (backslash), as well as <code
	>!</code
	> (exclamation).</p
      ><ol start="2" style="list-style-type: decimal;"
      ><li
	><p
	  >To override the default JAAS configuration file, you will need to supply the RunDeck server with the proper path to the new one, and a <code
	    >loginmodule.name</code
	    > Java system property to identify the new login module by name.</p
	  ><p
	  >The JAAS configuration file location is specified differently between the Launcher and the RPM.</p
	  ><p
	  ><strong
	    >For the Launcher</strong
	    >: the <code
	    >loginmodule.conf.name</code
	    > Java system property is used to identify the <em
	    >name</em
	    > of the config file, which must be located in the <code
	    >$RDECK_BASE/server/config</code
	    > dir.</p
	  ><p
	  >You can simply specify the system properties on the java commandline:</p
	  ><pre
	  ><code
	    >java -Dloginmodule.conf.name=jaas-activedirectory.conf \
    -Dloginmodule.name=activedirectory \
    -jar rundeck-launcher-x.x.jar
</code
	    ></pre
	  ><p
	  >Otherwise, if you are starting the Launcher via the supplied <code
	    >rundeckd</code
	    > script, you can modify the <code
	    >RDECK_JVM</code
	    > value in the <code
	    >$RDECK_BASE/etc/profile</code
	    > file to add two JVM arguments:</p
	  ><pre
	  ><code
	    >export RDECK_JVM=&quot;-Dloginmodule.conf.name=jaas-activedirectory.conf \
    -Dloginmodule.name=activedirectory&quot;
</code
	    ></pre
	  ><p
	  >Note: more information about using the launcher and useful properties are under <a href="#launcher-options"
	    >Getting Started - Launcher Options</a
	    >.</p
	  ><p
	  ><strong
	    >For the RPM installation</strong
	    >: the absolute path to the JAAS config file must be specified with the <code
	    >java.security.auth.login.config</code
	    > property.</p
	  ><p
	  >Update the <code
	    >RDECK_JVM</code
	    > in <code
	    >/etc/rundeck/profile</code
	    > by changing the following two JVM arguments:</p
	  ><pre
	  ><code
	    >export RDECK_JVM=&quot;-Djava.security.auth.login.config=/etc/rundeck/jaas-loginmodule.conf \
       -Dloginmodule.name=RDpropertyfilelogin \
</code
	    ></pre
	  ><p
	  >to</p
	  ><pre
	  ><code
	    >export RDECK_JVM=&quot;-Djava.security.auth.login.config=/etc/rundeck/jaas-activedirectory.conf \
       -Dloginmodule.name=activedirectory \
</code
	    ></pre
	  ></li
	><li
	><p
	  >Restart rundeckd</p
	  ><p
	  ><code
	    >sudo /etc/init.d/rundeckd restart</code
	    ></p
	  ></li
	><li
	><p
	  >Attempt to logon</p
	  ><p
	  >If everything was configured correctly, you will be able to access RunDeck using your AD credentials. If something did not go smoothly, look at <code
	    >/var/log/rundeck/service.log</code
	    > for stack traces that may indicate what is wrong.</p
	  ></li
	></ol
      ><div id="communicating-over-secure-ldap-ldaps:"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.7.2.1</span
	    > Communicating over secure ldap (ldaps://)</a
	  ></h4
	><p
	>The default port for communicating with active directory is 389, which is insecure. The secure port is 686, but the LoginModule describe above requires that the AD certificate or organizations CA certificate be placed in a truststore. The truststore provided with rundeck <code
	  >/etc/rundeck/ssl/truststore</code
	  > is used for the local communication between the cli tools and the rundeck server.</p
	><p
	>Before you can establish trust, you need to get the CA certificate. Typically, this would require a request to the organization's security officer to have them send you the certificate. It's also often found publicly if your organization does secure transactions.</p
	><p
	>Another option is to interrogate the secure ldap endpoint with openssl. The example below shows a connection to paypal.com on port 443. The first certificate is the machine and that last is the CA. Pick the last certificate.</p
	><p
	><em
	  >note</em
	  > that for Active Directory, the host would be the Active Directory server and port 686.<br
	   /><em
	  >note</em
	  > Certificates are PEM encoded and start with -----BEGIN CERTIFICATE----- end with -----END CERTIFICATE----- inclusive.</p
	><pre
	><code
	  >$ openssl s_client -showcerts -connect paypal.com:443
CONNECTED(00000003)
depth=1 C = US, O = &quot;VeriSign, Inc.&quot;, OU = VeriSign Trust Network, OU = Terms of use at https://www.verisign.com/rpa (c)09, CN = VeriSign Class 3 Secure Server CA - G2
verify error:num=20:unable to get local issuer certificate
verify return:0
---
Certificate chain
 0 s:/C=US/ST=California/L=San Jose/O=PayPal, Inc./OU=Information Systems/CN=paypal.com
   i:/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)09/CN=VeriSign Class 3 Secure Server CA - G2
-----BEGIN CERTIFICATE-----
MIIFDjCCA/agAwIBAgIQL0NdM6l74HplIwrcygDcCTANBgkqhkiG9w0BAQUFADCB
tTELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQL
ExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTswOQYDVQQLEzJUZXJtcyBvZiB1c2Ug
YXQgaHR0cHM6Ly93d3cudmVyaXNpZ24uY29tL3JwYSAoYykwOTEvMC0GA1UEAxMm
VmVyaVNpZ24gQ2xhc3MgMyBTZWN1cmUgU2VydmVyIENBIC0gRzIwHhcNMTAwNTAz
MDAwMDAwWhcNMTIwNjExMjM1OTU5WjB/MQswCQYDVQQGEwJVUzETMBEGA1UECBMK
Q2FsaWZvcm5pYTERMA8GA1UEBxQIU2FuIEpvc2UxFTATBgNVBAoUDFBheVBhbCwg
SW5jLjEcMBoGA1UECxQTSW5mb3JtYXRpb24gU3lzdGVtczETMBEGA1UEAxQKcGF5
cGFsLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEArlvu+86iVb4RXdX+
8MjmGynNSl+Hu2/ZJ7nU1sj5O2jASWwFH7PFUv10qlRtL+gi3Rjw+zFN958iUetz
ef4CxQYf52PA7Uj9YlFEzLz7f8UDotu4WNLM3QGbLrqS28pPb2qKyyOQDvwNpI1c
Jt4JDa0ofVnCdICZEnf+cJB121MCAwEAAaOCAdEwggHNMAkGA1UdEwQCMAAwCwYD
VR0PBAQDAgWgMEUGA1UdHwQ+MDwwOqA4oDaGNGh0dHA6Ly9TVlJTZWN1cmUtRzIt
Y3JsLnZlcmlzaWduLmNvbS9TVlJTZWN1cmVHMi5jcmwwRAYDVR0gBD0wOzA5Bgtg
hkgBhvhFAQcXAzAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy52ZXJpc2lnbi5j
b20vcnBhMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAfBgNVHSMEGDAW
gBSl7wsRzsBBA6NKZZBIshzgVy19RzB2BggrBgEFBQcBAQRqMGgwJAYIKwYBBQUH
MAGGGGh0dHA6Ly9vY3NwLnZlcmlzaWduLmNvbTBABggrBgEFBQcwAoY0aHR0cDov
L1NWUlNlY3VyZS1HMi1haWEudmVyaXNpZ24uY29tL1NWUlNlY3VyZUcyLmNlcjBu
BggrBgEFBQcBDARiMGChXqBcMFowWDBWFglpbWFnZS9naWYwITAfMAcGBSsOAwIa
BBRLa7kolgYMu9BSOJsprEsHiyEFGDAmFiRodHRwOi8vbG9nby52ZXJpc2lnbi5j
b20vdnNsb2dvMS5naWYwDQYJKoZIhvcNAQEFBQADggEBADbOGDkzZy22y+fW4OR7
wkx+1E3BxnRMZYx89OOykzTEUt2UV5DVuccUbqxTxg9/4pKMYJLywYn9UIOPHpwx
fbvMQNpdqV3JSuGMTwpROrMvC3bT13aCxxDnozeCjd/lH74m6G5ef2EUd3m5Y+iC
fMPo2NMrVyQYOCtpJurh9Tre1gQFHUYAXw8ty0YxfMoR/7FwYbd4spiZJwL2Mvfn
9gn24dWuKY7JaFutomwOM78rGzBDZZ/spEx9rcNa3OuVHcqBamnnXQZlZJilj4LE
buMBx8ti5Oqy4z1u1vzA8HalseiZerqFtBGOIakXdto8qLnwYEHQvVa/ih5iTsi3
Ja8=
-----END CERTIFICATE-----
 1 s:/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)09/CN=VeriSign Class 3 Secure Server CA - G2
   i:/C=US/O=VeriSign, Inc./OU=Class 3 Public Primary Certification Authority - G2/OU=(c) 1998 VeriSign, Inc. - For authorized use only/OU=VeriSign Trust Network
-----BEGIN CERTIFICATE-----
MIIGLDCCBZWgAwIBAgIQbk/6s8XmacTRZ8mSq+hYxDANBgkqhkiG9w0BAQUFADCB
wTELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMTwwOgYDVQQL
EzNDbGFzcyAzIFB1YmxpYyBQcmltYXJ5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5
IC0gRzIxOjA4BgNVBAsTMShjKSAxOTk4IFZlcmlTaWduLCBJbmMuIC0gRm9yIGF1
dGhvcml6ZWQgdXNlIG9ubHkxHzAdBgNVBAsTFlZlcmlTaWduIFRydXN0IE5ldHdv
cmswHhcNMDkwMzI1MDAwMDAwWhcNMTkwMzI0MjM1OTU5WjCBtTELMAkGA1UEBhMC
VVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQLExZWZXJpU2lnbiBU
cnVzdCBOZXR3b3JrMTswOQYDVQQLEzJUZXJtcyBvZiB1c2UgYXQgaHR0cHM6Ly93
d3cudmVyaXNpZ24uY29tL3JwYSAoYykwOTEvMC0GA1UEAxMmVmVyaVNpZ24gQ2xh
c3MgMyBTZWN1cmUgU2VydmVyIENBIC0gRzIwggEiMA0GCSqGSIb3DQEBAQUAA4IB
DwAwggEKAoIBAQDUVo9XOzcopkBj0pXVBXTatRlqltZxVy/iwDSMoJWzjOE3JPMu
7UNFBY6J1/raSrX4Po1Ox/lJUEU3QJ90qqBRVWHxYISJpZ6AjS+wIapFgsTPtBR/
RxUgKIKwaBLArlwH1/ZZzMtiVlxNSf8miKtUUTovStoOmOKJcrn892g8xB85essX
gfMMrQ/cYWIbEAsEHikYcV5iy0PevjG6cQIZTiapUdqMZGkD3pz9ff17Ybz8hHyI
XLTDe+1fK0YS8f0AAZqLW+mjBS6PLlve8xt4+GaRCMBeztWwNsrUqHugffkwer/4
3RlRKyC6/qfPoU6wZ/WAqiuDLtKOVImOHikLAgMBAAGjggKpMIICpTA0BggrBgEF
BQcBAQQoMCYwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLnZlcmlzaWduLmNvbTAS
BgNVHRMBAf8ECDAGAQH/AgEAMHAGA1UdIARpMGcwZQYLYIZIAYb4RQEHFwMwVjAo
BggrBgEFBQcCARYcaHR0cHM6Ly93d3cudmVyaXNpZ24uY29tL2NwczAqBggrBgEF
BQcCAjAeGhxodHRwczovL3d3dy52ZXJpc2lnbi5jb20vcnBhMDQGA1UdHwQtMCsw
KaAnoCWGI2h0dHA6Ly9jcmwudmVyaXNpZ24uY29tL3BjYTMtZzIuY3JsMA4GA1Ud
DwEB/wQEAwIBBjBtBggrBgEFBQcBDARhMF+hXaBbMFkwVzBVFglpbWFnZS9naWYw
ITAfMAcGBSsOAwIaBBSP5dMahqyNjmvDz4Bq1EgYLHsZLjAlFiNodHRwOi8vbG9n
by52ZXJpc2lnbi5jb20vdnNsb2dvLmdpZjApBgNVHREEIjAgpB4wHDEaMBgGA1UE
AxMRQ2xhc3MzQ0EyMDQ4LTEtNTIwHQYDVR0OBBYEFKXvCxHOwEEDo0plkEiyHOBX
LX1HMIHnBgNVHSMEgd8wgdyhgcekgcQwgcExCzAJBgNVBAYTAlVTMRcwFQYDVQQK
Ew5WZXJpU2lnbiwgSW5jLjE8MDoGA1UECxMzQ2xhc3MgMyBQdWJsaWMgUHJpbWFy
eSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEcyMTowOAYDVQQLEzEoYykgMTk5
OCBWZXJpU2lnbiwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVzZSBvbmx5MR8wHQYD
VQQLExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrghB92f4Hz6getxB5Z/uniTTGMA0G
CSqGSIb3DQEBBQUAA4GBAGN0Lz1Tqi+X7CYRZhr+8d5BJxnSf9jBHPniOFY6H5Cu
OcUgdav4bC1nHynCIdcUiGNLsJsnY5H48KMBJLb7j+M9AgtvVP7UzNvWhb98lR5e
YhHB2QmcQrmy1KotmDojYMyimvFu6M+O0Ro8XhnF15s1sAIjJOUFuNWI4+D6ufRf
-----END CERTIFICATE-----
---
Server certificate
subject=/C=US/ST=California/L=San Jose/O=PayPal, Inc./OU=Information Systems/CN=paypal.com
issuer=/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)09/CN=VeriSign Class 3 Secure Server CA - G2
---
No client certificate CA names sent
---
SSL handshake has read 3039 bytes and written 401 bytes
---
New, TLSv1/SSLv3, Cipher is DES-CBC3-SHA
Server public key is 1024 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : TLSv1
    Cipher    : DES-CBC3-SHA
    Session-ID: A8AAA4F22E9A4B3F12F76303464643525178846D96CA0BC0B81F35368BF55B89
    Session-ID-ctx: 
    Master-Key: 9F767B91FC2450E291CBB21E3438CA9A73FE8D5B825AD98F821F5EB912C088DFB66FCBF2D53591E2D1ED77E9B6A22504
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    Start Time: 1295242116
    Timeout   : 300 (sec)
    Verify return code: 20 (unable to get local issuer certificate)
---
^C
</code
	  ></pre
	><p
	>Once a certificate has been obtained. There are two options for adding the certificate. The first involves updating the truststore for the JRE. If that is not possible or not desirable, then one can set the truststore to be used by the jvm, using any arbitrary truststore that contains the appropriate certificate.</p
	><p
	>Both options require importing a certificate. The following would import a certificate called, AD.cert into the <code
	  >/etc/rundeck/ssl/truststore</code
	  >.</p
	><pre
	><code
	  >keytool -import -alias CompanyAD -file AD.cert -keystore /etc/rundeck/ssl/truststore -storepass adminadmin 
</code
	  ></pre
	><p
	>To add the certificate to the JRE, locate the file $JAVA_HOME/lib/security/cacerts and run</p
	><pre
	><code
	  >keytool -import -alias CompanyAD -file AD.cert -keystore $JAVA_HOME/lib/security/cacerts -storepass changeit 
</code
	  ></pre
	><p
	>To verify your CA has been added, run keytool list and look for CompanyAD in the output.</p
	><pre
	><code
	  >keytool -list -keystore $JAVA_HOME/lib/security/cacerts -storepass changeit
</code
	  ></pre
	><p
	>Refer to: http://download.oracle.com/javase/1.5.0/docs/tooldocs/solaris/keytool.html for more information how how to import a certificate.</p
	><p
	>Finally, in your <code
	  >ldap-activedirectory.conf</code
	  > be sure to change the <em
	  >providerUrl</em
	  > to be <code
	  >ldaps://ad-server</code
	  >. Including the port is optional as the default is 686.</p
	></div
      ><div id="redundant-connection-options"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.7.2.2</span
	    > Redundant Connection Options</a
	  ></h4
	><p
	><em
	  >providerUrl</em
	  > can take multiple, space delimited, urls. For example:</p
	><pre
	><code
	  > providerUrl=ldaps://ad1 ldaps://ad2  
</code
	  ></pre
	><p
	>Use this to provide connection redundancy if a particular host is unavailable.</p
	></div
      ></div
    ></div
  ><div id="authorization-1"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.8</span
	> Authorization</a
      ></h2
    ><p
    >Two dimensions of information dictate authorization inside RunDeck:</p
    ><ul
    ><li
      ><em
	>group</em
	> memberships assigned to a <em
	>user</em
	> login.<br
	 /></li
      ><li
      >access control policy that grants access to one or more <em
	>policy action</em
	>s to a <em
	>group</em
	> or <em
	>user</em
	>.</li
      ></ul
    ><p
    >The section on <a href="#managing-logins"
      >managing logins</a
      > discusses how to assign group memberships to users.</p
    ><p
    >The remainder of this section will describe how to use the access control policy.</p
    ><p
    ><em
      >Note from the project team</em
      >: The authorization layer is an early work in progress. Please share your ideas on the IRC or mailing list.</p
    ><div id="access-control-policy"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.1</span
	  > Access control policy</a
	></h3
      ><p
      >Access to running or modifying Jobs is managed in an access control policy defined using the aclpolicy YAML document. This file contains a number of policy elements that describe what user group is allowed to perform which actions.</p
      ><p
      >Please read over this document for information on how to define it, and how to grant access for certain actions to certain resources:</p
      ><ul
      ><li
	><a href="aclpolicy-v10.html"
	  >aclpolicy-v10(5)</a
	  ></li
	></ul
      ><p
      >Policies can be organized into more than one file to help organize access by group or pattern of use. The normal RunDeck install will have generated a policy for the &quot;admin&quot; group. Not all users will need to be given &quot;admin&quot; access level to control and modify all Jobs. More typically, a group of users will be given access to just a subset of Jobs.</p
      ><p
      >File listing: admin.aclpolicy example</p
      ><pre
      ><code
	>description: Admin project level access control. Applies to resources within a specific project.
context:
  project: '.*' # all projects
for:
  resource:
    - equals:
        kind: job
      allow: [create] # allow create jobs
    - equals:
        kind: node
      allow: [read,create,update,refresh] # allow refresh node sources
    - equals:
        kind: event
      allow: [read,create] # allow read/create events
  adhoc:
    - allow: [run,kill] # allow running/killing adhoc jobs
  job: 
    - allow: [read,update,delete,run,kill] # allow read/write/delete/run/kill of all jobs
  node:
    - allow: [read,run] # allow read/run for all nodes
by:
  group: admin

---

description: Admin Application level access control, applies to creating/deleting projects, admin of user profiles, viewing projects and reading system information.
context:
  application: 'rundeck'
for:
  resource:
    - equals:
        kind: project
      allow: [create] # allow create of projects
    - equals:
        kind: system
      allow: [read] # allow read of system info
    - equals:
        kind: user
      allow: [admin] # allow modify user profiles
  project:
    - match:
        name: '.*'
      allow: [read,admin] # allow view/admin of all projects
by:
  group: admin
</code
	></pre
      ><p
      >The example policy document above demonstrates the access granted to the users in group &quot;admin&quot;.</p
      ><p
      >Two separate policies define two levels of access control. The first is the &quot;project&quot; context, which allows access to actions on resources within a specific project. The second is the &quot;application&quot; level context, which allows access to things like creating projects, access to projects, managing users, and access to system information.</p
      ></div
    ><div id="specific-resources-and-resource-types"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.2</span
	  > Specific Resources and Resource Types</a
	></h3
      ><p
      >As described in the <a href="aclpolicy-v10.html"
	>aclpolicy-v10(5)</a
	> definition, access is granted or denied to specific &quot;resources&quot;. Resources can take two forms:</p
      ><ul
      ><li
	>A specific resource, with a type and properties</li
	><li
	>Resource types, which applies to all resources of a specific type or &quot;kind&quot;</li
	></ul
      ><p
      >For example, you might want to restrict access to a job or jobs within a certain group. This corresponds to specific &quot;job&quot; resources with a &quot;group&quot; property matching a certain pattern.</p
      ><p
      >You might also want to restrict who can create <em
	>new</em
	> jobs. Since a new job does not exist yet, you cannot create a rule for this action to apply to an existing job. Which means this corresponds to a generic resource with a &quot;kind&quot; called &quot;job&quot;.</p
      ></div
    ><div id="special-api-token-authentication-group"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.3</span
	  > Special API Token Authentication group</a
	></h3
      ><p
      >Clients of the <a href="api/index.html"
	>Web API</a
	> may use the <a href="api/index.html#token-authentication"
	>Token Authentication</a
	> method. These clients are placed in the special authorization group called <code
	>api_token_group</code
	>.</p
      ><dl
      ><dt
	><code
	  >api_token_group</code
	  ></dt
	><dd
	>Special role given to all <a href="api/index.html#token-authentication"
	  >API Token</a
	  > authenticated access.</dd
	></dl
      ></div
    ><div id="rundeck-resource-authorizations"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.4</span
	  > RunDeck resource authorizations</a
	></h3
      ><p
      >RunDeck declares a number of actions that can be referenced inside the access control policy document.</p
      ><p
      >The actions and resources are divided into project scope and application scope:</p
      ><div id="application-scope-resources-and-actions"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.8.4.1</span
	    > Application Scope Resources and Actions</a
	  ></h4
	><p
	>You define application scope rules in the aclpolicy, by declaring this context:</p
	><pre
	><code
	  >context:
  application: 'rundeck'
</code
	  ></pre
	><p
	>These are the Application scope actions that can be allowed or denied via the aclpolicy:</p
	><ul
	><li
	  >Creating Projects ('create' action on a resource type with kind 'project')</li
	  ><li
	  >Reading system information ('read' action on a resource type with kind 'project')</li
	  ><li
	  >Administering user profiles ('admin' action on a resource type of kind 'user')</li
	  ><li
	  >Reading specific projects ('read' action on a project with a specific name)</li
	  ><li
	  >Administering specific projects ('admin' action on a project with a specific name</li
	  ></ul
	><p
	>The following table summarizes the generic and specific resources and the actions you can restrict in the application scope:</p
	><table
	><caption
	  >Application scope generic type actions</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Type</th
	      ><th align="left"
	      >Resource Kind</th
	      ><th align="left"
	      >Properties</th
	      ><th align="left"
	      >Actions</th
	      ><th align="left"
	      >Description</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>resource</code
		></td
	      ><td align="left"
	      ><code
		>project</code
		></td
	      ><td align="left"
	      >none</td
	      ><td align="left"
	      ><code
		>create</code
		></td
	      ><td align="left"
	      >Create a new project</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>resource</code
		></td
	      ><td align="left"
	      ><code
		>system</code
		></td
	      ><td align="left"
	      >none</td
	      ><td align="left"
	      ><code
		>read</code
		></td
	      ><td align="left"
	      >Read system information</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>resource</code
		></td
	      ><td align="left"
	      ><code
		>user</code
		></td
	      ><td align="left"
	      >none</td
	      ><td align="left"
	      ><code
		>admin</code
		></td
	      ><td align="left"
	      >Modify user profiles</td
	      ></tr
	    ></tbody
	  ></table
	><table
	><caption
	  >Application scope specific resource actions</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Type</th
	      ><th align="left"
	      >Properties</th
	      ><th align="left"
	      >Actions</th
	      ><th align="left"
	      >Description</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>project</code
		></td
	      ><td align="left"
	      >&quot;name&quot;</td
	      ><td align="left"
	      ><code
		>read</code
		></td
	      ><td align="left"
	      >View a project in the project list</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>project</code
		></td
	      ><td align="left"
	      >&quot;name&quot;</td
	      ><td align="left"
	      ><code
		>admin</code
		></td
	      ><td align="left"
	      >Modify project configuration</td
	      ></tr
	    ></tbody
	  ></table
	></div
      ><div id="project-scope-resources-and-actions"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.8.4.2</span
	    > Project Scope Resources and Actions</a
	  ></h4
	><p
	>You define project scope rules in the aclpolicy by declaring this context:</p
	><pre
	><code
	  >context:
  project: &quot;(regex)&quot;
</code
	  ></pre
	><p
	>The regex can match all projects using &quot;.*&quot;, or you can simply put the project name.</p
	><p
	>Note that for projects not matched by an aclpolicy, <em
	  >no</em
	  > actions will be granted to users.</p
	><p
	>Also note that to hide projects completely from users, you would need to grant or deny the &quot;read&quot; access to the project in the <a href="#application-scope-resources-and-actions"
	  >Application Scope</a
	  >.</p
	><p
	>These are the Application scope actions that can be allowed or denied via the aclpolicy:</p
	><ul
	><li
	  >Create Jobs ('create' action on a resource type with kind 'job')</li
	  ><li
	  >Read Node data ('read' action on a resource type with kind 'node')</li
	  ><li
	  >Update/Refresh node data ('create','update','refresh' action on a resource type with kind 'node')</li
	  ><li
	  >Read history events ('read' action on a resource type with kind 'event')</li
	  ><li
	  >Create history events ('create' action on a resource type with kind 'event')</li
	  ><li
	  >Run adhoc jobs ('run' action on 'adhoc' resources)</li
	  ><li
	  >Kill adhoc jobs ('kill' action on 'adhoc' resources)</li
	  ><li
	  >Any Action on Jobs (actions on 'job' resources, see below)</li
	  ></ul
	><p
	>The following table summarizes the generic and specific resources and the actions you can restrict in the project scope:</p
	><table
	><caption
	  >Project scope generic type actions</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Type</th
	      ><th align="left"
	      >Resource Kind</th
	      ><th align="left"
	      >Actions</th
	      ><th align="left"
	      >Description</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>resource</code
		></td
	      ><td align="left"
	      ><code
		>job</code
		></td
	      ><td align="left"
	      ><code
		>create</code
		></td
	      ><td align="left"
	      >Create a new Job</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ><code
		>node</code
		></td
	      ><td align="left"
	      ><code
		>read</code
		></td
	      ><td align="left"
	      >Read node information</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ><code
		>create</code
		></td
	      ><td align="left"
	      >Create new node entries</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ><code
		>update</code
		></td
	      ><td align="left"
	      >Modify node entries</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ><code
		>refresh</code
		></td
	      ><td align="left"
	      >Refresh node entry from a URL</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ><code
		>event</code
		></td
	      ><td align="left"
	      ><code
		>read</code
		></td
	      ><td align="left"
	      >Read history event information</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ><code
		>create</code
		></td
	      ><td align="left"
	      >Create arbitrary history event entries</td
	      ></tr
	    ></tbody
	  ></table
	><table
	><caption
	  >Project scope specific resource actions</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Type</th
	      ><th align="left"
	      >Properties</th
	      ><th align="left"
	      >Actions</th
	      ><th align="left"
	      >Description</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>adhoc</code
		></td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>run</code
		></td
	      ><td align="left"
	      >Run and adhoc execution</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>kill</code
		></td
	      ><td align="left"
	      >Kill an adhoc execution</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>job</code
		></td
	      ><td align="left"
	      >&quot;name&quot;,&quot;group&quot;</td
	      ><td align="left"
	      ><code
		>read</code
		></td
	      ><td align="left"
	      >View a Job</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>update</code
		></td
	      ><td align="left"
	      >Modify a job</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>delete</code
		></td
	      ><td align="left"
	      >Delete a job</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>run</code
		></td
	      ><td align="left"
	      >Run a job</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>kill</code
		></td
	      ><td align="left"
	      >Kill a running job</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>create</code
		></td
	      ><td align="left"
	      >Create the matching job</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>node</code
		></td
	      ><td align="left"
	      >&quot;rundeck_server&quot;, &quot;nodename&quot;, ...</td
	      ><td align="left"
	      ><code
		>read</code
		></td
	      ><td align="left"
	      >View the node in the UI (see <a href="#node-resource-properties"
		>Node resource properties</a
		>)</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      >&quot;</td
	      ><td align="left"
	      ></td
	      ><td align="left"
	      ><code
		>run</code
		></td
	      ><td align="left"
	      >Run jobs/adhoc on the node</td
	      ></tr
	    ></tbody
	  ></table
	><p
	>Note: see <a href="#node-resource-properties"
	  >Node resource properties</a
	  > for more node resource properties for authorization.</p
	><p
	>Recall that defining rules for a resource type is done in this way:</p
	><pre
	><code
	  >for:
  resource:
    - equals:
        kind: 'project'
      allow: [create]
</code
	  ></pre
	><p
	>Whereas defining rules for specific resources of a certain type is done in this way:</p
	><pre
	><code
	  >for:
  job:
    - equals:
        name: bob
      allow: [run]
</code
	  ></pre
	></div
      ><div id="node-resource-properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.8.4.3</span
	    > Node resource properties</a
	  ></h4
	><p
	>The properties available are the attributes that are defined on the node, so you can apply authorizations based on tag, osName, hostname, etc. The special <code
	  >rundeck_server</code
	  > property will be set to &quot;true&quot; for the RunDeck server node only, and &quot;false&quot; for all other nodes.</p
	><p
	>Any custom attributes can be used as well.</p
	><table
	><caption
	  >Pre-defined Node resource properties for authorization filters</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Name</th
	      ><th align="left"
	      >Description</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>nodename</code
		></td
	      ><td align="left"
	      >Name of the node</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>username</code
		></td
	      ><td align="left"
	      >Authentication username</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>hostname</code
		></td
	      ><td align="left"
	      >Hostname of the node</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>description</code
		></td
	      ><td align="left"
	      >Description of the node</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>tags</code
		></td
	      ><td align="left"
	      >Set of tags. Can use with the <code
		>contains:</code
		> filter.</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>osName</code
		></td
	      ><td align="left"
	      >Operating System name</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>osFamily</code
		></td
	      ><td align="left"
	      >Operating System family, e.g. &quot;unix&quot; or &quot;windows&quot;</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>osVersion</code
		></td
	      ><td align="left"
	      >Operating System version</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>osArch</code
		></td
	      ><td align="left"
	      >Operating System architecture</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>rundeck_server</code
		></td
	      ><td align="left"
	      >A value set to &quot;true&quot; if the node is the Rundeck server node</td
	      ></tr
	    ></tbody
	  ></table
	></div
      ><div id="access-control-policy-actions-example"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.8.4.4</span
	    > Access control policy actions example</a
	  ></h4
	><p
	>Below is an example policy document demonstrating policy actions to create limited access for a group of users. Users in the group &quot;restart_user&quot;, are allowed to run three jobs in the &quot;adm&quot; group, Restart, stop and start. By allowing <code
	  >run</code
	  > but not <code
	  >read</code
	  >, the &quot;stop&quot; and &quot;start&quot; jobs will not be visible.</p
	><p
	>File listing: restart_user.aclpolicy example</p
	><pre
	><code
	  >description: Limited user access for adm restart action
context:
  project: '.*'
for:
  job:
    - equals:
        group: 'adm'
        name: 'Restart'
      allow: [run,read]
    - equals:
        group: 'adm'
        name: 'stop'
      allow: [run]
    - equals:
        group: 'adm'
        name: 'start'
      allow: [run]
by:
  group: [restart_user]
</code
	  ></pre
	></div
      ></div
    ><div id="troubleshooting-access-control-policy"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.5</span
	  > Troubleshooting access control policy</a
	></h3
      ><p
      >After defining an aclpolicy file to grant access to a particular group of users, you may find them getting &quot;unauthorized&quot; messages or complaints that certain actions are not possible.</p
      ><p
      >To diagnose this, begin by checking two bits:</p
      ><ol style="list-style-type: decimal;"
      ><li
	>The user's group membership. This can be done by going to the user's profile page in RunDeck. That page will list the groups the user is a member.</li
	><li
	>Read the messages inside the <code
	  >rundeck.audit.log</code
	  > log file. The authorization facility generates fairly low level messages describing how the policy is matched to the user context.</li
	></ol
      ><p
      >For each entry in the audit log, you'll see all decisions leading up to either a AUTHORIZED or a REJECTED message. It's not uncommon to see REJECTED messages followed by AUTHORIZED. The important thing is to look at the last decision made.</p
      ></div
    ><div id="authorization-caveats"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.6</span
	  > Authorization caveats</a
	></h3
      ><ul
      ><li
	>aclpolicy changes do not require a restart.</li
	></ul
      ></div
    ></div
  ><div id="configuring-rundeck-for-ssl"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.9</span
	> Configuring Rundeck for SSL</a
      ></h2
    ><p
    >This document describes how to configure Rundeck for SSL/HTTPS support, and assumes you are using the rundeck-launcher standalone launcher.</p
    ><ol style="list-style-type: decimal;"
    ><li
      ><p
	>Before beginning, do a first-run of the launcher, as it will create the base directory for Rundeck and generate configuration files.</p
	><pre
	><code
	  >cd $RDECK_BASE;  java -jar rundeck-launcher-1.1.0.jar
</code
	  ></pre
	></li
      ></ol
    ><p
    >This will start the server and generate necessary config files. Press control-c to shut down the server.</p
    ><ol start="2" style="list-style-type: decimal;"
    ><li
      ><p
	>Using the <a href="http://linux.die.net/man/1/keytool-java-1.6.0-openjdk"
	  >keytool</a
	  > command, generate a keystore for use as the server cert and client truststore. Specify passwords for key and keystore:</p
	><pre
	><code
	  >keytool -keystore etc/keystore -alias rundeck -genkey -keyalg RSA -keypass admin -storepass admin
</code
	  ></pre
	></li
      ></ol
    ><p
    >Be sure to specify the correct hostname of the server as the response to the question &quot;What is your first and last name?&quot;. Answer &quot;yes&quot; to the final question.</p
    ><p
    >You can pass all the answers to the tool on the command-line by using a HERE document.</p
    ><p
    >Replace the first line &quot;Venkman.local&quot; with the hostname for your server, and use any other organizational values you like:</p
    ><pre
    ><code
      >    keytool -keystore etc/keystore -alias rundeck -genkey -keyalg RSA -keypass adminadmin -storepass adminadmin  &lt;&lt;!
    Venkman.local
    devops
    My org
    my city
    my state
    US
    yes
    !
</code
      ></pre
    ><ol start="3" style="list-style-type: decimal;"
    ><li
      ><p
	>CLI tools that communicate to the Rundeck server need to trust the SSL certificate provided by the server. They are preconfigured to look for a truststore at the location: <code
	  >$RDECK_BASE/etc/truststore</code
	  >. Copy the keystore as the truststore for CLI tools:</p
	><pre
	><code
	  >cp etc/keystore etc/truststore
</code
	  ></pre
	></li
      ><li
      ><p
	>Modify the ssl.properties file to specify the location of the keystore and the appropriate passwords:</p
	><pre
	><code
	  >vi server/config/ssl.properties
</code
	  ></pre
	></li
      ></ol
    ><p
    >An example ssl.properties file (from the RPM package).</p
    ><pre
    ><code
      >    keystore=/etc/rundeck/ssl/keystore
    keystore.password=adminadmin
    key.password=adminadmin
    truststore=/etc/rundeck/ssl/truststore
    truststore.password=adminadmin
</code
      ></pre
    ><ol start="5" style="list-style-type: decimal;"
    ><li
      ><p
	>Configure client properties. Modify the file <code
	  >$RDECK_BASE/etc/framework.properties</code
	  > and change these properties:</p
	><ul
	><li
	  ><code
	    >framework.server.url</code
	    ></li
	  ><li
	  ><code
	    >framework.rundeck.url</code
	    ></li
	  ><li
	  ><code
	    >framework.server.port</code
	    ></li
	  ></ul
	></li
      ></ol
    ><p
    >Set them to the appropriate https protocol, and change the port to 4443, or to the value of your <code
      >-Dserver.https.port</code
      > runtime configuration property.</p
    ><ol start="6" style="list-style-type: decimal;"
    ><li
      ><p
	>Launch the rundeck launcher and tell it where to read the ssl.properties</p
	><pre
	><code
	  >java -Drundeck.ssl.config=$RDECK_BASE/server/config/ssl.properties -jar rundeck-launcher-1.1.0.jar
</code
	  ></pre
	></li
      ></ol
    ><p
    >You can change port by adding <code
      >-Dserver.https.port</code
      >:</p
    ><pre
    ><code
      >    java -Drundeck.ssl.config=$RDECK_BASE/server/config/ssl.properties -Dserver.https.port=1234 rundeck-launcher-1.1.0.jar
</code
      ></pre
    ><p
    >If successful, you will see a line indicating the SSl connector has started:</p
    ><pre
    ><code
      >Started SslSocketConnector@0.0.0.0:4443
</code
      ></pre
    ><div id="securing-passwords"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.9.1</span
	  > Securing passwords</a
	></h3
      ><p
      >Passwords do not have to be stored in the ssl.config. If they are not set, then the server will prompt on the console for a user to enter the passwords.</p
      ><p
      >If you want the server to start without prompting then you need to set the passwords in the config file.</p
      ><p
      >The passwords stored in ssl.properties can be obfuscated so they are not in plaintext:</p
      ><p
      >Run the jetty &quot;Password&quot; utility:</p
      ><pre
      ><code
	>$ java -cp server/lib/jetty-6.1.21.jar:server/lib/jetty-util-6.1.21.jar org.mortbay.jetty.security.Password &lt;password&gt;
</code
	></pre
      ><p
      >This will produce two lines, one starting with &quot;OBF:&quot;</p
      ><p
      >Use the entire OBF: output as the password in the ssl.properties file, eg:</p
      ><pre
      ><code
	>key.password=OBF:1lk2j1lkj321lj13lj
</code
	></pre
      ></div
    ><div id="troubleshooting-keystore"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.9.2</span
	  > Troubleshooting keystore</a
	></h3
      ><p
      >Some common error messages and causes:</p
      ><dl
      ><dt
	>java.io.IOException: Keystore was tampered with, or password was incorrect</dt
	><dd
	><p
	  >A password specified in the file was incorrect.</p
	  ></dd
	><dt
	>2010-12-02 10:07:29.958::WARN: failed SslSocketConnector@0.0.0.0:4443: java.io.FileNotFoundException: /Users/greg/rundeck/etc/keystore (No such file or directory)</dt
	><dd
	><p
	  >The keystore/truststore file specified in ssl.properties doesn't exist</p
	  ></dd
	></dl
      ></div
    ><div id="optional-pem-export"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.9.3</span
	  > Optional PEM export</a
	></h3
      ><p
      >You can export the PEM formatted server certificate for use by HTTPS clients (web browsers or e.g. curl).</p
      ><p
      >Export pem cacert for use by e.g. curl:</p
      ><pre
      ><code
	>keytool -export -keystore etc/keystore -rfc -alias rundeck &gt; rundeck.server.pem
</code
	></pre
      ></div
    ></div
  ><div id="customizing-rundeck-gui"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.10</span
	> Customizing RunDeck GUI</a
      ></h2
    ><p
    >You can modify some display features of the RunDeck GUI by setting these properties in the <a href="#rundeck-config.properties"
      >rundeck-config.properties</a
      > file:</p
    ><table
    ><col width="32%"
       /><col width="46%"
       /><col width="20%"
       /><thead
      ><tr class="header"
	><th align="left"
	  ><strong
	    >Property</strong
	    ></th
	  ><th align="left"
	  ><strong
	    >Description</strong
	    ></th
	  ><th align="left"
	  ><strong
	    >Example</strong
	    ></th
	  ></tr
	></thead
      ><tbody
      ><tr class="odd"
	><td align="left"
	  ><code
	    >rundeck.gui.title</code
	    ></td
	  ><td align="left"
	  >Title shown in app header</td
	  ><td align="left"
	  >Test App</td
	  ></tr
	><tr class="even"
	><td align="left"
	  ><code
	    >rundeck.gui.logo</code
	    ></td
	  ><td align="left"
	  >Logo icon path relative to webapps/rundeck/images dir</td
	  ><td align="left"
	  >test-logo.png</td
	  ></tr
	><tr class="odd"
	><td align="left"
	  ><code
	    >rundeck.gui.logo-width</code
	    ></td
	  ><td align="left"
	  >Icon width for proper display (32px is best)</td
	  ><td align="left"
	  >32px</td
	  ></tr
	><tr class="even"
	><td align="left"
	  ><code
	    >rundeck.gui.logo-height</code
	    ></td
	  ><td align="left"
	  >Icon height for proper display (32px is best)</td
	  ><td align="left"
	  >32px</td
	  ></tr
	><tr class="odd"
	><td align="left"
	  ><code
	    >rundeck.gui.titleLink</code
	    ></td
	  ><td align="left"
	  >URL for the link used by the app header icon.</td
	  ><td align="left"
	  >http://rundeck.org</td
	  ></tr
	><tr class="even"
	><td align="left"
	  ><code
	    >rundeck.gui.helpLink</code
	    ></td
	  ><td align="left"
	  >URL for the &quot;help&quot; link in the app header.</td
	  ><td align="left"
	  >http://rundeck.org/ docs</td
	  ></tr
	><tr class="odd"
	><td align="left"
	  ><code
	    >rundeck.gui.realJobTree</code
	    ></td
	  ><td align="left"
	  >Displaying a real tree in the Jobs overview instead of collapsing empty groups. <strong
	    >Default: true</strong
	    ></td
	  ><td align="left"
	  >false</td
	  ></tr
	></tbody
      ></table
    ></div
  ><div id="customizing-configuration-for-scale"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.11</span
	> Customizing configuration for scale</a
      ></h2
    ><p
    >Note: This section is early in its development.</p
    ><div id="file-descriptors"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.11.1</span
	  > File descriptors</a
	></h3
      ><p
      >The RunDeck server process opens a number of files during normal operation. These include system and java libraries, logs, and sockets. Your system restricts the number of open file handles per process but these limitations can be adjusted.</p
      ><p
      >If your installation attempts to exceed the limit, you will see an error like the one shown below in your <a href="#logs"
	>service.log</a
	> file.</p
      ><pre
      ><code
	>Too many open files 
</code
	></pre
      ><p
      ><em
	>On Linux nodes</em
	></p
      ><p
      >List the current limit with the <a href="http://ss64.com/bash/ulimit.html"
	>ulimit</a
	> command:</p
      ><pre
      ><code
	>ulimit -n
</code
	></pre
      ><p
      >If the limit is low (eg <code
	>1024</code
	>) it should be raised.</p
      ><p
      >You can get the current number of open file descriptors used by the RunDeck server process with <a href="http://linux.die.net/man/8/lsof"
	>lsof</a
	>:</p
      ><pre
      ><code
	>losf -p &lt;rundeck pid&gt; | wc -l
</code
	></pre
      ><p
      >Increase the limit for a wide margin. Edit <a href="http://ss64.com/bash/limits.conf.html"
	>/etc/security/limits.conf</a
	> file to raise the hard and soft limits. Here they are raised to <code
	>65535</code
	> for the &quot;rundeck&quot; system account:</p
      ><pre
      ><code
	>rundeck hard nofile 65535
rundeck soft nofile 65535
</code
	></pre
      ><p
      >The system file descriptor limit is set in /proc/sys/fs/file-max. The following command will increase the limit to 65535:</p
      ><pre
      ><code
	>echo 65535 &gt; /proc/sys/fs/file-max
</code
	></pre
      ><p
      >In a new shell, run the ulimit command to set the new level:</p
      ><pre
      ><code
	>ulimit -n 65535
</code
	></pre
      ><p
      >The ulimit setting can be set in the <a href="#rundeckd"
	>rundeckd</a
	> startup script, or <a href="#profile"
	>profile</a
	>.</p
      ><p
      >Restart RunDeck.</p
      ></div
    ><div id="java-heap-size"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.11.2</span
	  > Java heap size</a
	></h3
      ><p
      >The <code
	>rundeckd</code
	> startup script sets initial and maximum heap sizes for the server process. For many installations it will be sufficient.</p
      ><p
      >If the Rundeck JVM runs out of memory, the following error occurs:</p
      ><pre
      ><code
	>Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space
</code
	></pre
      ><p
      >Heap size is governed by the following startup parameters: <code
	>-Xms&lt;initial heap size&gt;</code
	> and <code
	>-Xmx&lt;maximum heap size&gt;</code
	></p
      ><p
      >You can increase these by updating the RunDeck <a href="#profile"
	>profile</a
	>. To see the current values, grep the <code
	>profile</code
	> for the Xmx and Xms patterns:</p
      ><ul
      ><li
	><p
	  >Launcher installs:</p
	  ><pre
	  ><code
	    >egrep '(Xmx|Xms)' $RDECK_BASE/etc/profile
</code
	    ></pre
	  ></li
	><li
	><p
	  >RPM installs:</p
	  ><pre
	  ><code
	    >egrep '(Xmx|Xms)' /etc/rundeck/profile
</code
	    ></pre
	  ></li
	></ul
      ><p
      >The default settings initialized by the installer sets these to 1024 megabytes maximum and 256 megabytes initial:</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;$RDECK_JVM -Xmx1024m -Xms256m&quot;
</code
	></pre
      ><p
      ><em
	>Sizing advice</em
	></p
      ><p
      >Several factors drive memory usage in RunDeck:</p
      ><ul
      ><li
	>User sessions</li
	><li
	>Concurrent threads</li
	><li
	>Concurrent jobs</li
	><li
	>Number of managed nodes</li
	></ul
      ><p
      >For example, if your installation has dozens of active users that manage a large environment (1000+ nodes), and has sufficient system memory, the following sizings might be more suitable:</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;$RDECK_JVM -Xmx4096m -Xms1024m -XX:MaxPermSize=256m&quot;
</code
	></pre
      ></div
    ><div id="quartz-job-threadcount"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.11.3</span
	  > Quartz job threadCount</a
	></h3
      ><p
      >The maximum number of threads used by RunDeck for concurrent jobs is set in the <code
	>quartz.properties</code
	> file. By default, this is set to <code
	>10</code
	>.</p
      ><ul
      ><li
	>RPM install: <code
	  >/var/lib/rundeck/server/exp/webapp/WEB-INF/classes/quartz.properties</code
	  ></li
	><li
	>Launcher install: <code
	  >$RDECK_BASE/server/exp/webapp/WEB-INF/classes/quartz.properties</code
	  ></li
	></ul
      ><p
      >To change the maximum threadCount modify this file and alter the line:</p
      ><pre
      ><code
	>org.quartz.threadPool.threadCount = 20
</code
	></pre
      ><p
      >Set the threadCount value to the max number of threads you want to run concurrently.</p
      ><p
      >Please refer to the Quartz site for detailed information: <a href="http://www.quartz-scheduler.org/docs/1.x/configuration/ConfigThreadPool.html"
	>Configuration - Thread Pool</a
	></p
      ></div
    ><div id="jmx-instrumentation"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.11.4</span
	  > JMX instrumentation</a
	></h3
      ><p
      >You may wish to monitor the internal operation of your RunDeck server via JMX.</p
      ><p
      >JMX provides introspection on the JVM, the application server, and classes all through a consistent interface. These various components are exposed to the management console via JMX managed beans — MBeans for short.</p
      ><p
      ><em
	>Note</em
	>: For more background information on JMX, see &quot;<a href="http://www.ibm.com/developerworks/library/j-jtp09196/"
	>Java theory and practice: Instrumenting applications with JMX.</a
	>&quot;.</p
      ><p
      >Enable local JMX monitoring by adding the <code
	>com.sun.management.jmxremote</code
	> flag to the startup parameters in the <a href="#profile"
	>profile</a
	>.</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;$RDECK_JVM -Dcom.sun.management.jmxremote&quot;
</code
	></pre
      ><p
      >You use a JMX client to monitor JMX agents. This can be a desktop GUI like JConsole run locally.</p
      ><pre
      ><code
	>jconsole &lt;rundeck pid&gt;
</code
	></pre
      ><p
      >For instructions on remote JMX monitoring for Grails, Spring and log4j see: <a href="http://www.ibm.com/developerworks/java/library/j-grails12168/index.html"
	>Grails in the enterprise</a
	>. # Integration with External Data Providers</p
      ><p
      >RunDeck can integrate with external data by configuring the use of <em
	>Providers</em
	> or <em
	>Sources</em
	>. Providers are third-party services or systems that export data that RunDeck can import. Additionally, RunDeck supports an external Editor for Node data.</p
      ><p
      >RunDeck makes use of common data formats (XML, JSON &amp; YAML). Third-party software may produce these formats natively, however it is typical to have to massage the output of one system into the appropriate format to be consumed by RunDeck. Since URLs and HTTP are a lowest-common-denominator for communication, RunDeck only requires that the data Providers make this data available as a file at a URL or on the local disk.</p
      ><p
      >There are a few types of external integration:</p
      ><dl
      ><dt
	><a href="#resource-model-source"
	  ><em
	    >Resource Model Source</em
	    ></a
	  ></dt
	><dd
	><p
	  >Provides a set of Nodes in XML or YAML format. E.g. a CMDB or hosted virtual machines service. RunDeck can be configured to use a different provider for each Project, and can refresh the Resources it uses from this provider.</p
	  ></dd
	><dt
	><a href="#resource-editor"
	  ><em
	    >Resource Editor</em
	    ></a
	  ></dt
	><dd
	><p
	  >Provides a web-based editor to manage the Node definitions. RunDeck can link to this editor from the Run page, and has optional JavaScript interactions to make editing externally-managed Node resources integrated with the RunDeck GUI.</p
	  ></dd
	><dt
	><a href="#option-model-provider"
	  ><em
	    >Option Model Provider</em
	    ></a
	  ></dt
	><dd
	><p
	  >Provides a dataset in JSON format, used as input option values for Jobs. Each Job Option can be configured to load the set of allowed input values from a remote service, and the RunDeck GUI will prompt the user to choose from those values when running a Job.</p
	  ></dd
	></dl
      ></div
    ></div
  ><div id="resource-model-source"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.12</span
	> Resource Model Source</a
      ></h2
    ><p
    >The Resource model source is a way to transfer Node definitions from other systems, tools or services into RunDeck. The means of providing the Resource model data can be done in whichever way suits your environment best.</p
    ><p
    >RunDeck supports plugins to provide different kinds of sources, but has built-in support for URLs or File based sources.</p
    ><p
    >Resource model data is a set of Node descriptors, each with a uniquely identifying name. In addition to Name, some pieces of metadata are required (like <code
      >hostname</code
      >, and <code
      >username</code
      >), and some are optional.</p
    ><p
    >(See <a href="#resource-model-document-formats"
      >Resource Model Document Formats</a
      > for more information on what format the files need to be in.)</p
    ><p
    >The Resource model data is stored on the server as a set of files. Each Project in RunDeck has at least a single Resources file, and may have multiple additional sources (such as a URL or a directory containing multiple files). All of these sources will be combined into the set of all Nodes that are available for the project. Each node's metadata can define how to connect to it and run commands.</p
    ><div id="requirements"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.12.1</span
	  > Requirements</a
	></h3
      ><p
      >In order to provide the Resource model data to RunDeck:</p
      ><ol style="list-style-type: decimal;"
      ><li
	>The data must be in one of the supported <a href="#resource-model-document-formats"
	  >Resource Model Document Formats</a
	  ></li
	><li
	>Each Node entry must have a unique <code
	  >name</code
	  > value. You may have to convert the external system's identifier to be unique, or create one yourself.</li
	></ol
      ><p
      >This means you can provide the data in the way that best suits your specific use-case. Some examples:</p
      ><ul
      ><li
	>Hand-crafted XML/YAML data, which you could store in a version control system. The URL for the file in the VCS repository would be provided to RunDeck.<ul
	  ><li
	    >To update the data you would commit changes to your VCS, and then tell RunDeck to refresh.</li
	    ></ul
	  ></li
	><li
	>Data generated from a custom CMDB or other software, and stored on disk.<ul
	  ><li
	    >You could do this with a cron-job, or via some external trigger. RunDeck will simply read the resource.xml/resource.yaml file identified in the configuration file.</li
	    ></ul
	  ></li
	><li
	>Data generated from a simple CGI script which interfaces with another third-party or external service.<ul
	  ><li
	    >You could run Apache and host a simple CGI script. The CGI script would communicate to some other system and then return the XML/YAML content. You could tell RunDeck to refresh the Resource model, which would in turn cause the CGI to access the external data and return the reformatted content.</li
	    ></ul
	  ></li
	><li
	>Using a <a href="#resource-model-source-plugins"
	  >Resource Model Source Plugin</a
	  >, the data could come from some other external source</li
	></ul
      ><p
      >The Resource model data does not have to include the RunDeck server Node, as it is implicitly included.</p
      ></div
    ><div id="configuration-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.12.2</span
	  > Configuration</a
	></h3
      ><p
      >Resource model sources are defined on a per-project basis, in the <a href="#project.properties"
	><code
	  >project.properties</code
	  ></a
	> file.</p
      ><p
      >The only required configuration value is <code
	>project.resources.file</code
	>, which defines a single file containing resource model data stored on-disk. Each new project will have a good default location, but you may change either the location or the file extension. The file extension determines the format of the data. (See <a href="#resource-model-document-formats"
	>Resource Model Document Formats</a
	>.)</p
      ><pre
      ><code
	>project.resources.file = ..
</code
	></pre
      ><p
      >This file path is where RunDeck will read the contents from, and also where it will store it to if refreshing from a remote URL.</p
      ><p
      >You may also specify a URL, which will be automatically retrieved and stored in a cache file. The Resource Model data within the content is merged with the previous file.</p
      ><pre
      ><code
	>project.resources.url = http://...
</code
	></pre
      ><p
      >This configures the remote URL for loading the Resources model data.</p
      ><p
      >In addition, multiple <a href="#resource-model-source-plugins"
	>Resource Model Source Plugin</a
	> can be configured to add additional sources of Resource Model data.</p
      ></div
    ><div id="implementations-and-examples"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.12.3</span
	  > Implementations and Examples</a
	></h3
      ><div id="simple-vcs-url-resource-model-source"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.12.3.1</span
	    > Simple VCS URL resource model source</a
	  ></h4
	><p
	>Putting the resources.xml/resources.yaml file under the control of a source code management tool is a simple solution to controlling and tracking change to the resources.xml file. Any changes will be committed and the commit messages become an audit log. Most source code management tools provide a web interface to retrieve file revisions based on a URL and thus make it accessible as a resource model source.</p
	><p
	>Going back to the <a href="#acme-anvils"
	  >Acme Anvils Example</a
	  > section, imagine the administrator decides the VCS approach is a good first step to control versioning for the anvils resource model. Acme is a <a href="http://subversion.tigris.org/"
	  >subversion</a
	  > user and installed <a href="http://www.viewvc.org/"
	  >viewvc</a
	  > to give web access to the repository.</p
	><p
	>First, the current resources.xml is added to the repository and committed:</p
	><pre
	><code
	  >svn add resources.xml http://svn.acme.com/ops/anvils/resources.xml
svn commit -m &quot;added resource model for anvils&quot; resources.xml
</code
	  ></pre
	><p
	>To test access, the administrator downloads the latest revision (ie, &quot;HEAD&quot;) via the &quot;viewvc&quot; interface.</p
	><pre
	><code
	  > curl http://svn.acme.com/viewvc/ops/anvils/resources.xml?revision=HEAD
</code
	  ></pre
	><p
	>Next, the anvils project.properties configuration file is modified to reference the URL to retrieve the &quot;HEAD&quot; revision:</p
	><pre
	><code
	  >project.resources.file = /etc/rundeck/projects/anvils/resources.xml
project.resources.url  = http://svn.acme.com/viewvc/ops/anvils/resources.xml?revision=HEAD
</code
	  ></pre
	><p
	>This configuration specifies the anvils resource model will be retrieved from <code>project.resources.url</code> and then stored at <code>project.resources.file</code>. Now, anytime RunDeck refreshes the anvils resource model, it will request the resources.xml file from the viewvc URL, obtaining the latest revision.</p
	></div
      ><div id="amazon-ec2-nodes"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.12.3.2</span
	    > Amazon EC2 Nodes</a
	  ></h4
	><p
	><a href="http://aws.amazon.com/ec2/"
	  >Amazon's EC2</a
	  > (Elastic Cloud Compute) is a cloud service in wide use for dynamic infrastructure; it is easy to start up and shut down Node &quot;Instances&quot; in the cloud.</p
	><p
	>For RunDeck, we would like to have a way of querying the EC2 service to see what EC2 Instances are available for use as RunDeck Nodes.</p
	><p
	>Amazon has a well-defined API for communication with their services, which allows us to pull out the EC2 data, and generate XML.</p
	><p
	>For this purpose, DTO Labs has created a Java-based implementation of this mechanism as the <a href="https://github.com/dtolabs/java-ec2-nodes"
	  >java-ec2-nodes</a
	  > project.</p
	><ul
	><li
	  ><a href="https://github.com/dtolabs/java-ec2-nodes"
	    >java-ec2-nodes</a
	    > project source code</li
	  ><li
	  ><a href="https://github.com/dtolabs/java-ec2-nodes/archives/master"
	    >download the binary distribution</a
	    >.</li
	  ></ul
	><p
	>Use is fairly simple:</p
	><ol style="list-style-type: decimal;"
	><li
	  >Unpack the distribution file &quot;java-ec2-nodes-0.1-bin.zip&quot;. This contains the required java Libs and a Perl based CGI script.</li
	  ><li
	  ><p
	    >Create an <code
	      >AWSCredentials.properties</code
	      > to specify your AWS credentials. (Available at <a href="http://aws.amazon.com/security-credentials"
	      >this page</a
	      >.) Place the file within the expanded java-ec2-nodes directory. This file should contain:</p
	    ><pre
	    ><code
	      >accessKey=&lt;your access key&gt;
secretKey=&lt;your secret key&gt;
</code
	      ></pre
	    ></li
	  ><li
	  >Place the generatenodes.cgi file within a webroot folder of an Apache server, and configure Apache to allow <code
	    >Options +ExecCGI</code
	    > for that folder.</li
	  ><li
	  ><p
	    >Modify the &quot;$basedir&quot; variable in generatenodes.cgi to point to the dir containing the zip contents you unpacked.</p
	    ></li
	  ></ol
	><p
	>Finally, you should be able to do HTTP GET for the CGI (e.g. <code
	  >http://myserver/scripts/generatenodes.cgi</code
	  >) and see an XML file returned. Note that the CGI allows query parameters to be used as API filters, e.g. <code
	  >?tag:mytag=myvalue</code
	  >. (These filters are specific to the <a href="http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/ApiReference-query-DescribeInstances.html"
	  >EC2 API</a
	  >.)</p
	><p
	>Once you have the CGI producing valid XML, you can set the <code
	  >project.resources.url</code
	  > property in your project's project.properties file to be the URl to the CGI.</p
	><p
	>Finally, within RunDeck, you can Refresh the Nodes from within the Run tab. You should see a Node entry for each EC2 Instance that is available.</p
	><p
	>You can easily manage the set of Nodes that gets returned from EC2 by organizing them by use of EC2 Tags, and applying query Filters to the EC2 API query.</p
	><p
	>In the EC2 interface, modify an Instance and add a Tag. Set the Tag name to &quot;RunDeck-Project&quot; and the value to &quot;MyProject&quot; (or your project name).</p
	><p
	>Then modify the URL used as your project.resources.url, to specify a query parameter of <code
	  >?tag:RunDeck-Project=MyProject</code
	  >. Then RunDeck will only see those Instances with that tag as Nodes within that RunDeck project.</p
	><p
	>More configuration is available for the <a href="https://github.com/dtolabs/java-ec2-nodes"
	  >java-ec2-nodes project</a
	  >.</p
	></div
      ><div id="third-party-url-resource-model-sources"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.12.3.3</span
	    > Third party URL resource model sources</a
	  ></h4
	><p
	>URL Resource model sources can be developed by third parties to integrate RunDeck with their tools.</p
	><p
	>Check the list on our wiki: <a href="https://github.com/dtolabs/rundeck/wiki/Resource-model-providers"
	  >https://github.com/dtolabs/rundeck/wiki/Resource-model-providers</a
	  >.</p
	></div
      ></div
    ></div
  ><div id="option-model-provider"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.13</span
	> Option model provider</a
      ></h2
    ><p
    >The Option model provider is a mechanism to allow the Options defined for a Job to have some of the possible input values provided by a remote service or database.</p
    ><p
    >Option model providers are configured on a per-Option basis (where a Job may have zero or more Options).</p
    ><div id="requirements-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.13.1</span
	  > Requirements</a
	></h3
      ><ol style="list-style-type: decimal;"
      ><li
	>Options model data must be <a href="http://www.json.org"
	  >JSON formatted</a
	  >.</li
	><li
	>It must be accessible via HTTP or on the local disk for the RunDeck server.</li
	><li
	>It must be in one of two JSON structures, <em
	  >either</em
	  >:<ul
	  ><li
	    >An array of string values</li
	    ><li
	    >OR, an array of Maps, each with two entries, <code
	      >name</code
	      > and <code
	      >value</code
	      >.</li
	    ></ul
	  ></li
	></ol
      ></div
    ><div id="configuration-2"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.13.2</span
	  > Configuration</a
	></h3
      ><p
      >Each Option entry for a Job can be configured to get the set of possible values from a remote URL. If you are authoring the Jobs via <a href="job-v20.html#option"
	>job.xml file format</a
	>, simply add a <code
	>valuesUrl</code
	> attribute for the <code
	>&lt;option&gt;</code
	>. If you are modifying the Job in the RunDeck web GUI, you can entry a URL in the &quot;Remote URL&quot; field for the Option.</p
      ><p
      >e.g.:</p
      ><pre
      ><code
	>&lt;option valuesUrl=&quot;http://site.example.com/values.json&quot; ...
</code
	></pre
      ><p
      ><em
	>Note</em
	>: File URL scheme is also acceptable (e.g, <code
	>file:/path/to/job/options/optA.json</code
	>).</p
      ><p
      >The value data must be returned in JSON data format described below.</p
      ></div
    ><div id="json-format"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.13.3</span
	  > JSON format</a
	></h3
      ><p
      >Three styles of return data are supported: simple list, simple object, and a name/value list. For a simple list, the list values will be displayed in a pop-up list when running the Job. If a simple object or name/value pairs are returned, then the <code
	>name</code
	> will be displayed in the list, but the <code
	>value</code
	> will be used as the input.</p
      ><p
      ><em
	>Examples</em
	></p
      ><p
      >Simple List:</p
      ><pre
      ><code
	>[&quot;x value for test&quot;,&quot;y value for test&quot;]
</code
	></pre
      ><p
      >This will populate the select menu with the given values.</p
      ><p
      >Simple Object:</p
      ><pre
      ><code
	>{ &quot;Name&quot;: &quot;value1&quot;, &quot;Name2&quot;:&quot;value2&quot; }
</code
	></pre
      ><p
      >This will populate the select menu to show the names and use the values.</p
      ><p
      >Name Value List:</p
      ><pre
      ><code
	>[
  {name:&quot;X Label&quot;, value:&quot;x value&quot;},
  {name:&quot;Y Label&quot;, value:&quot;y value&quot;},
  {name:&quot;A Label&quot;, value:&quot;a value&quot;}
] 
</code
	></pre
      ></div
    ><div id="variable-expansion-in-remote-urls"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.13.4</span
	  > Variable expansion in remote URLs</a
	></h3
      ><p
      >The URL declared for the &quot;valuesUrl&quot; can embed variables which will be filled with certain job context items when making the remote request. This helps make the URLs more generic and contextual to the Job.</p
      ><p
      >Two types of expansions are available, Job context, and Option context.</p
      ><p
      >To include job information in the URL, specify a variable of the form ${job.<em
	>property</em
	>}.</p
      ><p
      >Properties available for Job context:</p
      ><ul
      ><li
	><code
	  >name</code
	  >: Name of the Job</li
	><li
	><code
	  >group</code
	  >: Group of the Job</li
	><li
	><code
	  >description</code
	  >: Job description</li
	><li
	><code
	  >project</code
	  >: Project name</li
	><li
	><code
	  >argString</code
	  >: Default argument string for a job</li
	></ul
      ><p
      >To include Option information in the URL, specify a variable of the form ${option.<em
	>property</em
	>}:</p
      ><p
      >Properties available for Option context:</p
      ><ul
      ><li
	><code
	  >name</code
	  >: Name of the current option</li
	></ul
      ><p
      ><em
	>Examples</em
	></p
      ><pre
      ><code
	>http://server.com/test?name=${option.name}
</code
	></pre
      ><p
      >Passes the option name as the &quot;name&quot; query parameter to the URL.</p
      ><pre
      ><code
	>http://server.com/test?jobname=${job.name}&amp;jobgroup=${job.group}
</code
	></pre
      ><p
      >Passes the job name and group as query parameters.</p
      ></div
    ><div id="remote-request-failures"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.13.5</span
	  > Remote request failures</a
	></h3
      ><p
      >If the request for the remote option values fails, then the GUI form will display a warning message:</p
      ><div class="figure"
      ><img src="figures/fig0901.png"
	 /><p class="caption"
	></p
	></div
      ><p
      >In this case, the option will be allowed to use a textfield to set the value.</p
      ></div
    ><div id="implementations-and-examples-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.13.6</span
	  > Implementations and Examples</a
	></h3
      ><p
      >The following two sections describe examples using simple CGI scripts that act as option model providers.</p
      ><div id="hudson-artifacts-option-provider"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.13.6.1</span
	    > Hudson artifacts option provider</a
	  ></h4
	><p
	>An end-to-end release process often requires obtaining build artifacts and publishing them to a central repository for later distribution. A continuous integration server like <a href="http://hudson-ci.org/"
	  >Hudson</a
	  > makes identifying the build artifacts a simple Job configuration step. The <a href="http://wiki.hudson-ci.org/display/HUDSON/Remote+access+API"
	  >Hudson API</a
	  > provides a network interface to obtain the list of artifacts from successful builds via a simple HTTP GET request.</p
	><p
	>Acme builds its artifacts as RPMs and has configured their build job to identify them. The operations team wants to create Jobs that would allow them to choose a version of these artifacts generated by the automated build.</p
	><p
	>A simple CGI script that requests the information from Hudson and then generates a <a href="http://www.json.org/"
	  >JSON</a
	  > document is sufficient to accomplish this. The CGI script can use query parameters to specify the Hudson server, hudson job and artifact path. Job writers can then specify the parameterized URL to the CGI script to obtain the artifacts list as an options model and present the results as a menu to Job users.</p
	><p
	>The code listing below shows the the CGI script essentially does a call to the <a href="http://curl.haxx.se/"
	  >curl</a
	  > command to retrieve the XML document containing the artifacts information and then parses it using <a href="http://xmlstar.sourceforge.net/"
	  >xmlstarlet</a
	  >.</p
	><p
	>File listing: hudson-artifacts.cgi</p
	><pre
	><code
	  >#!/bin/bash
# Requires: curl, xmlstarlet
# Returns a JSON list of key/val pairs
#
# Query Params and their defaults
hudsonUrl=https://build.acme.com:4440/job
hudsonJob=ApplicationBuild
artifactPath=/artifact/bin/dist/RPMS/noarch/

echo Content-type: application/json
echo &quot;&quot;
for VAR in `echo $QUERY_STRING | tr &quot;&amp;&quot; &quot;\t&quot;`
do
  NAME=$(echo $VAR | tr = &quot; &quot; | awk '{print $1}';);
  VALUE=$(echo $VAR | tr = &quot; &quot; | awk '{ print $2}' | tr + &quot; &quot;);
  declare $NAME=&quot;$VALUE&quot;;
done

curl -s -L -k $hudsonUrl/${hudsonJob}/api/xml?depth=1 | \
  xmlstarlet sel -t -o &quot;{&quot; \
    -t -m &quot;//build[result/text()='SUCCESS']&quot; --sort A:T:L number  \
    -m . -o &quot;&amp;quot;Release&quot; -m changeSet/item -o ' ' -v revision -b \
    -m . -o &quot;, Hudson Build &quot; -v number -o &quot;&amp;quot;:&quot; \
    -m 'artifact[position() = 1]' -o &quot;&amp;quot;&quot; -v '../number' -o $artifactPath -o &quot;{&quot; -b \
    -m 'artifact[position() != last()]' -v 'fileName' -o &quot;,&quot; -b \
    -m 'artifact[position() = last()]' -v 'fileName' -o &quot;}&amp;quot;,&quot; \
    -t -o &quot;}&quot;
</code
	  ></pre
	><p
	>After deploying this script to a CGI enabled directory on the operations web server, it can be tested directly by requesting it using <code
	  >curl</code
	  >.</p
	><pre
	><code
	  >curl -d &quot;hudsonJob=anvils&amp;artifactPath=/artifact/bin/dist/RPMS/noarch/&quot; \
    --get http://opts.acme.com/cgi/hudson-artifacts.cgi
</code
	  ></pre
	><p
	>The server response should return JSON data resembling the example below:</p
	><pre
	><code
	  >[ 
  {name:&quot;anvils-1.1.rpm&quot;, value:&quot;/artifact/bin/dist/RPMS/noarch/anvils-1.1.rpm&quot;}, 
  {name:&quot;anvils-1.2.rpm&quot;, value:&quot;/artifact/bin/dist/RPMS/noarch/anvils-1.2.rpm&quot;} 
]   
</code
	  ></pre
	><p
	>Now in place, jobs can request this option data like so:</p
	><pre
	><code
	  > &lt;option name=&quot;package&quot; enforcedvalues=&quot;true&quot; required=&quot;true&quot;
    valuesUrl=&quot;http://ops.acme.com/cgi/hudson-artifacts.cgi?hudsonJob=anvils&quot;/&gt; 
</code
	  ></pre
	><p
	>The RunDeck UI will display the package names in the menu and once selected the Job will have the path to the build artifact on the Hudson server.</p
	></div
      ><div id="yum-repoquery-option-model-provider"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.13.6.2</span
	    > Yum repoquery option model provider</a
	  ></h4
	><p
	><a href="http://yum.baseurl.org/"
	  >Yum</a
	  > is a great tool for automating <a href="http://www.rpm.org/"
	  >RPM</a
	  > package management. With Yum, administrators can publish packages to the repository and then use the yum client tool to automate the installation of packages along with their declared dependencies. Yum includes a command called <a href="http://linux.die.net/man/1/repoquery"
	  >repoquery</a
	  > useful for querying Yum repositories similarly to rpm queries.</p
	><p
	>Acme set up their own Yum repository to distribute application release packages. The Acme administrator wants to provide an option model to Jobs that need to know what packages provide a given capability.</p
	><p
	>The code listing below shows it is a simple wrapper around the repoquery command that formats the results as JSON data.</p
	><p
	>File listing: yum-repoquery.cgi</p
	><pre
	><code
	  >#!/bin/bash
# Requires: repoquery
# 
# Query Params and their defaults
repo=acme-staging
label=&quot;Anvils Release&quot;
package=anvils
max=30
#
echo Content-type: application/json
echo &quot;&quot;
for VAR in `echo $QUERY_STRING | tr &quot;&amp;&quot; &quot;\t&quot;`
do
  NAME=$(echo $VAR | tr = &quot; &quot; | awk '{print $1}';);
  VALUE=$(echo $VAR | tr = &quot; &quot; | awk '{ print $2}' | tr + &quot; &quot;);
  declare $NAME=&quot;$VALUE&quot;;
done

echo '{'
repoquery --enablerepo=$repo --show-dupes \
  --qf='&quot;${label} %{VERSION}-%{RELEASE}&quot;:&quot;%{NAME}-%{VERSION}-%{RELEASE}&quot;,' \
  -q --whatprovides ${package} | sort -t - -k 4,4nr | head -n${max}
echo '}'
</code
	  ></pre
	><p
	>After deploying this script to the CGI enabled directory on the operations web server, it can be tested directly by requesting it using <code
	  >curl</code
	  >.</p
	><pre
	><code
	  >curl -d &quot;repo=acme&amp;label=Anvils&amp;package=anvils&quot; \
    --get http://ops.acme.com/cgi/yum-repoquery.cgi
</code
	  ></pre
	><p
	>The server response should return JSON data resembling the example below:</p
	><pre
	><code
	  >TODO: include JSON example
</code
	  ></pre
	><p
	>Now in place, jobs can request the option model data like so:</p
	><pre
	><code
	  > &lt;option name=&quot;package&quot; enforcedvalues=&quot;true&quot; required=&quot;true&quot;
    valuesUrl=&quot;http://ops.acme.com/cgi/yum-repoquery.cgi?package=anvils&quot;/&gt; 
</code
	  ></pre
	><p
	>The RunDeck UI will display the package names in the menu and once selected, the Job will have the matching package versions.</p
	></div
      ></div
    ></div
  ><div id="resource-editor"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.14</span
	> Resource Editor</a
      ></h2
    ><p
    >The Resource Editor integration is a way to link to a third-party system used for managing Node definitions from within RunDeck. Each Node entry in the resources.xml or resources.yaml can define a URL to provide an &quot;Edit&quot; link that will appear in the RunDeck Run page for that Node.</p
    ><p
    >This allows you to make use of the Resource Model Source in a more seamless way. RunDeck will load the Resource model from the third-party Provider system, and users of RunDeck can click straight to the Editor for those Nodes. The Provider and the Editor could be the same system, or they could both be custom CGI scripts that integrate with a third system.</p
    ><p
    >Some teams have acquired or developed tools to manage information about the hosts deployed in their networks. These tools have interfaces to not just view but also modify the data about these hosts. Though there is no widely used common standard adopted by users of these tools, it is possible to map the data to meet the needs of <a href="#resource-model-provider"
      >RunDeck resource models</a
      >.</p
    ><div id="definition"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.14.1</span
	  > Definition</a
	></h3
      ><p
      >The <a href="resource-v13.html"
	>RunDeck resource model document format</a
	> and the <a href="resource-yaml-v13.html"
	>resource-yaml-v13</a
	> format provide two attributes that help connect the dots between the RunDeck UI and the editing interface provided by the external data management tool. They can use <code
	>editUrl</code
	> or <code
	>remoteUrl</code
	> attributes to specify the remote URL. The URLs can embed properties about the node to expand prior to being loaded, which allows you to e.g. submit query parameters using the node name.</p
      ><dl
      ><dt
	><code
	  >editUrl</code
	  ></dt
	><dd
	><p
	  >Specifies a URL to a remote site which will allow editing of the Node. When specified, the Node resource will display an &quot;Edit&quot; link in the RunDeck GUI and clicking it will open a new browser page for the URL.</p
	  ></dd
	><dt
	><a href="#using-remoteurl"
	  ><code
	    >remoteUrl</code
	    ></a
	  ></dt
	><dd
	><p
	  >Specifies a URL for a remote site which will be loaded in an iframe within a RunDeck page. Clicking the &quot;Edit&quot; link for the Node will load content from the site within the current RunDeck page, allow you to perform your edit at the remote site, and has optional JavaScript hooks to report the state of the editing process back to the RunDeck page for a more streamlined user interface.</p
	  ></dd
	></dl
      ></div
    ><div id="using-properties"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.14.2</span
	  > Using properties</a
	></h3
      ><p
      >Properties of the Node can be embedded in the URL and expanded prior to use. The syntax is:</p
      ><pre
      ><code
	>${node.property}
</code
	></pre
      ><p
      >Available properties are:</p
      ><p
      ><code
	>name</code
	>, <code
	>hostname</code
	>, <code
	>os-name</code
	>, <code
	>os-version</code
	>, <code
	>os-family</code
	>, <code
	>os-arch</code
	>, <code
	>username</code
	>, <code
	>description</code
	>, <code
	>tags</code
	>, <code
	>project</code
	></p
      ><p
      >You can embed these properties within the url like this:</p
      ><pre
      ><code
	>http://mycmdb:8080/node/edit?name=${node.name}
</code
	></pre
      ></div
    ><div id="using-remoteurl"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.14.3</span
	  > Using remoteUrl</a
	></h3
      ><p
      >Using the <code
	>remoteUrl</code
	> lets you embed another site into an iframe within the RunDeck page, and optionally allows communication back to the RunDeck page about the state of the editing process.</p
      ><p
      >If you want to embed the remote site without having to make any changes to the remote page content, you can do so simply by specifying the <code
	>remoteUrl</code
	> to use. When the user clicks &quot;Edit&quot; the site will load within an iframe, and the user can perform whatever actions on the site are necessary. After they are done they will have to manually click the &quot;Close&quot; button on the RunDeck page to close the iframe.</p
      ><p
      >If you want the user interface in RunDeck to be more streamlined, you will have to be able to modify the web pages produced by the remote site to add simple Javascript calls to communicate back to the RunDeck page. The JavaScript hooks are designed to not add much burden to the developer of the remote site or system, so they are optional.</p
      ><div id="streamlining-the-interface"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.14.3.1</span
	    > Streamlining the interface</a
	  ></h4
	><p
	>If the remote site implements some Javascript messaging conforming to a simple optional protocol, then the user interface between RunDeck and the remote site can be made more seamless.</p
	><p
	>RunDeck lets the remote site inform it when the following steps occur:</p
	><ul
	><li
	  >The user begins editing a Node</li
	  ><li
	  >The user saves the Node changes successfully and is finished</li
	  ><li
	  >The user cancels the Node changes, or otherwise has finished without saving</li
	  ><li
	  >An error occurs and an error message should be shown.</li
	  ></ul
	><p
	>Due to web browser security restrictions, direct communication between different webpages can only be done through use of the <a href="http://www.whatwg.org/specs/web-apps/current-work/#crossDocumentMessages"
	  >postMessage</a
	  > method.</p
	><p
	>The remote page can send these messages simply with this javascript:</p
	><pre
	><code
	  >&lt;script type=&quot;text/javascript&quot;&gt;
    if(window.self!=window.parent){
        window.parent.postMessage(&quot;...message...&quot;,&quot;http://rundeckserver:port&quot;);
    }
&lt;/script&gt;
</code
	  ></pre
	><p
	><code
	  >window.parent</code
	  > will be the enclosing browser window when the site is loaded within an iframe. This script simply checks whether the page is loaded in an iframe before sending the message.</p
	><p
	>The first argument to <code
	  >postMessage</code
	  > is one of the message codes shown below. The second argument is the expected &quot;origin&quot;, meaning the URL scheme, server and port of the server receiving the message. You can specify &quot;*&quot; to include any site that may be loading the content, but you may want to restrict it to your RunDeck installation's scheme, hostname and port.</p
	><p
	>RunDeck can receive the following messages sent by the remote site:</p
	><dl
	><dt
	  ><code
	    >rundeck:node:edit:started</code
	    ></dt
	  ><dd
	  ><p
	    >Sent as soon as the remote edit URL is loaded and indicates that the remote Site understands the messaging protocol and has loaded the correct edit page. You would probably send this on the &quot;edit&quot; or &quot;form&quot; page for the targetted node.</p
	    ></dd
	  ><dt
	  ><code
	    >rundeck:node:edit:error</code
	    > or <code
	    >rundeck:node:edit:error:An error message</code
	    ></dt
	  ><dd
	  ><p
	    >Sent if some error occurs. The remote editing form will close and the error message (if any) will be shown. You would probably send this on the &quot;edit&quot; or &quot;view&quot; page if there is an error locating the targeted Node or loading anything required for the edit process.</p
	    ></dd
	  ></dl
	><p
	>The next two messages are only valid after the &quot;started&quot; message has already been received:</p
	><dl
	><dt
	  ><code
	    >rundeck:node:edit:finished:true</code
	    ></dt
	  ><dd
	  ><p
	    >Sent after the remote form has been saved without errors. This indicates that the editing process is done and has completed with saved changes. You would probably send this on the &quot;view&quot; or &quot;show&quot; page for the targeted node if the save operation was successful.</p
	    ></dd
	  ><dt
	  ><code
	    >rundeck:node:edit:finished:false</code
	    ></dt
	  ><dd
	  ><p
	    >Sent after the remote form has been either cancelled or discarded without changes. This indicates that the editing process is done but no changes were made. You would probably send this on the &quot;view&quot; or &quot;show&quot; for the targeted node (if your site simply shows the node view again) or &quot;list&quot; page (if your site goes back to a list of resources) if the user hits &quot;cancel&quot;.</p
	    ></dd
	  ></dl
	><p
	>Any message not shown here that is received by RunDeck after it has received the &quot;started&quot; message will be considered unexpected and the editing process will close the iframe.</p
	><p
	>The user will also have the option to close and cancel the remote editing process at any time.</p
	><p
	>Note that sending the &quot;error&quot; or &quot;finished&quot; message will close the editing session and all subsequent messages will be ignored.</p
	><p
	>TODO: The JavaScript code to communicate back to RunDeck could be bundled into a simple widget script file for easier inclusion on remote sites.</p
	></div
      ></div
    ><div id="examples"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.14.4</span
	  > Examples</a
	></h3
      ><p
      >Here are some examples of using the <code
	>editUrl</code
	> and <code
	>remoteUrl</code
	> in a resources.xml/resources.yaml file:</p
      ><p
      >Specify a simple URL for editing, which will simply produce a link:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; editUrl=&quot;http://mycmdb:8080/node/edit&quot; ... /&gt;
</code
	></pre
      ><p
      >Specify a URL for editing, with embedded &quot;name&quot; property as a parameter:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; editUrl=&quot;http://mycmdb:8080/node/edit?name=${node.name}&quot; ... /&gt;
</code
	></pre
      ><p
      >Specify a remote URL with embedded &quot;name&quot; and &quot;project&quot; properties as parameters:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; remoteUrl=&quot;http://mycmdb:8080/node/edit?name=${node.name}&amp;amp;project=${node.project}&quot; ... /&gt;
</code
	></pre
      ><p
      >Specify a remote URL with embedded &quot;name&quot; property as part of the path:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; remoteUrl=&quot;http://mycmdb:8080/node/edit/${node.name}&quot;  ... /&gt;
</code
	></pre
      ><p
      >In YAML, some examples:</p
      ><p
      >Specify a remote URL with embedded &quot;name&quot; and &quot;project&quot; properties as parameters:</p
      ><pre
      ><code
	>venkman:
  nodename: venkman
  remoteUrl: http://mycmdb:8080/node/edit?name=${node.name}&amp;amp;project=${node.project}
</code
	></pre
      ><p
      >Specify a remote URL with embedded &quot;name&quot; property as part of the path:</p
      ><pre
      ><code
	>venkman:
  nodename: venkman
  remoteUrl: &quot;http://mycmdb:8080/node/edit/${node.name}
</code
	></pre
      ><div id="simple-site-integration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.14.4.1</span
	    > Simple site integration</a
	  ></h4
	><p
	>The <a href="https://github.com/gschueler/ndbtest"
	  >ndbtest</a
	  > project on github provides an example of how the remote Resource Editor can integrate with RunDeck using JavaScript.</p
	><p
	>This project is a simple <a href="http://grails.org"
	  >Grails</a
	  > application which provides a database of Node data. The standard web-based user flow is:</p
	><ul
	><li
	  >List all nodes.</li
	  ><li
	  >Edit a Node with the edit page. From here the User can:<ul
	    ><li
	      >Cancel the Node changes<ul
		><li
		  >Goes to the Node show page</li
		  ></ul
		></li
	      ><li
	      >Save the Node changes<ul
		><li
		  >Result is successful<ul
		    ><li
		      >Goes to the Node show page</li
		      ></ul
		    ></li
		  ><li
		  >Result fails, so display an Error message (either on the edit page or the list page)</li
		  ></ul
		></li
	      ></ul
	    ></li
	  ></ul
	><p
	>We want the Node's &quot;edit&quot; link in RunDeck to go directly to an edit page, so the <code
	  >remoteUrl</code
	  > for each Node entry then should be a URL to link to this page, for example:</p
	><pre
	><code
	  >remoteUrl=&quot;http://localhost:8080/node/edit?name=${node.name}&amp;amp;project=${node.project}&quot;
</code
	  ></pre
	><p
	>The code below shows that the <code
	  >name</code
	  > &amp; <code
	  >project</code
	  > are used to select the correct node from the database, even though the built-in identifier is an ID number:</p
	><ul
	><li
	  ><p
	    ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/controllers/com/dtolabs/ndb/NodeController.groovy#L51"
	      >NodeController.groovy:51</a
	      >.</p
	    ><ul
	    ><li
	      >Note that if there is no Node found with the specified values, then the response will be to set an error message and then show the list page.</li
	      ></ul
	    ></li
	  ></ul
	><p
	>So the JavaScript for integrating with RunDeck is then added to the following pages in this system:</p
	><ul
	><li
	  ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/edit.gsp"
	    >node/edit.gsp</a
	    ><ul
	    ><li
	      >If an error has occurred, it posts an error message starting on <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/edit.gsp#L27"
		>Line 27</a
		></li
	      ><li
	      >Otherwise, it posts the <code
		>started</code
		> message starting <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/edit.gsp#L34"
		>on line 34</a
		></li
	      ></ul
	    ></li
	  ><li
	  ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/show.gsp"
	    >node/show.gsp</a
	    ><ul
	    ><li
	      >If the node save was successful, send the <code
		>finished:true</code
		> message, starting at <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/show.gsp#L21"
		>line 21</a
		>.</li
	      ><li
	      >Otherwise send the <code
		>finished:false</code
		> message starting at <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/show.gsp#L28"
		>line 28</a
		>.</li
	      ></ul
	    ></li
	  ><li
	  ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/list.gsp"
	    >node/list.gsp</a
	    ><ul
	    ><li
	      >If an error has occurred, it posts an error message starting on <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/list.gsp#L20"
		>line 20</a
		>.</li
	      ></ul
	    ></li
	  ></ul
	><p
	>To complete the round-trip of editing a Node and then showing the results back in RunDeck, the ndbtest project would have to export XML formatted Resource data, and then your RunDeck project.properties file would have to point to the appropriate URL. (This is left as an exercise to the reader.)</p
	></div
      ></div
    ></div
  ><div id="webhooks"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.15</span
	> Webhooks</a
      ></h2
    ><p
    >RunDeck Jobs can be configured to POST data to a webhook URL when they succeed or fail.</p
    ><ul
    ><li
      >For more info about configuring jobs to use webhook notifications, see the chapter <a href="RunDeck-Guide.html#job-notifications"
	>Jobs - Job Notifications</a
	>.</li
      ><li
      >For more info about webhooks in general see: <a href="http://webhooks.pbwiki.com/"
	><code
	  >http://webhooks.pbwiki.com/</code
	  ></a
	></li
      ></ul
    ><p
    >When a RunDeck Job webhook notification is triggered, the server will send a POST request to one or more configured URLs. The request will contain XML content containing information about the Execution that has finished. The request will also contain special HTTP Headers to include some information about the notification and the Execution. You can also configure your URLs to have property tokens that will be replaced with specific details about the Job, Execution or Notification prior to the webhook request being submitted.</p
    ><div id="execution-notification-content"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.15.1</span
	  > Execution Notification Content</a
	></h3
      ><p
      >The content of the POST request will be XML, with a single <code
	>&lt;notification&gt;</code
	> root element. This element will contain <code
	>&lt;executions..&gt;&lt;execution&gt;...&lt;/execution&gt;&lt;/executions&gt;</code
	> content. This inner content is of the same format as the XML returned from the Web API for Execution information. See the chapter <a href="api/index.html#listing-running-executions"
	>API - Listing Running Executions</a
	> for more information.</p
      ><p
      >Attributes of the <code
	>notification</code
	> element will include:</p
      ><dl
      ><dt
	><code
	  >trigger</code
	  ></dt
	><dd
	><p
	  >The type of notification trigger. Either &quot;success&quot; or &quot;failure&quot;.</p
	  ></dd
	><dt
	><code
	  >executionId</code
	  ></dt
	><dd
	><p
	  >The ID of the Execution</p
	  ></dd
	><dt
	><code
	  >status</code
	  ></dt
	><dd
	><p
	  >The result status of the Execution. Either &quot;succeeded&quot;, &quot;failed&quot; or &quot;aborted&quot;.</p
	  ></dd
	></dl
      ><p
      ><em
	>Example</em
	></p
      ><pre
      ><code
	>&lt;notification trigger=&quot;success&quot; executionId=&quot;[ID]&quot; status=&quot;[STATUS]&quot;&gt;
    &lt;executions count=&quot;1&quot;&gt;
        &lt;execution ...&gt;
            ...
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/notification&gt;
</code
	></pre
      ></div
    ><div id="execution-notification-headers"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.15.2</span
	  > Execution Notification Headers</a
	></h3
      ><p
      >The POST request will also contain several custom HTTP headers, providing another way to receive some of the webhook information:</p
      ><dl
      ><dt
	><code
	  >X-RunDeck-Notification-Trigger</code
	  ></dt
	><dd
	><p
	  >The notification trigger type, either &quot;success&quot; or &quot;failure&quot;.</p
	  ></dd
	><dt
	><code
	  >X-RunDeck-Notification-Execution-ID</code
	  ></dt
	><dd
	><p
	  >The Execution ID</p
	  ></dd
	><dt
	><code
	  >X-RunDeck-Notification-Execution-Status</code
	  ></dt
	><dd
	><p
	  >The status of the execution, either &quot;succeeded&quot;, &quot;failed&quot;, or &quot;aborted&quot;.</p
	  ></dd
	></dl
      ></div
    ><div id="execution-notification-url-token-expansion"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.15.3</span
	  > Execution Notification URL Token Expansion</a
	></h3
      ><p
      >As well, the URLs configured for the webhook notification may contain tokens that will be expanded with values taken from the associated job and execution, such as <code
	>${job.name}</code
	>.</p
      ><p
      >Available tokens for expansion are:</p
      ><dl
      ><dt
	><code
	  >job.PROPERTY</code
	  ></dt
	><dd
	><p
	  >Properties about the Job, including:</p
	  ><dl
	  ><dt
	    ><code
	      >name</code
	      ></dt
	    ><dd
	    ><p
	      >the Job name</p
	      ></dd
	    ><dt
	    ><code
	      >group</code
	      ></dt
	    ><dd
	    ><p
	      >The Job group, or a blank string</p
	      ></dd
	    ><dt
	    ><code
	      >id</code
	      ></dt
	    ><dd
	    ><p
	      >the Job Id</p
	      ></dd
	    ><dt
	    ><code
	      >project</code
	      ></dt
	    ><dd
	    ><p
	      >the Project name</p
	      ></dd
	    ></dl
	  ></dd
	><dt
	><code
	  >execution.PROPERTY</code
	  ></dt
	><dd
	><p
	  >Properties about the Execution, including:</p
	  ><dl
	  ><dt
	    ><code
	      >id</code
	      ></dt
	    ><dd
	    ><p
	      >The Execution ID</p
	      ></dd
	    ><dt
	    ><code
	      >user</code
	      ></dt
	    ><dd
	    ><p
	      >The user who executed the job</p
	      ></dd
	    ><dt
	    ><code
	      >status</code
	      ></dt
	    ><dd
	    ><p
	      >The execution status, one of &quot;succeeded&quot;,&quot;failed&quot;,or &quot;aborted&quot;</p
	      ></dd
	    ></dl
	  ></dd
	><dt
	><code
	  >notification.trigger</code
	  ></dt
	><dd
	><p
	  >The trigger associated with the notification, one of &quot;success&quot; or &quot;failure&quot;.</p
	  ></dd
	></dl
      ><p
      >So for example, this URL:</p
      ><pre
      ><code
	>http://server/callback?id=${execution.id}&amp;status=${execution.status}&amp;trigger=${notification.trigger}
</code
	></pre
      ><p
      >Will have the tokens replaced with the appropriate values prior to making the webhook request.</p
      ></div
    ></div
  ></div
><div id="rundeck-api"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >9</span
      > RunDeck API</a
    ></h1
  ><p
  >RunDeck provides a Web API for use with your application.</p
  ><p
  >The API is defined in the document <a href="api/index.html"
    >RunDeck API</a
    >.</p
  ></div
><div id="rundeck-plugins"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >10</span
      > RunDeck Plugins</a
    ></h1
  ><p
  >Plugins for RunDeck contain new Providers for some of the Services used by the RunDeck core.</p
  ><p
  >RunDeck comes with some built-in providers for these services, but Plugins let you write your own, or use third-party implementations.</p
  ><p
  >RunDeck currently comes installed with a few useful plugins: script-plugin and stub-plugin. See <a href="#pre-installed-plugins"
    >Pre-installed plugins</a
    > for more info.</p
  ><div id="installing-plugins"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.1</span
	> Installing Plugins</a
      ></h2
    ><p
    >Installation of plugins is simple:</p
    ><p
    >Put the plugin file, such as <code
      >plugin.jar</code
      > or <code
      >some-plugin.zip</code
      >, into the RunDeck server's libext dir:</p
    ><pre
    ><code
      >cp some-plugin.zip $RDECK_BASE/libext
</code
      ></pre
    ><p
    >The plugin is now enabled, and any providers it defines can be used by nodes or projects.</p
    ><p
    >The RunDeck server does not have to be restarted.</p
    ></div
  ><div id="uninstalling-or-updating-plugins"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.2</span
	> Uninstalling or Updating Plugins</a
      ></h2
    ><p
    >You can simply remove the plugin files from <code
      >$RDECK_BASE/libext</code
      > to uninstall them.</p
    ><p
    >You can overwrite an old plugin with a newer version to update it.</p
    ></div
  ><div id="about-plugins"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.3</span
	> About Plugins</a
      ></h2
    ><p
    >Plugins are files that contain one or more Service Provider implementations. Each plugin file could contain multiple Providers for different types of services, however typically each plugin file would contain only providers related in some fashion.</p
    ><p
    >RunDeck includes a number of &quot;built-in&quot; providers, as well as a few &quot;included&quot; plugin files.</p
    ><p
    >In this document &quot;plugin&quot; and &quot;provider&quot; are used somewhat interchangably. When referring to an actual file containing the provider implementations we will say &quot;plugin file&quot;.</p
    ><div class="figure"
    ><img src="figures/fig1102.png" alt="RunDeck Providers and Plugin Files"
       /><p class="caption"
      >RunDeck Providers and Plugin Files</p
      ></div
    ></div
  ><div id="types-of-plugins"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.4</span
	> Types of Plugins</a
      ></h2
    ><p
    >RunDeck supports several different types of plugins to perform different kinds of services.</p
    ><div id="node-execution-plugins"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.4.1</span
	  > Node Execution Plugins</a
	></h3
      ><p
      >These plugins define ways of executing commands on nodes, and copying files to nodes.</p
      ><p
      >More information:</p
      ><ul
      ><li
	>Configuration: <a href="#node-execution-services"
	  >Node Execution Services</a
	  ></li
	><li
	>Lifecycle: <a href="#when-node-execution-service-providers-are-invoked"
	  >When Node Execution Service providers are invoked</a
	  ></li
	><li
	>Built-in Providers: <a href="#node-execution-services-1"
	  >Node Execution services</a
	  ></li
	><li
	>Included Plugins: <a href="#pre-installed-plugins"
	  >Pre-installed plugins</a
	  ></li
	></ul
      ></div
    ><div id="resource-model-source-plugins"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.4.2</span
	  > Resource Model Source Plugins</a
	></h3
      ><p
      >These plugins define mechanisms for retrieving Resource Model information from a specific kind of source (such as a URL, file, or set of files in a directory).</p
      ><p
      >More information:</p
      ><ul
      ><li
	>Configuration: <a href="#resource-model-sources"
	  >Resource Model Sources</a
	  ></li
	><li
	>Built-in Providers: <a href="#resource-model-sources-1"
	  >Resource Model Sources</a
	  ></li
	></ul
      ></div
    ><div id="resource-format-plugins"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.4.3</span
	  > Resource Format Plugins</a
	></h3
      ><p
      >These plugins define parsers and generators for different document formats, and are used by the Resource Model Source Plugins, as well as other parts of the RunDeck system.</p
      ><p
      >More information:</p
      ><ul
      ><li
	>Configuration: <a href="#resource-format-generators-and-parsers"
	  >Resource Format Generators and Parsers</a
	  ></li
	><li
	>Built-in Providers: <a href="#resource-format-services"
	  >Resource Format services</a
	  ></li
	></ul
      ></div
    ></div
  ><div id="about-services-and-providers"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.5</span
	> About Services and Providers</a
      ></h2
    ><p
    >The RunDeck core makes use of several different &quot;Services&quot; that provide functionality for the different steps necessary to execute workflows, jobs, and commands across multiple nodes.</p
    ><p
    >Each Service makes use of &quot;Providers&quot;. Each Provider has a unique &quot;Provider Name&quot; that is used to identify it, and most Services have default Providers unless you specify different ones to use.</p
    ><div class="figure"
    ><img src="figures/fig1101.png" alt="RunDeck Services and Providers"
       /><p class="caption"
      >RunDeck Services and Providers</p
      ></div
    ><p
    >Services fall into different categories, which determine how and where they are used.</p
    ><p
    ><em
      >Service Categories</em
      >:</p
    ><ol style="list-style-type: decimal;"
    ><li
      ><p
	><strong
	  >Node Execution services</strong
	  > - providers of these services operate in the context of a single Node definition, and can be configured at Node scope or higher:</p
	><ol style="list-style-type: decimal;"
	><li
	  >Node Executor - these providers define ways of executing a command on a Node (local or remote)</li
	  ><li
	  >File Copier - these providers define ways of copying files to a Node.</li
	  ></ol
	></li
      ><li
      ><p
	><strong
	  >Project services</strong
	  ></p
	><ol style="list-style-type: decimal;"
	><li
	  >Resource Model Source - (aka &quot;Resource Providers&quot;) these define ways of retrieving Node resources for a Project</li
	  ></ol
	></li
      ><li
      ><p
	><strong
	  >Global services</strong
	  > (framework level)</p
	><ol style="list-style-type: decimal;"
	><li
	  >Resource Format Parser - these define document format parsers</li
	  ><li
	  >Resource Format Generators - these define document format generators</li
	  ></ol
	></li
      ></ol
    ><p
    >Specifics of how providers of these plugins work is listed below.</p
    ><p
    >RunDeck Plugins can contain more than one Provider.</p
    ></div
  ><div id="using-providers"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.6</span
	> Using Providers</a
      ></h2
    ><div id="node-execution-services"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.1</span
	  > Node Execution Services</a
	></h3
      ><p
      >The two <em
	>Node services</em
	>, Node Executor and File Copier, are both configured similarly. They are configured for particular nodes on a node-specific basis, or set as a default provider for a project or for the system.</p
      ><p
      >If multiple providers are defined the most specific definition takes precedence in this order:</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Node specific</li
	><li
	>Project scope</li
	><li
	>Framework scope</li
	></ol
      ><div id="node-specific"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.6.1.1</span
	    > Node Specific</a
	  ></h4
	><p
	>To enable a provider for a node, add an attribute to the node definition.</p
	><p
	><em
	  >Node Executor provider attributes</em
	  >:</p
	><dl
	><dt
	  ><code
	    >node-executor</code
	    ></dt
	  ><dd
	  ><p
	    >specifies the provider name for a non-local node.</p
	    ></dd
	  ><dt
	  ><code
	    >local-node-executor</code
	    ></dt
	  ><dd
	  ><p
	    >specifies the provider name for the local (server) node.</p
	    ></dd
	  ></dl
	><p
	><em
	  >FileCopier provider attributes</em
	  >:</p
	><dl
	><dt
	  ><code
	    >file-copier</code
	    ></dt
	  ><dd
	  ><p
	    >specifies the provider by name for a non-local node.</p
	    ></dd
	  ><dt
	  ><code
	    >local-file-copier</code
	    ></dt
	  ><dd
	  ><p
	    >specifies the provider by name for the local (server) node.</p
	    ></dd
	  ></dl
	><p
	>Example Node in YAML specifying <code
	  >stub</code
	  > NodeExecutor and FileCopier:</p
	><pre
	><code
	  >remotehost:
    hostname: remotehost
    node-executor: stub
    file-copier: stub
</code
	  ></pre
	></div
      ><div id="project-or-framework-scope"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.6.1.2</span
	    > Project or Framework Scope</a
	  ></h4
	><p
	><em
	  >Node Executor</em
	  ></p
	><p
	>You can define the default connection providers to use for nodes at either the Project or Framework scope (or both). To do so, configure any of the following properties in the <code
	  >project.properties</code
	  > or the <code
	  >framework.properties</code
	  > files.</p
	><dl
	><dt
	  ><code
	    >service.NodeExecutor.default.provider</code
	    ></dt
	  ><dd
	  ><p
	    >Specifies the default NodeExecutor provider for remote nodes</p
	    ></dd
	  ><dt
	  ><code
	    >service.NodeExecutor.default.local.provider</code
	    ></dt
	  ><dd
	  ><p
	    >Specifies the default Node Executor provider for the local node.</p
	    ></dd
	  ></dl
	><p
	><em
	  >File Copier</em
	  ></p
	><dl
	><dt
	  ><code
	    >service.FileCopier.default.provider</code
	    ></dt
	  ><dd
	  ><p
	    >Specifies the default File Copier provider for remote nodes.</p
	    ></dd
	  ><dt
	  ><code
	    >service.FileCopier.default.local.provider</code
	    ></dt
	  ><dd
	  ><p
	    >Specifies the default File Copier provider for the local node.</p
	    ></dd
	  ></dl
	><p
	>Example <code
	  >project.properties</code
	  > to set default local providers to <code
	  >stub</code
	  >:</p
	><pre
	><code
	  >service.NodeExecutor.default.local.provider=stub
service.FileCopier.default.local.provider=stub
</code
	  ></pre
	></div
      ></div
    ><div id="resource-model-sources"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.2</span
	  > Resource Model Sources</a
	></h3
      ><p
      >The <em
	>Resource Model Sources</em
	> providers can be configured for a single project in the <code
	>project.properties</code
	> file.</p
      ><p
      >You can define multiple Resource Model Sources for the project, and can mix and match the specific providers depending on your needs.</p
      ><p
      >When you define multiple Source providers in a project, then the resulting set of Nodes will effectively be a merge of all the sources, in the order in which they are declared. This means that if two or more Sources provide a definition of a node with the same name, then the definition from lowest Source in the list will be used.</p
      ><p
      >The order that the providers are loaded (and thus the nodes are merged) is:</p
      ><ol style="list-style-type: decimal;"
      ><li
	><code
	  >project.resources.file</code
	  >: A File Model Source with default configuration.</li
	><li
	><code
	  >project.resources.url</code
	  >: A URL Model Source with default configuration. (optional)</li
	><li
	>All <code
	  >resources.source.N</code
	  > configurations in order starting at 1</li
	></ol
      ><div id="resource-model-source-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.6.2.1</span
	    > Resource Model Source configuration</a
	  ></h4
	><p
	>The <code
	  >project.properties</code
	  > file for each project allows you to configure the Resource Model Sources in these ways:</p
	><ul
	><li
	  >Define <code
	    >project.resources.file</code
	    > - this file path is used as a File Source path, with <em
	    >autogeneration</em
	    > and <em
	    >includeServerNode</em
	    > both true.</li
	  ><li
	  >Define <code
	    >project.resources.url</code
	    > - this URL is used as a URL Source url, with caching enabled</li
	  ></ul
	><p
	>You may also define a list of more sources in this way:</p
	><p
	>Starting at index <code
	  >1</code
	  >, define these properties for your Source numbered <code
	  >N</code
	  >:</p
	><pre
	><code
	  >resources.source.N.type=&lt;provider-name&gt;
resources.source.N.config.&lt;property&gt;=&lt;value&gt;
resources.source.N.config.&lt;property2&gt;=&lt;value2&gt;
...
</code
	  ></pre
	><p
	>Using one of the available Resource Model Source provider names for the <code
	  >&lt;provider-name&gt;</code
	  > value. For each Resource Model Source provider, you can specify the configuration properties for the source.</p
	><p
	>Example project.properties configuration of a default File provider, and two other providers:</p
	><pre
	><code
	  >project.resources.file=/home/rundeck/projects/example/etc/resources.xml

resources.source.1.type=url
resources.source.1.url=http://server/nodes.yaml

resources.source.2.type=directory
resources.source.2.directory=/home/rundeck/projects/example/resources
</code
	  ></pre
	></div
      ></div
    ><div id="resource-format-generators-and-parsers"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.3</span
	  > Resource Format Generators and Parsers</a
	></h3
      ><p
      >Resource Format Generators and Parsers define support for file formats that can be generated from or parsed into a set of Resource Node definitions.</p
      ><p
      >These are used by other parts of the system, such as the Resource Model Sources.</p
      ><p
      >There is no configuration necessary to use these providers, however the specific Provider Name that each generator and parser defines has to be known in order to make use of the provider. The specific Provider Name is used as the &quot;format name&quot; when you want to use the parser or generator.</p
      ><p
      >For example, to enable a particular Resource Format parser to be used by a File Resource Model Source (see <a href="#file-resource-model-source-configuration"
	>File Resource Model Source Configuration</a
	>), you should specify the Provider Name for the parser as the format for the source:</p
      ><pre
      ><code
	>resources.source.1.format=myformat
</code
	></pre
      ><p
      >This would specify the use of &quot;myformat&quot; provider.</p
      ><p
      >In other cases, the exact name of the provider may not be known (for example when loading content from a remote URL). Each Generator and Parser must define a list of MIME Type strings and file extensions that they support. These are used to determine which parser/generator is to be used.</p
      ></div
    ></div
  ><div id="when-node-execution-service-providers-are-invoked"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.7</span
	> When Node Execution Service providers are invoked</a
      ></h2
    ><p
    >RunDeck executes Command items on Nodes. The command may be part of a Workflow as defined in a Job, and it may be executed multiple times on different nodes.</p
    ><p
    >Currently three &quot;kinds&quot; of Command items can be specified in Workflows:</p
    ><ol style="list-style-type: decimal;"
    ><li
      >&quot;exec&quot; commands - simple system command strings</li
      ><li
      >&quot;script&quot; commands - either embedded script content, or server-local script files can be sent to the specified node and then executed with a set of input arguments.</li
      ><li
      >&quot;jobref&quot; commands - references to other Jobs by name that will be executed with a set of input arguments.</li
      ></ol
    ><p
    >RunDeck uses the NodeExecutor and FileCopier services as part of the process of executing these command types.</p
    ><p
    >The procedure for executing an &quot;exec&quot; command is:</p
    ><ol style="list-style-type: decimal;"
    ><li
      >load the NodeExecutor provider for the node and context</li
      ><li
      >call the NodeExecutor#executeCommand method</li
      ></ol
    ><p
    >The procedure for executing a &quot;script&quot; command is:</p
    ><ol style="list-style-type: decimal;"
    ><li
      >load the FileCopier provider for the node and context</li
      ><li
      >call the FileCopier#copy* method</li
      ><li
      >load the NodeExecutor provider for the node and context</li
      ><li
      >Possibly execute an intermediate command (such as &quot;chmod +x&quot; on the copied file)</li
      ><li
      >execute the NodeExecutor#executeCommand method, passing the filepath of the copied file, and any arguments to the script command.</li
      ></ol
    ></div
  ><div id="built-in-providers"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.8</span
	> Built-in providers</a
      ></h2
    ><p
    >RunDeck uses a few built-in providers to provide the default service:</p
    ><div id="node-execution-services-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.8.1</span
	  > Node Execution services</a
	></h3
      ><p
      >For NodeExecutor, these providers:</p
      ><dl
      ><dt
	><code
	  >local</code
	  ></dt
	><dd
	><p
	  >local execution of a command</p
	  ></dd
	><dt
	><code
	  >jsch-ssh</code
	  ></dt
	><dd
	><p
	  >remote execution of a command via SSH, requiring the &quot;hostname&quot;, and &quot;username&quot; attributes on a node.</p
	  ></dd
	></dl
      ><p
      >For FileCopier, these providers:</p
      ><dl
      ><dt
	><code
	  >local</code
	  ></dt
	><dd
	><p
	  >creates a local temp file for a script</p
	  ></dd
	><dt
	><code
	  >jsch-scp</code
	  ></dt
	><dd
	><p
	  >remote copy of a command via SCP, requiring the &quot;hostname&quot; and &quot;username&quot; attributes on a node.</p
	  ></dd
	></dl
      ><div id="ssh-provider"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.8.1.1</span
	    > SSH Provider</a
	  ></h4
	><p
	>The SSH Node Executor and File Copier are included as the default providers for RunDeck.</p
	><p
	>Out of the box typical node configuration to make use of these is simple.</p
	><ul
	><li
	  >Set the <code
	    >hostname</code
	    > attribute for the nodes. It can be in the format &quot;hostname:port&quot; to indicate that a non-default port should be used. The default port is 22.</li
	  ><li
	  >Set the <code
	    >username</code
	    > attribute for the nodes to the username to connect to the remote node.</li
	  ><li
	  >set up public/private key authentication from the RunDeck server to the nodes</li
	  ></ul
	><p
	>This will allow remote command and script execution on the nodes.</p
	><p
	>See below for more configuration options.</p
	><p
	><strong
	  >Sudo Password Authentication</strong
	  ></p
	><p
	>The SSH Provider also includes support for a secondary Sudo Password Authentication. This simulates a user writing a password to the terminal into a password prompt when invoking a &quot;sudo&quot; command that requires password authentication.</p
	><div id="configuring-scp-file-copier"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >10.8.1.1.1</span
	      > Configuring SCP File Copier</a
	    ></h5
	  ><p
	  >In addition to the general SSH configuration mentioned for in this section, some additional configuration can be done for SCP.</p
	  ><p
	  >When a Script is executed on a remote node, it is copied over via SCP first, and then executed. In addition to the SSH connection properties, these node attributes can be configured for SCP:</p
	  ><ul
	  ><li
	    ><code
	      >file-copy-destination-dir</code
	      >: The directory on the remote node to copy the script file to before executing it. The default value is <code
	      >C:/WINDOWS/TEMP/</code
	      > on Windows nodes, and <code
	      >/tmp</code
	      > for other nodes.</li
	    ><li
	    ><code
	      >osFamily</code
	      >: specify &quot;windows&quot; for windows nodes.</li
	    ></ul
	  ></div
	><div id="configuring-ssh-authentication-type"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >10.8.1.1.2</span
	      > Configuring SSH Authentication type</a
	    ></h5
	  ><p
	  >SSH authentication can be done in two ways, via password or public/private key.</p
	  ><p
	  >By default, public/private key is used, but this can be changed on a node, project, or framework scope.</p
	  ><p
	  >The mechanism used is determined by the <code
	    >ssh-authentication</code
	    > property. This property can have two different values:</p
	  ><ul
	  ><li
	    ><code
	      >password</code
	      ></li
	    ><li
	    ><code
	      >privateKey</code
	      > (default)</li
	    ></ul
	  ><p
	  >When connecting to a particular Node, this sequence is used to determine the correct authentication mechanism:</p
	  ><ol style="list-style-type: decimal;"
	  ><li
	    ><strong
	      >Node level</strong
	      >: <code
	      >ssh-authentication</code
	      > attribute on the Node. Applies only to the target node.</li
	    ><li
	    ><strong
	      >Project level</strong
	      >: <code
	      >project.ssh-authentication</code
	      > property in <code
	      >project.properties</code
	      >. Applies to any project node by default.</li
	    ><li
	    ><strong
	      >RunDeck level</strong
	      >: <code
	      >framework.ssh-authentication</code
	      > property in <code
	      >framework.properties</code
	      >. Applies to all projects by default.</li
	    ></ol
	  ><p
	  >If none of those values are set, then the default public/private key authentication is used.</p
	  ></div
	><div id="configuring-ssh-username"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >10.8.1.1.3</span
	      > Configuring SSH Username</a
	    ></h5
	  ><p
	  >The username used to connect via SSH is taken from the <code
	    >username</code
	    > Node attribute:</p
	  ><ul
	  ><li
	    ><code
	      >username=&quot;user1&quot;</code
	      ></li
	    ></ul
	  ><p
	  >This value can also include a property reference if you want to dynamically change it, for example to the name of the current RunDeck user, or the username submitted as a Job Option value:</p
	  ><ul
	  ><li
	    ><code
	      >${job.username}</code
	      > - uses the username of the user executing the RunDeck execution.</li
	    ><li
	    ><code
	      >${option.someUsername}</code
	      > - uses the value of a job option named &quot;someUsername&quot;.</li
	    ></ul
	  ><p
	  >If the <code
	    >username</code
	    > node attribute is not set, then the static value provided via project or framework configuration is used. The username for a node is determined by looking for a value in this order:</p
	  ><ol style="list-style-type: decimal;"
	  ><li
	    ><strong
	      >Node level</strong
	      >: <code
	      >username</code
	      > node attribute. Can contain property references to dynamically set it from Option or Execution values.</li
	    ><li
	    ><strong
	      >Project level</strong
	      >: <code
	      >project.ssh.user</code
	      > property in <code
	      >project.properties</code
	      > file for the project.</li
	    ><li
	    ><strong
	      >RunDeck level</strong
	      >: <code
	      >framework.ssh.user</code
	      > property in <code
	      >framework.properties</code
	      > file for the RunDeck installation.</li
	    ></ol
	  ></div
	><div id="configuring-ssh-private-keys"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >10.8.1.1.4</span
	      > Configuring SSH private keys</a
	    ></h5
	  ><p
	  >The default authentication mechanism is public/private key.</p
	  ><p
	  >The built-in SSH connector allows the private key to be specified in several different ways. You can configure it per-node, per-project, or per-RunDeck instance.</p
	  ><p
	  >When connecting to the remote node, RunDeck will look for a property/attribute specifying the location of the private key file, in this order, with the first match having precedence:</p
	  ><ol style="list-style-type: decimal;"
	  ><li
	    ><strong
	      >Node level</strong
	      >: <code
	      >ssh-keypath</code
	      > attribute on the Node. Applies only to the target node.</li
	    ><li
	    ><strong
	      >Project level</strong
	      >: <code
	      >project.ssh-keypath</code
	      > property in <code
	      >project.properties</code
	      >. Applies to any project node by default.</li
	    ><li
	    ><strong
	      >RunDeck level</strong
	      >: <code
	      >framework.ssh-keypath</code
	      > property in <code
	      >framework.properties</code
	      >. Applies to all projects by default.</li
	    ><li
	    ><strong
	      >RunDeck level</strong
	      >: <code
	      >framework.ssh.keypath</code
	      > property in <code
	      >framework.properties</code
	      >. Applies to all projects by default (included for compatibility with Rundeck &lt; 1.3). (default value: <code
	      >~/.ssh/id_rsa</code
	      >).</li
	    ></ol
	  ></div
	><div id="configuring-ssh-password-authentication"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >10.8.1.1.5</span
	      > Configuring SSH Password Authentication</a
	    ></h5
	  ><p
	  >Password authentication works in the following way:</p
	  ><ul
	  ><li
	    >A Job must be defined specifying a Secure Option to prompt the user for the password</li
	    ><li
	    >Target nodes must be configured for password authentication</li
	    ><li
	    >When the user executes the Job, they are prompted for the password. The Secure Option value for the password is not stored in the database, and is used only for that execution.</li
	    ></ul
	  ><p
	  >Therefore Password authentication has several requirements and some limitations:</p
	  ><ol style="list-style-type: decimal;"
	  ><li
	    >Password-authenticated nodes can only be executed on via a defined Job, not via Ad-hoc commands (yet).</li
	    ><li
	    >Each Job that will execute on password-authenticated Nodes must define a Secure Option to prompt the user for the password before execution.</li
	    ><li
	    >All Nodes using password authentication for a Job must have an equivalent Secure Option defined, or may use the same option name (or the default) if they share authentication passwords.</li
	    ></ol
	  ><p
	  >Passwords for the nodes are input either via the GUI or arguments to the job if executed via CLI or API.</p
	  ><p
	  >To enable SSH Password authentication, first make sure the <code
	    >ssh-authentication</code
	    > value is set as described in <a href="#configuring-ssh-authentication-type"
	    >Configuring SSH Authentication type</a
	    >.</p
	  ><p
	  >Next, configure a Job, and include an Option definition where <code
	    >secureInput</code
	    > is set to <code
	    >true</code
	    >. The name of this option can be anything you want, but the default value of <code
	    >sshPassword</code
	    > assumed by the node configuration is easiest.</p
	  ><p
	  >If the value is not <code
	    >sshPassword</code
	    >, then make sure to set the following attribute on each Node for password authentication:</p
	  ><ul
	  ><li
	    ><code
	      >ssh-password-option</code
	      > = &quot;<code
	      >option.NAME</code
	      >&quot; where NAME is the name of the Job's secure option.</li
	    ></ul
	  ><p
	  >An example Node and Job option configuration are below:</p
	  ><pre
	  ><code
	    >&lt;node name=&quot;egon&quot; description=&quot;egon&quot; osFamily=&quot;unix&quot;
    username=&quot;rundeck&quot;
    hostname=&quot;egon&quot;
    ssh-authentication=&quot;password&quot;
    ssh-password-option=&quot;option.sshPassword1&quot; /&gt;
</code
	    ></pre
	  ><p
	  >Job:</p
	  ><pre
	  ><code
	    >&lt;joblist&gt;
    &lt;job&gt;
        ...
        &lt;context&gt;
          &lt;project&gt;project&lt;/project&gt;
          &lt;options&gt;
            &lt;option required='true' name='sshPassword1' secure='true' /&gt;
          &lt;/options&gt;
        &lt;/context&gt;
        ...
    &lt;/job&gt;
&lt;/joblist&gt;
</code
	    ></pre
	  ></div
	><div id="configuring-secondary-sudo-password-authentication"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >10.8.1.1.6</span
	      > Configuring Secondary Sudo Password Authentication</a
	    ></h5
	  ><p
	  >The SSH provider supports a secondary authentication mechanism: Sudo password authentication. This is useful if your security requirements are such that you require the SSH connection to be under a specific user's account instead of a generic &quot;rundeck&quot; account, and you still need to allow &quot;sudo&quot; level commands to be executed requiring a password to be entered.</p
	  ><p
	  >This works in the following way:</p
	  ><ul
	  ><li
	    >On Job execution, the user is prompted to enter a Sudo password</li
	    ><li
	    >After connecting to the remote node via SSH, a command requiring &quot;sudo&quot; authentication is issued, such as &quot;sudo -u otheruser /sbin/some-command&quot;</li
	    ><li
	    >The remote node will prompt for a sudo password, expecting user input</li
	    ><li
	    >The SSH Provider will write the password to the remote node</li
	    ><li
	    >The sudo command will execute as if a user had entered the command</li
	    ></ul
	  ><p
	  >Similarly to SSH Password authentication, Sudo Password Authentication requires:</p
	  ><ul
	  ><li
	    >A Job must be defined specifying a Secure Option to prompt the user for the password</li
	    ><li
	    >Target nodes must be configured for Sudo authentication</li
	    ><li
	    >When the user executes the Job, they are prompted for the password. The Secure Option value for the password is not stored in the database, and is used only for that execution.</li
	    ></ul
	  ><p
	  >Therefore Sudo Password Authentication has several requirements and some limitations:</p
	  ><ol style="list-style-type: decimal;"
	  ><li
	    >Sudo Password authenticated nodes can only be executed on via a defined Job, not via Ad-hoc commands (yet).</li
	    ><li
	    >Each Job that will execute on Sudo Password Authenticated Nodes must define a Secure Option to prompt the user for the Sudo password before execution.</li
	    ><li
	    >All Nodes using Sudo password authentication for a Job must have an equivalent Secure Option defined, or may use the same option name (or the default) if they share sudo authentication passwords.</li
	    ></ol
	  ><p
	  >Passwords for the nodes are input either via the GUI or arguments to the job if executed via CLI or API.</p
	  ><p
	  >To enable Sudo Password Authentication, set the <code
	    >sudo-command-enabled</code
	    > to <code
	    >true</code
	    > for each node.</p
	  ><ul
	  ><li
	    ><code
	      >sudo-command-enabled</code
	      > - set to &quot;true&quot; to enable Sudo Password Authentication: <em
	      >required</em
	      >.</li
	    ></ul
	  ><p
	  >You can also configure these attributes, which also have equivalent properties to set at the Project and RunDeck scopes. Simply set the <code
	    >project.NAME</code
	    > in project.properties, or <code
	    >framework.NAME</code
	    > in framework.properties:</p
	  ><ul
	  ><li
	    ><code
	      >sudo-command-pattern</code
	      > - a regular expression to detect when a command execution should expect to require Sudo authentication. Default pattern is <code
	      >^sudo$</code
	      >.</li
	    ><li
	    ><code
	      >sudo-password-option</code
	      > - an option reference (&quot;option.NAME&quot;) to define which secure option value to use as password. The default is <code
	      >option.sudoPassword</code
	      >.</li
	    ><li
	    ><code
	      >sudo-prompt-pattern</code
	      > - a regular expression to detect the password prompt for the Sudo authentication. The default pattern is <code
	      >^\[sudo\] password for .+: .*</code
	      ></li
	    ><li
	    ><code
	      >sudo-failure-pattern</code
	      > - a regular expression to detect the password failure response. The default pattern is <code
	      >^.*try again.*</code
	      >.</li
	    ><li
	    ><code
	      >sudo-prompt-max-lines</code
	      > - maximum lines to read when expecting the password prompt. (default: <code
	      >12</code
	      >).</li
	    ><li
	    ><code
	      >sudo-prompt-max-timeout</code
	      > - maximum milliseconds to wait for input when expecting the password prompt. (default <code
	      >5000</code
	      >)</li
	    ><li
	    ><code
	      >sudo-response-max-lines</code
	      > - maximum lines to read when looking for failure response. (default: <code
	      >2</code
	      >).</li
	    ><li
	    ><code
	      >sudo-response-max-timeout</code
	      > - maximum milliseconds to wait for response when detecting the failure response. (default <code
	      >5000</code
	      >)</li
	    ><li
	    ><code
	      >sudo-fail-on-prompt-max-lines</code
	      > - true/false. If true, fail execution if max lines are reached looking for password prompt. (default: <code
	      >false</code
	      >)</li
	    ><li
	    ><code
	      >sudo-success-on-prompt-threshold</code
	      > - true/false. If true, succeed (without writing password), if the input max lines are reached without detecting password prompt. (default: <code
	      >true</code
	      >).</li
	    ><li
	    ><code
	      >sudo-fail-on-prompt-timeout</code
	      > - true/false. If true, fail execution if timeout reached looking for password prompt. (default: <code
	      >true</code
	      >)</li
	    ><li
	    ><code
	      >sudo-fail-on-response-timeout</code
	      > - true/false. If true, fail on timeout looking for failure message. (default: <code
	      >false</code
	      >)</li
	    ></ul
	  ><p
	  >Note: the default values have been set for the unix &quot;sudo&quot; command, but can be overridden if you need to customize the interaction.</p
	  ><p
	  >Next, configure a Job, and include an Option definition where <code
	    >secureInput</code
	    > is set to <code
	    >true</code
	    >. The name of this option can be anything you want, but the default value of <code
	    >sudoPassword</code
	    > recognized by the plugin can be used.</p
	  ><p
	  >If the value is not <code
	    >sudoPassword</code
	    >, then make sure to set the following attribute on each Node for password authentication:</p
	  ><ul
	  ><li
	    ><code
	      >sudo-password-option</code
	      > = &quot;<code
	      >option.NAME</code
	      >&quot; where NAME is the name of the Job's secure option.</li
	    ></ul
	  ><p
	  >An example Node and Job option configuration are below:</p
	  ><pre
	  ><code
	    >&lt;node name=&quot;egon&quot; description=&quot;egon&quot; osFamily=&quot;unix&quot;
    username=&quot;rundeck&quot;
    hostname=&quot;egon&quot;
    sudo-command-enabled=&quot;true&quot;
    sudo-password-option=&quot;option.sudoPassword2&quot; /&gt;
</code
	    ></pre
	  ><p
	  >Job:</p
	  ><pre
	  ><code
	    >&lt;joblist&gt;
    &lt;job&gt;
         &lt;sequence keepgoing='false' strategy='node-first'&gt;
          &lt;command&gt;
            &lt;exec&gt;sudo apachectl restart&lt;/exec&gt;
          &lt;/command&gt;
        &lt;/sequence&gt;

        &lt;context&gt;
          &lt;project&gt;project&lt;/project&gt;
          &lt;options&gt;
            &lt;option required='true' name='sudoPassword2' secure='true' description=&quot;Sudo authentication password&quot;/&gt;
          &lt;/options&gt;
        &lt;/context&gt;
        ...
    &lt;/job&gt;
&lt;/joblist&gt;
</code
	    ></pre
	  ></div
	></div
      ></div
    ><div id="resource-model-sources-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.8.2</span
	  > Resource Model Sources</a
	></h3
      ><p
      >RunDeck includes these built-in providers in the core installation:</p
      ><dl
      ><dt
	><code
	  >file</code
	  ></dt
	><dd
	><p
	  >Uses a file on the file system, in any of the supported Resources formats.</p
	  ></dd
	><dt
	><code
	  >url</code
	  ></dt
	><dd
	><p
	  >GETs a URL, and expects one of the supported Resources formats.</p
	  ></dd
	><dt
	><code
	  >directory</code
	  ></dt
	><dd
	><p
	  >looks at all files in a directory for suppored file extensions, and internally uses the <code
	    >file</code
	    > provider for each file that matches.</p
	  ></dd
	><dt
	><code
	  >script</code
	  ></dt
	><dd
	><p
	  >Executes a script and parses the output as one of the supported formats</p
	  ></dd
	></dl
      ><p
      >To configure these providers, refer to <a href="#resource-model-source-configuration"
	>Resource Model Source configuration</a
	> and use the following configuration properties.</p
      ><div id="file-resource-model-source-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.8.2.1</span
	    > File Resource Model Source Configuration</a
	  ></h4
	><p
	>The <code
	  >file</code
	  > Resource Model Source provider reads a file in one of the supported <a href="#resource-model-document-formats"
	  >Resource Model Document Formats</a
	  >.</p
	><table
	><caption
	  >Configuration properties for <code
	    >file</code
	    > Resource Model Source provider</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Name</th
	      ><th align="left"
	      >Value</th
	      ><th align="left"
	      >Notes</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>file</code
		></td
	      ><td align="left"
	      >file path</td
	      ><td align="left"
	      >Path to a file on disk.</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>format</code
		></td
	      ><td align="left"
	      >format name</td
	      ><td align="left"
	      >Can be used to declare the format explicitly. Otherwise the format is determined from the <code
		>file</code
		>'s extension.</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>requireFileExists</code
		></td
	      ><td align="left"
	      >true/false</td
	      ><td align="left"
	      >If true and the file is missing, causes a failure to load the nodes. (Default: false)</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>includeServerNode</code
		></td
	      ><td align="left"
	      >true/false</td
	      ><td align="left"
	      >If true, include the Project's server node automatically. (Default: false)</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>generateFileAutomatically</code
		></td
	      ><td align="left"
	      >true/false</td
	      ><td align="left"
	      >If true, create the file automatically if it is missing. (Default: false)</td
	      ></tr
	    ></tbody
	  ></table
	><p
	>The value of <code
	  >format</code
	  > must be one of the supported <a href="#resource-model-document-formats"
	  >Resource Model Document Formats</a
	  >. The built-in formats are: <code
	  >resourcexml</code
	  > or <code
	  >resourceyaml</code
	  >, but any format provided by a <a href="#resource-format-plugins"
	  >Resource Format Plugin</a
	  > can be specified as well.</p
	><p
	><em
	  >Example:</em
	  ></p
	><pre
	><code
	  >resources.source.1.type=file
resources.source.1.file=/home/rundeck/projects/example/etc/resources2.xml
resources.source.1.format=resourcexml
resources.source.1.requireFileExists=true
resources.source.1.includeServerNode=true
resources.source.1.generateFileAutomatically=true
</code
	  ></pre
	></div
      ><div id="url-resource-model-source-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.8.2.2</span
	    > URL Resource Model Source Configuration</a
	  ></h4
	><p
	>The <code
	  >url</code
	  > Resource Model Source provider performs a HTTP GET request to retrieve the Nodes definition.</p
	><p
	>Configuration properties:</p
	><table
	><caption
	  >Configuration properties for <code
	    >url</code
	    > Resource Model Source provider</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Name</th
	      ><th align="left"
	      >Value</th
	      ><th align="left"
	      >Notes</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>url</code
		></td
	      ><td align="left"
	      >URL</td
	      ><td align="left"
	      >A valid URL, either <code
		>http:</code
		>, <code
		>https:</code
		> or <code
		>file:</code
		> protocol.</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>cache</code
		></td
	      ><td align="left"
	      >true/false</td
	      ><td align="left"
	      >If true, use ETag/Last-Modified information from the server to only download new content if it has changed. If false, always download the content. (Default: true)</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>timeout</code
		></td
	      ><td align="left"
	      >seconds</td
	      ><td align="left"
	      >Number of seconds before request fails due to timeout. <code
		>0</code
		> means no timeout. (Default: 30)</td
	      ></tr
	    ></tbody
	  ></table
	><p
	>The <a href="#resource-model-document-formats"
	  >Resource Model Document Format</a
	  > that is used is determined by the MIME type sent by the remote server. The built-in formats accept &quot;*/xml&quot; and &quot;*/yaml&quot; and &quot;*/x-yaml&quot;. See <a href="#resource-format-plugins"
	  >Resource Format Plugin</a
	  >.</p
	><p
	><em
	  >Example:</em
	  ></p
	><pre
	><code
	  >resources.source.1.type=url
resources.source.1.url=file:/home/rundeck/projects/example/etc/resources2.xml
resources.source.1.cache=true
resources.source.1.timeout=0
</code
	  ></pre
	></div
      ><div id="directory-resource-model-source-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.8.2.3</span
	    > Directory Resource Model Source Configuration</a
	  ></h4
	><p
	>The <code
	  >directory</code
	  > Resource Model Source provider lists all files in a directory, and loads each one that has a supported file extension as File Resource Model Source with all default configuration options.</p
	><table
	><caption
	  >Configuration properties for <code
	    >directory</code
	    > Resource Model Source provider</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Name</th
	      ><th align="left"
	      >Value</th
	      ><th align="left"
	      >Notes</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>directory</code
		></td
	      ><td align="left"
	      >directory path</td
	      ><td align="left"
	      >All files in the directory that have a supported file extension will be loaded</td
	      ></tr
	    ></tbody
	  ></table
	><p
	><em
	  >Example:</em
	  ></p
	><pre
	><code
	  >resources.source.2.type=directory
resources.source.2.directory=/home/rundeck/projects/example/resources
</code
	  ></pre
	></div
      ><div id="script-resource-model-source-configuration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.8.2.4</span
	    > Script Resource Model Source Configuration</a
	  ></h4
	><p
	>The <code
	  >script</code
	  > Resource Model Source provider executes a script file and reads the output of the script as one of the supported <a href="#resource-model-document-formats"
	  >Resource Model Document Formats</a
	  >.</p
	><table
	><caption
	  >Configuration properties for <code
	    >script</code
	    > Resource Model Source provider</caption
	  ><thead
	  ><tr class="header"
	    ><th align="left"
	      >Name</th
	      ><th align="left"
	      >Value</th
	      ><th align="left"
	      >Notes</th
	      ></tr
	    ></thead
	  ><tbody
	  ><tr class="odd"
	    ><td align="left"
	      ><code
		>file</code
		></td
	      ><td align="left"
	      >Script file path</td
	      ><td align="left"
	      >If required by the <code
		>interpreter</code
		>, the file should be executable</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>interpreter</code
		></td
	      ><td align="left"
	      >Command or interpreter to use</td
	      ><td align="left"
	      >e.g. &quot;bash -c&quot;</td
	      ></tr
	    ><tr class="odd"
	    ><td align="left"
	      ><code
		>args</code
		></td
	      ><td align="left"
	      >Additional arguments to pass</td
	      ><td align="left"
	      >The arguments will be added after the script file name to the executed commandline</td
	      ></tr
	    ><tr class="even"
	    ><td align="left"
	      ><code
		>format</code
		></td
	      ><td align="left"
	      >Format name</td
	      ><td align="left"
	      >Must be used to declare the format explicitly.</td
	      ></tr
	    ></tbody
	  ></table
	><p
	>The script will be executed in this way:</p
	><pre
	><code
	  >[interpreter] file [args]
</code
	  ></pre
	><p
	>All output on STDOUT will be passed to a Resource Format Parser to parse. The format specified must be available.</p
	><p
	><em
	  >Example:</em
	  ></p
	><pre
	><code
	  >resources.source.2.type=script
resources.source.2.file=/home/rundeck/projects/example/etc/generate.sh
resources.source.2.interpreter=bash -c
resources.source.2.args=-project example
resources.source.2.format=resourceyaml
</code
	  ></pre
	></div
      ></div
    ><div id="resource-format-services"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.8.3</span
	  > Resource Format services</a
	></h3
      ><p
      >Resource Format services (Generators and Parsers) typically come in matched pairs, with both a parser and generator for the same format name.</p
      ><p
      >RunDeck includes these built-in providers in the core installation:</p
      ><dl
      ><dt
	><code
	  >resourcexml</code
	  ></dt
	><dd
	><p
	  >Supports the Resource XML document format: <a href="resource-v13.html"
	    >resource-v13(5) XML</a
	    >.</p
	  ><p
	  >Supported MIME types:</p
	  ><ul
	  ><li
	    >Generator: &quot;text/xml&quot;</li
	    ><li
	    >Parser: &quot;*/xml&quot;</li
	    ></ul
	  ><p
	  >Supported File extensions:</p
	  ><ul
	  ><li
	    >&quot;.xml&quot;</li
	    ></ul
	  ></dd
	><dt
	><code
	  >resourceyaml</code
	  ></dt
	><dd
	><p
	  >Supports the Resource YAML document format: <a href="resource-yaml-v13.html"
	    >resource-v13(5) YAML</a
	    >.</p
	  ><p
	  >Supported MIME types:</p
	  ><ul
	  ><li
	    >Generator: &quot;text/yaml&quot;, &quot;text/x-yaml&quot;, &quot;application/yaml&quot;, &quot;application/x-yaml&quot;</li
	    ><li
	    >Parser: &quot;*/yaml&quot;, &quot;*/x-yaml&quot;</li
	    ></ul
	  ><p
	  >Supported File extensions:</p
	  ><ul
	  ><li
	    >&quot;.yml&quot;, &quot;.yaml&quot;</li
	    ></ul
	  ></dd
	></dl
      ></div
    ></div
  ><div id="pre-installed-plugins"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.9</span
	> Pre-installed plugins</a
      ></h2
    ><p
    >RunDeck comes with two pre-installed plugins that may be useful, and also serve as examples of plugin development and usage.</p
    ><div id="script-plugin"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.9.1</span
	  > script-plugin</a
	></h3
      ><p
      >The <code
	>script-plugin</code
	> includes these providers:</p
      ><ul
      ><li
	><code
	  >script-exec</code
	  > for the NodeExecutor service</li
	><li
	><code
	  >script-copy</code
	  > for the FileCopier service</li
	></ul
      ><p
      >(Refer to <a href="#using-providers"
	>Using Providers</a
	> to enable them.)</p
      ><p
      >This plugin provides the ability to specify an external script or command to perform a remote or local execution of a Rundeck command, and remote or local file copies.</p
      ><p
      >It can be a replacement for the built-in SSH-based remote execution and SCP-based file-copy mechanism to allow you to user whatever external mechanism you wish.</p
      ><p
      >Note: this plugin offers similar functionality to the <a href="#script-plugin-development"
	>Script Plugin Development</a
	> model. You may want to use this plugin to test your scripts, and then later package them into a standalone plugin using that model.</p
      ><div id="configuring-script-exec"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.1</span
	    > Configuring script-exec</a
	  ></h4
	><p
	>To configure the plugin you must specify a commandline string to execute. Optionally you may specify a directory to be used as the working directory when executing the commandline string, and a shell to invoke the command.</p
	><p
	>You can configure these across all projects (framework-wide), a single project (project-wide), or specifically for each node, with the most specific configuration value taking precedence.</p
	></div
      ><div id="configuring-the-command-for-script-exec"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.2</span
	    > Configuring the command for script-exec</a
	  ></h4
	><p
	>For Framework and Project-wide, configure a property in either the framework.properties or project.properties files:</p
	><dl
	><dt
	  ><code
	    >plugin.script-exec.default.command</code
	    ></dt
	  ><dd
	  >Specifies the default system command to run</dd
	  ></dl
	><p
	>For node-specific add an attribute named <code
	  >script-exec</code
	  > to the node.</p
	><dl
	><dt
	  ><code
	    >script-exec</code
	    ></dt
	  ><dd
	  >Specifies the system command to run</dd
	  ></dl
	><p
	>See <a href="#defining-the-script-exec-command"
	  >Defining the script-exec command</a
	  > for what to specify for this property.</p
	></div
      ><div id="configuring-the-working-directory"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.3</span
	    > Configuring the working directory</a
	  ></h4
	><p
	>For Framework and Project-wide, configure a property in either the framework.properties or project.properties files:</p
	><dl
	><dt
	  ><code
	    >plugin.script-exec.default.dir</code
	    ></dt
	  ><dd
	  >Specifies the default working directory for the execution</dd
	  ></dl
	><p
	>For node-specific add an attribute named <code
	  >script-exec-dir</code
	  > to the node.</p
	><dl
	><dt
	  ><code
	    >script-exec-dir</code
	    ></dt
	  ><dd
	  >Specifies the default working directory for the execution (optional)</dd
	  ></dl
	></div
      ><div id="configuring-the-shell"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.4</span
	    > Configuring the shell</a
	  ></h4
	><p
	>For Framework and Project-wide, configure a property in either the framework.properties or project.properties files:</p
	><dl
	><dt
	  ><code
	    >plugin.script-exec.default.shell</code
	    ></dt
	  ><dd
	  >Specifies the shell to use to interpret the command, e.g. &quot;bash -c&quot; or &quot;cmd.exe /c&quot;</dd
	  ></dl
	><p
	>For node-specific add an attribute named <code
	  >script-exec-shell</code
	  > to the node.</p
	><dl
	><dt
	  ><code
	    >script-exec-shell</code
	    ></dt
	  ><dd
	  >Specifies the shell to use to interpret the command, e.g. &quot;bash -c&quot; or &quot;cmd.exe /c&quot; (optional)</dd
	  ></dl
	></div
      ><div id="defining-the-script-exec-command"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.5</span
	    > Defining the script-exec command</a
	  ></h4
	><p
	>The value of this property or attribute should be the complete commandline string to execute in an external system process.</p
	><p
	>You can use <em
	  >Data context properties</em
	  > as you can in normal Rundeck command execution, such as <code
	  >${node.name}</code
	  > or <code
	  >${job.name}</code
	  >.</p
	><p
	>In addition, the plugin provides these new data context properties:</p
	><dl
	><dt
	  ><code
	    >exec.command</code
	    ></dt
	  ><dd
	  ><p
	    >The command that the workflow/user has specified to run on the node</p
	    ></dd
	  ><dt
	  ><code
	    >exec.dir</code
	    ></dt
	  ><dd
	  ><p
	    >The working directory path if it is configured for the node or in a properties file</p
	    ></dd
	  ></dl
	><p
	>Example:</p
	><p
	>If you wanted to run some external remote connection command (&quot;/bin/execremote&quot;) in lieu of the built-in ssh command, you could specify these attributes for node:</p
	><pre
	><code
	  >mynode:
    node-executor: script-exec
    script-exec: /bin/execremote -host ${node.hostname} -user ${node.username} -- ${exec.command}
</code
	  ></pre
	><p
	>If the command you want to run requires special handling (such as quoting or other interpretation) you may want to have a shell execute it. In which case you could specify the shell to use:</p
	><pre
	><code
	  >mynode:
    node-executor: script-exec
    script-exec-shell: bash -c
    script-exec: ssh -o &quot;some quoted option&quot; ${node.username}@${node.hostname} ${exec.command}
</code
	  ></pre
	><p
	>At run time, the properties specified would be expanded to the values for the specific node and command string to execute.</p
	><p
	>OR, you could specify a default to apply to all nodes within the project.properties file located at <code
	  >$RDECK_BASE/projects/NAME/etc/project.properties</code
	  >.</p
	><pre
	><code
	  >script-exec.default.command= /bin/execremote -host ${node.hostname} \
    -user ${node.username} -- ${exec.command}
</code
	  ></pre
	><p
	>Similarly for the <code
	  >$RDECK_BASE/etc/framework.properties</code
	  > file to apply to all projects.</p
	></div
      ><div id="requirements-for-the-script-exec-command"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.6</span
	    > Requirements for the script-exec command</a
	  ></h4
	><p
	>The command run by by the script plugin is expected to behave in the following manner:</p
	><ul
	><li
	  >Exit with a system exit code of &quot;0&quot; in case of success.</li
	  ><li
	  >Any other exit code indicates failure</li
	  ></ul
	><p
	>Note: all output from STDOUT and STDERR will be captured as part of the Rundeck job execution.</p
	></div
      ><div id="configuring-script-copy"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.7</span
	    > Configuring script-copy</a
	  ></h4
	><p
	>To configure script-copy you must specify a commandline string to execute. Optionally you may specify a directory to be used as the working directory when executing the commandline string, and a shell to use to interpret the command.</p
	><p
	>You must also specify the filepath on the target node where the copied file will be placed, which can be done in two different ways.</p
	><p
	>You can configure these across all projects (framework-wide), a single project (project-wide), or specifically for each node, with the most specific configuration value taking precedence.</p
	></div
      ><div id="configuring-the-command-for-script-copy"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.8</span
	    > Configuring the command for script-copy</a
	  ></h4
	><p
	>For Framework and Project-wide, configure these properties in either the framework.properties or project.properties files:</p
	><dl
	><dt
	  ><code
	    >plugin.script-copy.default.command</code
	    ></dt
	  ><dd
	  >Specifies the default system command to run</dd
	  ></dl
	><p
	>For node-specific add these attributes to the node.</p
	><dl
	><dt
	  ><code
	    >script-copy</code
	    ></dt
	  ><dd
	  >Specifies the system command to run</dd
	  ></dl
	><p
	>See <a href="#defining-the-script-copy-command"
	  >Defining the script-copy command</a
	  > for what to specify for this property.</p
	></div
      ><div id="configuring-the-working-directory-1"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.9</span
	    > Configuring the working directory</a
	  ></h4
	><p
	>For Framework and Project-wide, configure a property in either the framework.properties or project.properties files:</p
	><dl
	><dt
	  ><code
	    >plugin.script-copy.default.dir</code
	    ></dt
	  ><dd
	  >Specifies the default working directory for the execution</dd
	  ></dl
	><p
	>For node-specific add an attribute named <code
	  >script-copy-dir</code
	  > to the node.</p
	><dl
	><dt
	  ><code
	    >script-copy-dir</code
	    ></dt
	  ><dd
	  >Specifies the default working directory for the execution (optional)</dd
	  ></dl
	></div
      ><div id="configuring-the-shell-1"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.10</span
	    > Configuring the shell</a
	  ></h4
	><p
	>For Framework and Project-wide, configure a property in either the framework.properties or project.properties files:</p
	><dl
	><dt
	  ><code
	    >plugin.script-copy.default.shell</code
	    ></dt
	  ><dd
	  >Specifies the shell to run the command (optional)</dd
	  ></dl
	><p
	>For node-specific add an attribute named <code
	  >script-copy-shell</code
	  > to the node.</p
	><dl
	><dt
	  ><code
	    >script-copy-shell</code
	    ></dt
	  ><dd
	  >Specifies the shell to run the command (optional)</dd
	  ></dl
	></div
      ><div id="configuring-the-remote-filepath"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.11</span
	    > Configuring the remote filepath</a
	  ></h4
	><p
	>For Framework and Project-wide, configure a property in either the framework.properties or project.properties files:</p
	><dl
	><dt
	  ><code
	    >plugin.script-copy.default.remote-filepath</code
	    ></dt
	  ><dd
	  >Specifies the full path of the copied file.</dd
	  ></dl
	><p
	>For node-specific add an attribute named <code
	  >script-copy-remote-filepath</code
	  > to the node.</p
	><dl
	><dt
	  ><code
	    >script-copy-remote-filepath</code
	    ></dt
	  ><dd
	  >Specifies the full path of the copied file.</dd
	  ></dl
	><p
	>See <a href="#defining-the-script-copy-filepath"
	  >Defining the script-copy filepath</a
	  > for what to specify for this property.</p
	></div
      ><div id="defining-the-script-copy-command"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.12</span
	    > Defining the script-copy command</a
	  ></h4
	><p
	>The value of this property or attribute should be the complete commandline string to execute in an external system process.</p
	><p
	>You can use <em
	  >Data context properties</em
	  > as you can in normal Rundeck command execution, such as <code
	  >${node.name}</code
	  > or <code
	  >${job.name}</code
	  >.</p
	><p
	>In addition, the plugin provides these new data context properties:</p
	><dl
	><dt
	  ><code
	    >file-copy.file</code
	    ></dt
	  ><dd
	  ><p
	    >The local filepath that should be copied to the remote node</p
	    ></dd
	  ><dt
	  ><code
	    >file-copy.filename</code
	    ></dt
	  ><dd
	  ><p
	    >The name of the file without any path information.</p
	    ></dd
	  ></dl
	><p
	>Example:</p
	><p
	>If you wanted to run some external remote connection command (&quot;/bin/copyremote&quot;) in lieu of the built-in SCP command, you could specify these attributes for node:</p
	><pre
	><code
	  >mynode:
    file-copier: script-copy
    script-copy: /bin/copyremote -host ${node.hostname} -user ${node.username} -- ${file-copy.file} ${node.destdir}
</code
	  ></pre
	><p
	>At run time, the properties specified would be expanded to the values for the specific node and command string to execute.</p
	><p
	>OR, you could specify a default to apply to all nodes within the project.properties file located at <code
	  >$RDECK_BASE/projects/NAME/etc/project.properties</code
	  >.</p
	><pre
	><code
	  >script-copy.default.command= /bin/copyremote -host ${node.hostname} -user ${node.username} -- ${file-copy.file} ${node.destdir}
</code
	  ></pre
	><p
	>Similarly for the <code
	  >$RDECK_BASE/etc/framework.properties</code
	  > file to apply to all projects.</p
	></div
      ><div id="defining-the-script-copy-filepath"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.13</span
	    > Defining the script-copy filepath</a
	  ></h4
	><p
	>The value of this property or attribute should be the complete filepath on the target node where the copied file is placed. This is to tell the FileCopier service where the remote file exists after your script copies it over, so that it can later be executed.</p
	><p
	>You can do this in <em
	  >two</em
	  > ways, either as a configuration property as described here, or via output from your script, as described under <a href="#requirements-of-script-copy-command"
	  >Requirements of script-copy command</a
	  >.</p
	><p
	>You can use <em
	  >Data context properties</em
	  > as you can in normal Rundeck command execution, such as <code
	  >${node.name}</code
	  > or <code
	  >${job.name}</code
	  >.</p
	><p
	>In addition, the plugin provides these new data context properties:</p
	><dl
	><dt
	  ><code
	    >file-copy.file</code
	    ></dt
	  ><dd
	  ><p
	    >The local filepath that should be copied to the remote node</p
	    ></dd
	  ><dt
	  ><code
	    >file-copy.filename</code
	    ></dt
	  ><dd
	  ><p
	    >The name of the file without any path information.</p
	    ></dd
	  ></dl
	><p
	>Example:</p
	><p
	>Using the &quot;/bin/copyremote&quot; example from above, we need to set the <code
	  >script-copy-remote-filepath</code
	  > to the location on the remote node where the file is copied. Our example copies <code
	  >${file-copy.file}</code
	  > to the location <code
	  >${node.destdir}</code
	  >. This is an attribute on the Node that we assume to be configured with a directory path.</p
	><p
	>We need to set the <code
	  >script-copy-remote-filepath</code
	  > to the location on the remote node where the file will exist after being copied. We know the filename of the file is available as <code
	  >${file-copy.filename}</code
	  >, so we set it to <code
	  >${node.destdir}/${file-copy.filename}</code
	  >:</p
	><pre
	><code
	  >mynode:
    file-copier: script-copy
    script-copy: /bin/copyremote -host ${node.hostname} -user ${node.username} -- ${file-copy.file} ${node.destdir}
    script-copy-remote-filepath: ${node.destdir}/${file-copy.filename}
</code
	  ></pre
	><p
	>At run time, the properties specified would be expanded to the values for the specific node and command string to execute.</p
	><p
	>OR, you could specify a default to apply to all nodes within the project.properties file located at <code
	  >$RDECK_BASE/projects/NAME/etc/project.properties</code
	  >.</p
	><pre
	><code
	  >script-copy.default.remote-filepath= ${node.destdir}/${file-copy.filename}
</code
	  ></pre
	><p
	>Similarly for the <code
	  >$RDECK_BASE/etc/framework.properties</code
	  > file to apply to all projects.</p
	></div
      ><div id="requirements-of-script-copy-command"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.14</span
	    > Requirements of script-copy command</a
	  ></h4
	><p
	>The command executed by script-copy is expected to behave in the following manner:</p
	><ul
	><li
	  >Exit with an exit code of &quot;0&quot; to indicate success</li
	  ><li
	  >Exit with any other exit code indicates failure</li
	  ><li
	  ><strong
	    >Either</strong
	    ><ul
	    ><li
	      >Output the filepath of the copied file on the target node as the first line of output on STDOUT OR</li
	      ><li
	      >Define the &quot;remote-filepath&quot; as described above</li
	      ></ul
	    ></li
	  ></ul
	></div
      ><div id="example-scripts"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.9.1.15</span
	    > Example Scripts</a
	  ></h4
	><p
	>Here are some example scripts to show the some possible usage patterns.</p
	><p
	><strong
	  >Example script-exec</strong
	  >:</p
	><p
	>Node definition:</p
	><pre
	><code
	  >mynode:
    node-executor: script-exec
</code
	  ></pre
	><p
	>Project config <code
	  >project.properties</code
	  > file:</p
	><pre
	><code
	  >plugin.script-exec.default.command: /tmp/myexec.sh ${node.hostname} ${node.username} -- ${exec.command}
</code
	  ></pre
	><p
	>Contents of <code
	  >/tmp/myexec.sh</code
	  >:</p
	><pre
	><code
	  >#!/bin/bash

# args are [hostname] [username] -- [command to exec...]

host=$1
shift
user=$1
shift
command=&quot;$*&quot;

REMOTECMD=ssh

exec $REMOTECMD $user@$host $command
</code
	  ></pre
	><p
	><strong
	  >Example script-copy</strong
	  >:</p
	><p
	>Node definition:</p
	><pre
	><code
	  >mynode:
    file-copier: script-copy
    destdir: /some/node/dir
</code
	  ></pre
	><p
	>System-wide config in <code
	  >framework.properties</code
	  >:</p
	><pre
	><code
	  >plugin.script-copy.default.command: /tmp/mycopy.sh ${node.hostname} ${node.username} ${node.destdir} ${file-copy.file}
</code
	  ></pre
	><p
	>Contents of <code
	  >/tmp/mycopy.sh</code
	  >:</p
	><pre
	><code
	  >#!/bin/bash

# args are [hostname] [username] [destdir] [filepath]

host=$1
shift
user=$1
shift
dir=$1
shift
file=$1

name=`basename $file`

# copy to node
CPCMD=scp

exec $CPCMD $file $user@$host:$dir/$name &gt; /dev/null || exit $?

echo &quot;$dir/$name&quot;
</code
	  ></pre
	><p
	><strong
	  >Example system ssh replacement</strong
	  >:</p
	><p
	>This example uses the system's &quot;ssh&quot; and &quot;scp&quot; commands to perform node execution and file copying, and doesn't make use of an external script file:</p
	><p
	>Node-only configuration:</p
	><pre
	><code
	  >mynode:
    hostname: mynode
    username: user1
    node-executor: script-exec
    script-exec: ssh -o &quot;StrictHostKeyChecking no&quot; ${node.username}@${node.hostname} ${exec.command}
    script-exec-shell: bash -c
    file-copier: script-copy
    destdir: /tmp
    script-copy-shell: bash -c
    script-copy: scp ${file-copy.file} ${node.username}@${node.hostname}:${node.destdir}
    script-copy-remote-filepath: ${node.destdir}/${file-copy.filename}
</code
	  ></pre
	><p
	>This could all be set as defaults in the project.properties file, such as:</p
	><pre
	><code
	  ># set default node executor
service.NodeExecutor.default.provider=script-exec

# set script-exec defaults
plugin.script-exec.default.command=ssh -o &quot;StrictHostKeyChecking no&quot; ${node.username}@${node.hostname} ${exec.command}
plugin.script-exec.default.shell=bash -c

#set default file copier
service.FileCopier.default.provider=script-copy

#set script-copy defaults
plugin.script-copy.default.command=scp ${file-copy.file} ${node.username}@${node.hostname}:${node.destdir}
plugin.script-copy.default.shell: bash -c
plugin.script-copy.default.remote-filepath: ${node.destdir}/${file-copy.filename}
</code
	  ></pre
	><p
	>In which case your node definitions could be as simple as:</p
	><pre
	><code
	  >mynode:
    hostname: mynode
    username: user1
    destdir: /tmp
</code
	  ></pre
	></div
      ></div
    ><div id="stub-plugin"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.9.2</span
	  > stub-plugin</a
	></h3
      ><p
      >The <code
	>stub-plugin</code
	> includes these providers:</p
      ><ul
      ><li
	><code
	  >stub</code
	  > for the NodeExecutor service</li
	><li
	><code
	  >stub</code
	  > for the FileCopier service</li
	></ul
      ><p
      >(Refer to <a href="#using-providers"
	>Using Providers</a
	> to enable them.)</p
      ><p
      >This plugin does not actually perform any remote file copy or command execution, instead it simply echoes the command that was supposed to be executed, and pretends to have copied a file.</p
      ><p
      >This is intended for use in testing new Nodes, Jobs or Workflow sequences without affecting any actual runtime environment.</p
      ><p
      >You can also test some failure scenarios by configuring the following node attributes:</p
      ><dl
      ><dt
	><code
	  >stub-exec-success</code
	  >=&quot;true/false&quot;</dt
	><dd
	><p
	  >If set to false, the stub command execution will simulate command failure</p
	  ></dd
	><dt
	><code
	  >stub-result-code</code
	  ></dt
	><dd
	><p
	  >Simulate the return result code from execution</p
	  ></dd
	></dl
      ><p
      >You could, for example, disable or test an entire project's workflows or jobs by simply setting the <code
	>project.properties</code
	> node executor provider to <code
	>stub</code
	>.</p
      ></div
    ></div
  ></div
><div id="plugin-development"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >11</span
      > Plugin Development</a
    ></h1
  ><p
  >This is a work in progress, and the plugin system is likely to change.</p
  ><p
  >There are currently two ways to develop plugins:</p
  ><ol style="list-style-type: decimal;"
  ><li
    >Develop Java code that is distributed within a Jar file. See <a href="#java-plugin-development"
      >Java plugin development</a
      >.</li
    ><li
    >Write shell/system scripts that implement your desired behavior and put them in a zip file with some metadata. See <a href="#script-plugin-development"
      >Script Plugin Development</a
      >.</li
    ></ol
  ><p
  >Either way, the resultant plugin archive file, either a .jar java archive, or a .zip file archive, will be placed in the <code
    >$RDECK_BASE/libext</code
    > dir.</p
  ><div id="java-plugin-development"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>11.1</span
	> Java Plugin Development</a
      ></h2
    ><p
    >Java plugins are distributed as .jar files containing the necessary classes for one or more service provider, as well as any other java jar dependency files.</p
    ><p
    >The <code
      >.jar</code
      > file you distribute must have this metadata within the main Manifest for the jar file to be correctly loaded by the system:</p
    ><ul
    ><li
      ><code
	>Rundeck-Plugin-Version: 1.0</code
	></li
      ><li
      ><code
	>Rundeck-Plugin-Archive: true</code
	></li
      ><li
      ><code
	>Rundeck-Plugin-Classnames: classname,..</code
	></li
      ><li
      ><code
	>Rundeck-Plugin-Libs: lib/something.jar ...</code
	> <em
	>(optional)</em
	></li
      ></ul
    ><p
    >Each classname listed must be a valid &quot;Provider Class&quot; as defined below.</p
    ><div id="provider-classes"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.1.1</span
	  > Provider Classes</a
	></h3
      ><p
      >A &quot;Provider Class&quot; is a java class that implements a particular interface and declares itself as a provider for a particular RunDeck &quot;Service&quot;.</p
      ><p
      >Each plugin also defines a &quot;Name&quot; that identifies it for use in RunDeck. The Name of a plugin is also referred to as a &quot;Provider Name&quot;, as the plugin class is a provider of a particular service.</p
      ><p
      >You should choose a unique but simple name for your provider.</p
      ><p
      >Each plugin class must have the &quot;com.dtolabs.rundeck.core.plugins.Plugin&quot; annotation applied to it.</p
      ><pre
      ><code
	>@Plugin(name=&quot;myprovider&quot;, service=&quot;NodeExecutor&quot;)
public class MyProvider implements NodeExecutor{
...
</code
	></pre
      ><p
      >Your provider class must have at least a zero-argument constructor, and optionally can have a single-argument constructor with a <code
	>com.dtolabs.rundeck.core.common.Framework</code
	> parameter, in which case your class will be constructed with this constructor and passed the Framework instance.</p
      ><p
      >You may log messages to the ExecutionListener available via <code
	>ExecutionContext#getExecutionListener()</code
	> method.</p
      ><p
      >You can also send output to <code
	>System.err</code
	> and <code
	>System.out</code
	> and it will be captured as output of the execution.</p
      ></div
    ><div id="jar-dependencies"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.1.2</span
	  > Jar Dependencies</a
	></h3
      ><p
      >If your Java classes require external libraries that are not included with the RunDeck runtime, you can include them in your .jar archive. (Look in <code
	>$RDECK_BASE/tools/lib</code
	> to see the set of third-party jars that are available for your classes by default at runtime).</p
      ><p
      >Specify the <code
	>Rundeck-Plugin-Libs</code
	> attribute in the Main attributes of the Manifest for the jar, set the value to a space-separated list of jar file names as you have included them in the jar.</p
      ><p
      >E.g.:</p
      ><pre
      ><code
	>Rundeck-Plugin-Libs: lib/somejar-1.2.jar lib/anotherjar-1.3.jar
</code
	></pre
      ><p
      >Then include the jar files in the Plugin's jar contents:</p
      ><pre
      ><code
	>META-INF/
META-INF/MANIFEST.MF
com/
com/mycompany/
com/mycompany/rundeck/
com/mycompany/rundeck/plugin/
com/mycompany/rundeck/plugin/test/
com/mycompany/rundeck/plugin/test/TestNodeExecutor.class
lib/
lib/somejar-1.2.jar
lib/anotherjar-1.3.jar
</code
	></pre
      ></div
    ><div id="available-services:"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.1.3</span
	  > Available Services:</a
	></h3
      ><ul
      ><li
	><code
	  >NodeExecutor</code
	  > - executes a command on a node</li
	><li
	><code
	  >FileCopier</code
	  > - copies a file to a node</li
	><li
	><code
	  >ResourceModelSource</code
	  > - produces a set of Node definitions for a project</li
	><li
	><code
	  >ResourceFormatParser</code
	  > - parses a document into a set of Node resources</li
	><li
	><code
	  >ResourceFormatGenerator</code
	  > - generates a document from a set of Node resources</li
	></ul
      ></div
    ></div
  ><div id="provider-lifecycle"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>11.2</span
	> Provider Lifecycle</a
      ></h2
    ><p
    >Provider classes are instantiated when needed by the Framework object, and the instance is retained within the Service for future reuse. The Framework object may exist across multiple executions, and the provider instance may be reused.</p
    ><p
    >Provider instances may also be used by multiple threads.</p
    ><p
    >Your provider class should not use any instance fields and should be careful not to use un-threadsafe operations.</p
    ><div id="node-executor-providers"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.2.1</span
	  > Node Executor Providers</a
	></h3
      ><p
      >A Node Executor provider executes a certain command on a remote or local node.</p
      ><p
      >Your provider class must implement the <code
	>com.dtolabs.rundeck.core.execution.service.NodeExecutor</code
	> interface:</p
      ><pre
      ><code
	>public interface NodeExecutor {
    public NodeExecutorResult executeCommand(ExecutionContext context, 
        String[] command, INodeEntry node) throws ExecutionException;
}
</code
	></pre
      ><p
      >A Node Executor can be me made Configurable on a per-project basis via the Web GUI by implementing the <code
	>com.dtolabs.rundeck.core.plugins.configuration.Describable</code
	> interface. It is up to your plugin implementation to use configuration properties from the <code
	>FrameworkProject</code
	> instance to configure itself. You must also be sure to return an appropriate mapping in the <code
	>getPropertiesMapping</code
	> method of the <code
	>Description</code
	> interface to declare the property names to be used in the <code
	>project.properties</code
	> file.</p
      ><p
      >More information is available in the Javadoc.</p
      ></div
    ><div id="file-copier-providers"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.2.2</span
	  > File Copier Providers</a
	></h3
      ><p
      >A File Copier provider copies a file or script to a remote or local node.</p
      ><p
      >Your provider class must implement the <code
	>com.dtolabs.rundeck.core.execution.service.FileCopier</code
	> interface:</p
      ><pre
      ><code
	>public interface FileCopier {
    public String copyFileStream(final ExecutionContext context, InputStream input, INodeEntry node) throws
        FileCopierException;

    public String copyFile(final ExecutionContext context, File file, INodeEntry node) throws FileCopierException;

    public String copyScriptContent(final ExecutionContext context, String script, INodeEntry node) throws
        FileCopierException;
}
</code
	></pre
      ><p
      >A File Copier can be me made Configurable on a per-project basis via the Web GUI by implementing the <code
	>com.dtolabs.rundeck.core.plugins.configuration.Describable</code
	> interface. It is up to your plugin implementation to use configuration properties from the <code
	>FrameworkProject</code
	> instance to configure itself. You must also be sure to return an appropriate mapping in the <code
	>getPropertiesMapping</code
	> method of the <code
	>Description</code
	> interface to declare the property names to be used in the <code
	>project.properties</code
	> file.</p
      ><p
      >More information is available in the Javadoc.</p
      ></div
    ><div id="resource-model-source-providers"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.2.3</span
	  > Resource Model Source Providers</a
	></h3
      ><p
      >A Resource Model Source provider is actually a Factory class. An instance of your Resource Model Source provider will be re-used, so each time a new Resource Model Source with a new configuration is required, your Factory class will be invoked to produce it.</p
      ><p
      >Your provider class must implement the <code
	>com.dtolabs.rundeck.core.resources.ResourceModelSourceFactory</code
	> interface:</p
      ><pre
      ><code
	>public interface ResourceModelSourceFactory {
    /**
     * Return a resource model source for the given configuration
     */
    public ResourceModelSource createResourceModelSource(Properties configuration) throws ConfigurationException;
}
</code
	></pre
      ><p
      >A Resource Model Source provider can also be Configurable via the Web GUI by implementing the <code
	>com.dtolabs.rundeck.core.plugins.configuration.Describable</code
	> interface. This allows you to return a descriptor of the configuration parameters for your plugin, which is used by the GUI to render a web form. The properties the user configures are stored in the <code
	>project.properties</code
	> configuration file, and are passed to your factory method as the <code
	>configuration</code
	> properties.</p
      ><p
      >More information is available in the Javadoc.</p
      ></div
    ><div id="resource-format-parser-and-generator-providers"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.2.4</span
	  > Resource Format Parser and Generator Providers</a
	></h3
      ><p
      >Resource format Parser and Generator providers are used to serialize a set of Node resources into a textual format for transport or storage.</p
      ><p
      >Each Parser and Generator must declare the set of filename extensions (such as &quot;xml&quot; or &quot;json&quot;) that it supports, as well as the set of MIME types that it supports (such as &quot;text/xml&quot; or &quot;application/json&quot;.) This lets other services retrieve the appropriate parser or generator when all that is known about the source or destination of serialized data is a filename or a MIME type.</p
      ><p
      >For Parsers, your provider class must implement the <code
	>com.dtolabs.rundeck.core.resources.format.ResourceFormatParser</code
	> interface:</p
      ><pre
      ><code
	>public interface ResourceFormatParser {
    /**
     * Return the list of file extensions that this format parser can parse.
     */
    public Set&lt;String&gt; getFileExtensions();

    /**
     * Return the list of MIME types that this format parser can parse. This may include wildcards such as
     * &quot;*&amp;#47;xml&quot;.
     */
    public Set&lt;String&gt; getMIMETypes();

    /**
     * Parse a file
     */
    public INodeSet parseDocument(File file) throws ResourceFormatParserException;

    /**
     * Parse an input stream
     */
    public INodeSet parseDocument(InputStream input) throws ResourceFormatParserException;
}
</code
	></pre
      ><p
      >For Generators, your provider class must implement the <code
	>com.dtolabs.rundeck.core.resources.format.ResourceFormatGenerator</code
	> interface:</p
      ><pre
      ><code
	>public interface ResourceFormatGenerator {

    /**
     * Return the list of file extensions that this format generator can generate
     */
    public Set&lt;String&gt; getFileExtensions();

    /**
     * Return the list of MIME types that this format generator can generate. If more than one
     * are returned, then the first value will be used by default if necessary.
     */
    public List&lt;String&gt; getMIMETypes();

    /**
     * generate formatted output
     */
    public void generateDocument(INodeSet nodeset, OutputStream stream) throws ResourceFormatGeneratorException,
        IOException;
}
</code
	></pre
      ><p
      >More information is available in the Javadoc.</p
      ></div
    ></div
  ><div id="script-plugin-development"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>11.3</span
	> Script Plugin Development</a
      ></h2
    ><p
    >Script plugins can provide the same services as Java plugins, but they do so with a script that is invoked in an external system processes by the JVM.</p
    ><p
    >These Services support Script Plugins:</p
    ><ul
    ><li
      ><code
	>NodeExecutor</code
	></li
      ><li
      ><code
	>FileCopier</code
	></li
      ><li
      ><code
	>ResourceModelSource</code
	></li
      ></ul
    ><p
    ><strong
      >Note:</strong
      > Currently, the Resource Format Parser and Generator services <em
      >do not</em
      > support Script Plugins.</p
    ><p
    >You must create a zip file with the following structure:</p
    ><pre
    ><code
      >[name]-plugin.zip
\- [name]-plugin/ -- root directory of zip contents, same name as zip file
   |- plugin.yaml -- plugin metadata file
   \- contents/
      |- ...      -- script or resource files
      \- ...
</code
      ></pre
    ><p
    >Here is an example:</p
    ><pre
    ><code
      >$ unzip -l example-1.0-plugin.zip 
Archive:  example-1.0-plugin.zip
  Length     Date   Time    Name
 --------    ----   ----    ----
        0  04-12-11 11:31   example-1.0-plugin/
        0  04-11-11 15:31   example-1.0-plugin/contents/
     2142  04-11-11 15:31   example-1.0-plugin/contents/script1.sh
     1591  04-11-11 13:10   example-1.0-plugin/contents/script2.sh
      576  04-12-11 10:58   example-1.0-plugin/plugin.yaml
 --------                   -------
     4309                   5 files
</code
      ></pre
    ><p
    >The filename of the plugin zip must end with &quot;-plugin.zip&quot; to be recognized as a plugin archive. The zip must contain a top-level directory with the same base name as the zip file (sans &quot;.zip&quot;).</p
    ><p
    >The file <code
      >plugin.yaml</code
      > must have this structure:</p
    ><pre
    ><code
      ># yaml plugin metadata

name: plugin name
version: plugin version
rundeckPluginVersion: 1.0
author: author name
date: release date
providers:
    - name: provider
      service: service name
      plugin-type: script
      script-interpreter: [interpreter]
      script-file: [script file name]
      script-args: [script file args]
</code
      ></pre
    ><p
    >The main metadata that is required:</p
    ><ul
    ><li
      ><code
	>name</code
	> - name for the plugin</li
      ><li
      ><code
	>version</code
	> - version number of the plugin</li
      ><li
      ><code
	>rundeckPluginVersion</code
	> - Rundeck Plugin type version, currently &quot;1.0&quot;</li
      ><li
      ><code
	>providers</code
	> - list of provider metadata maps</li
      ></ul
    ><p
    >These are optional:</p
    ><ul
    ><li
      ><code
	>author</code
	> - optional author info</li
      ><li
      ><code
	>date</code
	> - optional release date info</li
      ></ul
    ><p
    >This provides the necessary metadata about the plugin, including one or more entries in the <code
      >providers</code
      > list to declare those providers defined in the plugin.</p
    ><div id="provider-metadata"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.3.1</span
	  > Provider metadata</a
	></h3
      ><p
      >Required provider entries:</p
      ><ul
      ><li
	><code
	  >name</code
	  > - provider name</li
	><li
	><code
	  >service</code
	  > - service name, one of these valid services:<ul
	  ><li
	    ><code
	      >NodeExecutor</code
	      ></li
	    ><li
	    ><code
	      >FileCopier</code
	      ></li
	    ><li
	    ><code
	      >ResourceModelSource</code
	      ></li
	    ></ul
	  ></li
	><li
	><code
	  >plugin-type</code
	  > - must be &quot;script&quot; currently.</li
	><li
	><code
	  >script-file</code
	  > - must be the name of a file relative to the <code
	  >contents</code
	  > directory</li
	></ul
      ><p
      >For <code
	>ResourceModelSource</code
	> service, this additional entry is required:</p
      ><ul
      ><li
	><code
	  >resource-format</code
	  > - Must be the name of one of the supported <a href="#resource-model-document-formats"
	  >Resource Model Document Formats</a
	  >.</li
	></ul
      ><p
      >Optional entries:</p
      ><ul
      ><li
	><code
	  >script-interpreter</code
	  > - A system command that should be used to execute the script. This can be a single binary path, e.g. <code
	  >/bin/bash</code
	  >, or include any args to the command, such as <code
	  >/bin/bash -c</code
	  >.</li
	><li
	><code
	  >script-args</code
	  > - the arguments to use when executing the script file.</li
	></ul
      ></div
    ><div id="configurable-resource-model-source-script-plugin"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.3.2</span
	  > Configurable Resource Model Source Script Plugin</a
	></h3
      ><p
      >The <code
	>ResourceModelSource</code
	> service allows the plugins to be configured via the RunDeck Web GUI. You are thus able to declare configuration properties for your plugin, which will be displayed as a web form when the Project is configured, or can be manually configured in the <code
	>project.properties</code
	> file.</p
      ><p
      >You can use these metadata entries to declare configuration properties for your plugin:</p
      ><p
      >Create a <code
	>config</code
	> entry in each provider definition, containing a sequence of map entries for each configuration property you want to define. In the map entry include:</p
      ><ul
      ><li
	><code
	  >type</code
	  > - The type of property. Must be one of:<ul
	  ><li
	    ><code
	      >String</code
	      ></li
	    ><li
	    ><code
	      >Boolean</code
	      > must be &quot;true&quot; or &quot;false&quot;</li
	    ><li
	    ><code
	      >Integer</code
	      ></li
	    ><li
	    ><code
	      >Long</code
	      ></li
	    ><li
	    ><code
	      >Select</code
	      > must be on of a set of values</li
	    ><li
	    ><code
	      >FreeSelect</code
	      > may be one of a set of values</li
	    ></ul
	  ></li
	><li
	><code
	  >name</code
	  > - Name to identify the property</li
	><li
	><code
	  >title</code
	  > - Title to display in the GUI (optional)</li
	><li
	><code
	  >description</code
	  > - Description to display in the GUI (optional)</li
	><li
	><code
	  >required</code
	  > - (true/false) if true, require a non-empty value (optional)</li
	><li
	><code
	  >default</code
	  > - A default value to use (optional)</li
	><li
	><code
	  >values</code
	  > - A comma-separated list of values to use for Select or FreeSelect. Required for Select/FreeSelect.</li
	></ul
      ><p
      >When your script is invoked, each configuration property defined for the plugin will be set as <code
	>config.NAME</code
	> in the data context passed to your script (see below).</p
      ><p
      >Here is an example <code
	>providers</code
	> section for a Resource Model Source plugin that asks for two input properties from the user and produces &quot;resourceyaml&quot; formatted output:</p
      ><pre
      ><code
	>providers:
    - name: mysource
      service: ResourceModelSource
      plugin-type: script
      script-interpreter: bash -c
      script-file: generate.sh
      resource-format: resourceyaml
      config:
        - type: Integer
          name: count
          title: Count
          description: Enter the number of nodes to generate
        - type: FreeSelect
          name: flavor
          title: Flavor
          description: Select a flavor
          required: true
          default: vanilla
          values: vanilla,blueberry,strawberry,chocolate
</code
	></pre
      ></div
    ><div id="how-script-plugin-providers-are-invoked"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.3.3</span
	  > How script plugin providers are invoked</a
	></h3
      ><p
      >When the provider is used for node execution or file copying, the script file, interpreter, and args are combined into a commandline executed by the system in this pattern:</p
      ><pre
      ><code
	>[interpreter] [filename] [args...]
</code
	></pre
      ><p
      >If the interpreter is not specified, then the script file is executed directly, and that means it must be acceptable by the system to be executed directly (include any necessary <code
	>#!</code
	> line, etc).</p
      ><p
      ><code
	>script-args</code
	> can contain data-context properties such as <code
	>${node.name}</code
	>. Additionally, the specific Service will provide some additional context properties that can be used:</p
      ><ul
      ><li
	>NodeExecutor will define <code
	  >${exec.command}</code
	  > containing the command to be executed</li
	><li
	>FileCopier will define <code
	  >${file-copy.file}</code
	  > containing the local path to the file that needs to be copied.</li
	><li
	>ResourceModelSource will define <code
	  >${config.KEY}</code
	  > for each configuration property KEY that is defined.</li
	></ul
      ><p
      >In addition, all of the data-context properties that are available in the <code
	>script-args</code
	> are provided as environment variables to the script or interpreter when it is executed.</p
      ><p
      >Environment variables are generated in all-caps with this format:</p
      ><pre
      ><code
	>RD_[KEY]_[NAME]
</code
	></pre
      ><p
      >The <code
	>KEY</code
	> and <code
	>NAME</code
	> are the same as <code
	>${key.name}</code
	>. Any characters in the key or name that are not valid Bash shell variable characters are replaced with underscore '_'.</p
      ><p
      >Examples:</p
      ><ul
      ><li
	><code
	  >${node.name}</code
	  > becomes <code
	  >$RD_NODE_NAME</code
	  ></li
	><li
	><code
	  >${node.some-attribute}</code
	  > becomes <code
	  >$RD_NODE_SOME_ATTRIBUTE</code
	  ></li
	><li
	><code
	  >${exec.command}</code
	  > becomes <code
	  >$RD_EXEC_COMMAND</code
	  ></li
	><li
	><code
	  >${file-copy.file}</code
	  > becomes <code
	  >$RD_FILE_COPY_FILE</code
	  ></li
	></ul
      ></div
    ><div id="script-provider-requirements"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >11.3.4</span
	  > Script provider requirements</a
	></h3
      ><p
      >The specific service has expectations about the way your provider script behaves:</p
      ><ul
      ><li
	>Exit code of 0 indicates success</li
	><li
	>Any other exit code indicates failure</li
	></ul
      ><dl
      ><dt
	>For <code
	  >NodeExecutor</code
	  ></dt
	><dd
	><p
	  >All output to <code
	    >STDOUT</code
	    >/<code
	    >STDERR</code
	    > will be captured for the job's output</p
	  ></dd
	><dt
	>For <code
	  >FileCopier</code
	  ></dt
	><dd
	><p
	  >The first line of output of <code
	    >STDOUT</code
	    > MUST be the filepath of the file copied to the target node. Other output is ignored. All output to <code
	    >STDERR</code
	    > will be captured for the job's output.</p
	  ></dd
	><dt
	>For <code
	  >ResourceModelSource</code
	  ></dt
	><dd
	><p
	  >All output on <code
	    >STDOUT</code
	    > will be captured and passed to the p</p
	  ></dd
	></dl
      ></div
    ></div
  ></div
><div class="footnotes"
><hr
   /><ol
  ><li id="fn1"
    ><p
      >The &quot;--noqueue&quot; flag is useful for testing and debugging execution but undermines visibility since execution is not managed through the central execution queue. <a href="#fnref1" class="footnoteBackLink" title="Jump back to footnote 1">↩</a></p
      ></li
    ><li id="fn2"
    ><p
      >To pass environment variables through remote command dispatches, it is required to properly configure the SSH server on the remote end. See the AcceptEnv directive in the &quot;sshd_config(5)&quot; manual page for instructions. Use a wild card pattern to permit RD_ prefixed variables to provide open access to RunDeck generated environment variables. <a href="#fnref2" class="footnoteBackLink" title="Jump back to footnote 2">↩</a></p
      ></li
    ></ol
  ></div
>
</div>
</body>
</html>
